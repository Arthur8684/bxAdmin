<!DOCTYPE html>
<html style="background-color: rgb(246, 246, 246);" lang="zh-CN"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta id="viewport" name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta charset="UTF-8" name="description" content="深圳市咫尺网络科技开发有限公司，专注于移动互联网营销解决方案，拥有微信服务号活动汇，微社区微活动应用，及酷炫的邀请函微页等产品，提供快捷方便活动管理，分享、报名统计，营销推广等服务。精彩活动，尽在咫尺！丰富您的活动，精彩您的人生，快来发起属于您的活动吧！">
  <meta name="keywords" content="活动汇,微活动,咫尺活动,微页,咫尺网络,微杂志,微邀请函,喜帖,电子邀请函,H5应用,APP,微场景,场景应用,微场景制作,场景应用制作">
  <meta http-equiv="Cache-Control" content="no-siteapp">
  <script type="text/javascript">
    var ismobile = /Mobile/.test(navigator.userAgent);
    if(ismobile){
      var winw = window.innerWidth,
        scale_w  = winw /  320;
        document.getElementById('viewport').content = "width=320,initial-scale="+scale_w+",maximum-scale="+scale_w+", minimum-scale="+scale_w+", user-scalable=no";
    }else{
      window.onload = function(){
        var st = document.createElement('style');
        st.type = "text/css";
        st.innerHTML = 'body{width:320px;margin:0 auto;}';
        document.head.appendChild(st);
      }
    }
  </script>
  <link rel="stylesheet" type="text/css" href="app_data/slick_theme.css">
  <link rel="stylesheet" type="text/css" href="app_data/animation_library.css">
  <link rel="stylesheet" type="text/css" href="app_data/icomoon.css">
  <link rel="stylesheet" type="text/css" href="app_data/component.css">
  <link rel="stylesheet" type="text/css" href="app_data/photoswipe.css">
  <link rel="stylesheet" type="text/css" href="app_data/default-skin.css">
  <link rel="stylesheet" type="text/css" href="app_data/webapp.css">
  <title>首页</title>
<script src="jquery-2.js"></script>
<script src="app_data/fastclick.js"></script>
<script src="app_data/slick.js"></script>
<script src="app_data/js"></script><script src="app_data/main.js" type="text/javascript"></script>
<script src="app_data/webapp.js"></script>
<link type="text/css" rel="stylesheet" href="app_data/laydate_002.css"><link type="text/css" rel="stylesheet" href="app_data/laydate.css" id="LayDateSkin"><style rel="stylesheet"> .page-container, .page .scroll-ele, .modal { overflow-scrolling:touch;-webkit-overflow-scrolling: touch;} </style><style rel="stylesheet"> .page { min-height:495px; } </style><style type="text/css">body{width:320px;margin:0 auto;}</style><style rel="sheetstyle">body::-webkit-scrollbar, div::-webkit-scrollbar, p::-webkit-scrollbar, textarea::-webkit-scrollbar, section::-webkit-scrollbar, ul::-webkit-scrollbar, iframe::-webkit-scrollbar { width:0px;height:0;}</style></head>
<body class="app " data-nickname="" data-cover="" data-user-token="" data-name="母婴小程序（拼团）" ontouchmove="" onmousewheel="" style="background-color: rgb(246, 246, 246);">
<img style="position:absolute;left:-9999999px;" src="app_data/t_1503559223599e7e3790b77.png" width="0" height="0">
<div class="page-container-parent">
  <div id="page-container" class="page-container">
    <style rel="stylesheet">
.goods-detail-wrap {
  background-color: #eee;
}
.goods-detail-wrap .goods-detail-nav {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 37px;
  padding-top: 5px;
  z-index: 1;
  text-align: center;
  background-color: transparent;
/*  width: 100%;
  box-sizing: border-box;
  height: 37px;
  text-align: center;
  border-bottom: 1px solid #eee;
  background-color: #fff;
  z-index: 1;*/
}
.goods-detail-wrap .goods-detail-nav .ico-moon {
  position:relative;
  margin-right: 15px;
  font-size: 22px;
  width: 37px;
  height: 37px;
  line-height: 37px;
  color: #fff;
  background-color:rgba(0,0,0,.5);
  border-radius:50%;
}
.goods-detail-content {
  margin-bottom: 62px;
}
.goods-detail-wrap .slick-carousel-container {
  width: 100%;
  text-align: center;
  overflow: hidden;
}
.goods-detail-wrap .slick-carousel-container > img {
  width: 100%;
  height: 100%;
}
.goods-detail-wrap .slick-slide:after {
  content: '';
  display: inline-block;
  height: 100%;
  vertical-align: middle;
}
.goods-detail-wrap .slick-slide {
  display: -webkit-box;
  display: -moz-box;
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
  -webkit-align-items: center;
          align-items: center;
  -webkit-justify-content: center;
          justify-content: center;
}
.goods-detail-wrap .slick-slide > img {
  width: 100%;
  height: auto;
}
.goods-detail-wrap .goods-detail-section {
  background-color: #fff;
}
.goods-detail-wrap .goods-header {
  padding: 1px 10px;
}
#goodsDetail .goods-title{
  padding-top: 8px;
}
#goodsDetail .goods-price {
  padding: 8px 0;
}
.goods-detail-wrap .goods-models {
  border-bottom: 1px solid #eee;
}
#goodsDetail .goods-title {
  font-size: 14px;
  color: #333;
}
.goods-detail-wrap .goods-current-price {
  color: #ff7100;
  display: inline-block;
  vertical-align: middle;
}
.goods-detail-wrap .goods-current-price b {
  font-size: 20px;
}
.goods-detail-wrap .goods-original-price {
  text-decoration: line-through;
  vertical-align: middle;
  color: #fff;
  display: inline-block;
  font-size: 12px;
}
.goods-detail-wrap .block-item {
  padding: 10px;
}
.goods-detail-wrap .block-item>div{
  color: #333;
}
.goods-detail-wrap hr {
  margin: 0;
  border: 0px none;
  border-top: 1px solid #eee;
}
.goods-detail-wrap .goods-details {
  padding: 0 10px;
  line-height: 22px;
}
.goods-detail-wrap .goods-details p {
  margin: 0;
  word-break: break-all;
  white-space: pre-line;
}
#goodsDetail .goods-details {
  margin-top: 8px;
}
.goods-detail-wrap .goods-details img {
  display: block;
  width: 100%;
  height: auto;
}
.goods-detail-wrap dl {
  margin: 6px 20px 6px 0;
  color: #666;
}
.goods-detail-wrap dt {
  display: inline-block;
}
.goods-detail-wrap dd {
  display: inline-block;
  line-height: 20px;
}

.goods-detail-wrap .goods-bottom-opt {
  display: none;
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  text-align: center;
  padding: 0;
  border-top: 1px solid #ccc;
  background-image: -webkit-linear-gradient(bottom, rgba(226,227,231,0.33) 0%, rgba(248,248,248,0.33) 100%);
  background-image: linear-gradient(to top, rgba(226,227,231,0.33) 0%, rgba(248,248,248,0.33) 100%);
  background-color: #fff;
  -webkit-user-select: none;
  user-select: none;
  font-size: 0;
}
.goods-detail-wrap .goods-bottom-opt .goods-opt-item:first-child {
  border-right: 1px solid #ccc;
}
.goods-detail-wrap .goods-bottom-opt .goods-opt-item {
  position: relative;
  padding: 3px 0;
  font-size: 12px;
  color: #666;
}
.goods-detail-wrap .goods-bottom-opt .btn {
  width: 100%;
  padding-top: 10px;
  padding-bottom: 10px;
  border: none;
  box-sizing: border-box;
  line-height: 24px;
  border-radius: 0;
  color: #fff;
}
.goods-detail-wrap .goods-bottom-opt .ico-moon {
  font-size: 20px;
}
/*.goods-detail-wrap .goods-bottom-opt .ico-moon.icon-store {
  line-height: 20px;
  font-size: 18px;
}*/

.goods-detail-wrap .right-arrow-bar {
  padding-right: 33px;
}
.goods-detail-wrap .right-arrow-bar:before {
  font-size: 16px;
}
/*.goods-detail-wrap .ico-moon {
  position: relative;
  margin-right: 15px;
  font-size: 22px;
  width: 37px;
  height: 37px;
  line-height: 37px;
  color: #fff;
  background-color: rgba(0,0,0,.6);
  border-radius: 50%;
}*/
.goods-detail-wrap  .goods-detail-section .block-item .goods-comment-label {
    display: inline-block;
    padding: 4px 8px;
    background-color: #FFEBE9;
    color: #333;
    margin-right: 5px;
    border-radius: 100px;
    font-size: 12px;
    width: 76px;
    text-align: center;
    height: 24px;
    line-height: 24px;
    margin-bottom: 10px;
}
#goodsDetail .comment-item {
  padding: 10px 0 0;
}
#goodsDetail .comment-user-photo {
  width: 33px;
  height: 33px;
  border-radius: 50%;
  margin-right: 7px;
  vertical-align: middle;
}
#goodsDetail .comment-content {
  font-size: 12px;
  word-wrap: break-word;
  line-height: 18px;
}
.comment-date, .comment-goods-model {
  color: #999;
  font-size: 12px;
}
.goods-app-name {
  display: inline-block;
  width: calc(100% - 80px);
  height: 16px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.goods-detail-wrap .cart-goods-num {
  position: absolute;
  top: 0;
  right: 0;
  width: 18px;
  height: 18px;
  line-height: 16px;
  font-size: 14px;
  text-align:center;
  background-color: #ff1616;
  border-radius: 50%;
  color: #fff;
}
.goods-detail-wrap .goods-price-discount {
  display: inline-block;
  font-size: 14px;
  vertical-align: bottom;
  color: #acacac;
}
/*秒杀*/
.goods-detail-wrap .countdown{
  display: inline-block;
  text-align: center;
  font-size: 12px;
  color: #666;
}
.goods-detail-wrap .countdown > label{
  display: block;
  margin-top: 8px;
}
.goods-detail-wrap .countdown > span{
  display: inline-block;
  height: 15px;
  background-color: #583512;
  color: #fff;
  text-align: center;
  line-height: 15px;
  margin: 2px 2px;
  padding: 0 3px;
  border-radius: 4px;
  vertical-align: middle;
}
.goods-seckill{
  display: none;
  height: 52px;
  background-color: #f31e4a;
  overflow: hidden;
}
.goods-seckill-left{
  display: inline-block;
  width: 200px;
  height: 100%;
  padding-left: 10px;
  position: relative;
}
.goods-seckill-right{
  float: right;
  width: 100px;
  height: 100%;
  background-color: #feef72;
  padding-left: 10px;
  position: relative;
}
.goods-seckill-left:after{
  content: '';
  width: 0;
  height: 0;
  border-top: 56px solid #f31e4a;
  border-right: 10px solid transparent;
  vertical-align: top;
  position: absolute;
  right: -9px;
  top: 0;
  z-index: 1;
}
.goods-seckill-right.seckill-end{
  background-color: #988d8f;
}
.goods-seckill-right.seckill-end .countdown > label{
  color: #fff;
}
.goods-seckill-current{
  white-space: nowrap;
}
.goods-detail-wrap .goods-seckill .goods-current-price{
  color: #fff;
  margin-top: 5px;
}
.goods-detail-wrap .goods-seckill .goods-price-discount{
  font-size: 12px;
  color: #fff;
}
.goods-seckill-sign{
  display: inline-block;
  padding: 0px 3px;
  border: 1px solid #fff;
  font-size: 8px;
  color: #fff;
  margin-left: 10px;
  line-height: 12px;
}
.buy-goods-directly.disabled,
.add-to-shoppingcart.disabled{
  background-color: #888;
}
/*拼团样式*/
.goods-detail-wrap .group-price {
  position: relative;
  height: 50px;
  line-height: 50px;
  width: 100%;
  background: #d0011b;
  color: #fff;
}

.goods-detail-wrap .group-price .goods-current-price {
  background-image: -webkit-gradient(linear, 0 0, 0 bottom, from(#fff), to(#ff9e6d));
  -webkit-text-fill-color: transparent;
  -webkit-background-clip: text;
  margin-left: 15px;
  height: 35px;
  line-height: 45px;
  display: block;
}

.goods-detail-wrap .group-times {
  position: absolute;
  bottom: 0;
  right: 0;
  height: 50px;
  background: #ffc617;
  text-align: center;
  background-image: -webkit-gradient(linear, 0 0, right 0, from(#fefa43), to(#ffc114));
}

.goods-detail-wrap .group-times:before {
  content: '';
  position: absolute;
  left: -25px;
  top: 0;
  border-top: 25px solid transparent;
  border-bottom: 25px solid transparent;
  border-right: 25px solid #fefa43;
}

.goods-detail-wrap .group-times div {
  height: 25px;
  line-height: 35px;
  font-size: 12px;
  min-width: 130px;
  color: #8c2301;
}

.goods-detail-wrap .goods-origin-price {
  margin-left: 15px;
  height: 15px;
  line-height: 15px;
  font-size: 12px;
  padding-left: 20px;
}

.goods-detail-wrap .group-rule {
  height: 45px;
  line-height: 45px;
  border-bottom: 1px solid #ddd;
}

.goods-detail-wrap .group-tag {
  display: inline-block;
  position: relative;
  height: 15px;
  line-height: 15px;
  background: red;
  font-size: 12px;
  padding: 1px 10px;
  vertical-align: middle;
  color: #fff;
  margin-right: 12px;
  background-image: -webkit-gradient(linear, 0 0, right 0, from(#ff00ea), to(#ff0e18));
}

.goods-detail-wrap .group-tag::before {
  content: '';
  position: absolute;
  left: 0;
  top: 0;
  border-top: 8px solid transparent;
  border-bottom: 8px solid transparent;
  border-left: 3px solid #fff;
}

.goods-detail-wrap .group-tag::after {
  content: '';
  position: absolute;
  right: 0;
  top: 0;
  border-top: 8px solid transparent;
  border-bottom: 8px solid transparent;
  border-right: 3px solid #fff;
}

.goods-detail-wrap .group-step {
  margin: 0 auto;
  text-align: center;
  padding: 25px 0;
}

.goods-detail-wrap .group-step div {
  font-size: 40px;
  color: #d0011b;
  vertical-align: middle;
  display:inline-block;
}

.goods-detail-wrap .group-step .arr {
  font-weight: bold;
  color: #d0011b;
  margin: 0 20px;
}

.goods-detail-wrap .group-step .step-description {
  font-size: 12px;
  color: #666;
}

.goods-detail-wrap .group-step .step-description text {
  color: #666;
  display: inline-block;
  width: 33%;
  text-align: center;
  vertical-align: middle;
  margin-top: 20px;
}

.goods-detail-wrap .grouping {
  height: 45px;
  line-height: 45px;
  font-weight: bold;
  border-bottom: 1px solid #ddd;
}

.goods-detail-wrap .group-item {
  height: 75px;
  line-height: 75px;
  overflow: hidden;
  border-bottom: 1px solid #ddd;
}

.goods-detail-wrap .group-item img {
  height: 50px;
  width: 50px;
  border-radius: 100%;
  vertical-align: middle;
  margin-right: 10px;
}

.goods-detail-wrap .group-item-content {
  display: inline-block;
  vertical-align: middle;
  width: 130px;
  overflow: hidden;
}

.goods-detail-wrap .group-item-content div {
  height: 25px;
  line-height: 25px;
}

.goods-detail-wrap .group-item-price {
  display: inline-block;
  font-size: 12px;
  font-weight: bold;
  background-image: -webkit-gradient(linear, 0 0, right 0, from(#ff0e18), to(#ff00ea));
  -webkit-text-fill-color: transparent;
  -webkit-background-clip: text;
  width: 42px;
  text-align: center;
}

.goods-detail-wrap .join-group-btn {
  display: inline-block;
  font-size: 8px;
  height: 18px;
  line-height: 18px;
  border-radius: 2px;
  background: #d0011b;
  color: #fff;
  padding: 2px 2px;
  position: relative;
}

.goods-detail-wrap .join-group-btn::after {
  content: '';
  position: absolute;
  right: -8px;
  top: 1px;
  border-top: 10px solid transparent;
  border-bottom: 10px solid transparent;
  border-left: 8px solid #d0011b;
}

.goods-detail-wrap .more-group {
  text-align: center;
  color: #d0011b;
  height: 20px;
  line-height: 20px;
  padding: 10px 0;
  font-size: 14px;
}

.goods-detail-wrap .no-group {
  height: 150px;
  line-height: 150px;
  text-align: center;
}

.goods-detail-wrap .start-group {
  display: inline-block;
  height: 30px;
  background: #d0011b;
  border-radius: 5px;
  text-align: center;
  line-height: 30px;
  color: #fff;
  padding: 0 20px;
  margin-left: 10px;
}

.goods-detail-wrap .ofl-hide{
  max-height: 152px;
  overflow: hidden;
}


/*电商修改后样式*/
#goodsDetail .allComment {
  color:#ff7100;
  border:1px solid #ff7100;
  width: 85px;
  line-height: 22px;
  font-size: 12px;
  border-radius: 13px;
  display: inline-block;
}
#goodsDetail .comment-date {
  margin: 8px 0;
}
#goodsDetail .goods-other-info {
  font-size: 12px;
}
#goodsDetail .comment-img li {
  width: 93px;
  height: 93px;
  margin-right: 8px;
  display: inline-block;
}
#goodsDetail .comment-img img {
  width: 100%;
  height: 100%;
}
#goodsDetail .comment-img li:last-child {
  margin: 0;
}
#goodsDetail .line{
  width:45px;
  height:1px;
  background:#ccc;
  display:inline-block;
  vertical-align:middle;
}
#goodsDetail .goods-ico {
  font-size:16px;
  vertical-align:middle;
  margin:0 6px;
}
#goodsDetail .goods-other-info > div {
  margin: 0 20px 6px 0;
  color: #666;
  display: inline-block;
  font-size: 12px;
  line-height: 20px;
}
</style>
<div class="goods-detail-wrap page" id="goodsDetail">
  <div class="goods-detail-nav">
    <span class="pull-right router icon-notebook ico-moon" data-router="myOrder"></span>
    <!-- <span class="pull-right router icon-shoppingcart" data-router="shoppingCart"></span> -->
  </div>
  <div class="goods-detail-content">
    <div class="goods-detail-section">
      <div class="slick-carousel-container"></div>
      <div class="group-price">
        <div class="goods-current-price">
          ¥<text style="font-weight:bold; font-size:30px;">10~15</text>
        </div>
        <div class="goods-origin-price">
          <text style="color：#fff;text-decoration:line-through;">¥20~30</text>
        </div>
        <div class="group-times">
          <div>活动时间</div>
          <div style="line-height:20px;">2017-06-01~2017-10-15</div>
        </div>
      </div>

      <div class="goods-seckill">
        <div class="goods-seckill-left">
          <div class="goods-seckill-current">
            <div class="goods-current-price"><span>￥&nbsp;</span><b class="js-current-price"></b></div>
            <!-- <div class="goods-price-discount"></div> -->
          </div>
          <div class="goods-seckill-original">
            <span class="goods-original-price"></span>
            <span class="goods-seckill-sign"><span class="icon-business-time"></span>秒杀商品</span>
          </div>
        </div>
        <div class="goods-seckill-right">
          <div class="countdown"><label>距开始</label><span class="hours">00</span>:<span class="minutes">00</span>:<span class="seconds">00</span></div>
        </div>
      </div>
      <div class="goods-header">
        <div class="goods-title">商品标题</div>
        <div class="goods-price goods-goods">
          <div class="goods-current-price"><span>￥&nbsp;</span><span class="js-current-price" style="font-size: 18px;"></span></div>
          <div class="goods-price-discount"></div>
        </div>
        <div class="goods-models">
          <dl><dt>颜色</dt><dd>红色、黄色</dd></dl>
          <dl><dt>型号</dt><dd>L、M、S</dd></dl>
        </div>
        <div class="goods-other-info">
          <div>库存：<span class="goods-all-stock">111</span></div>
          <div>运费：<span class="express-fee">免运费</span></div>
        </div>
      </div>
    </div>

    <div class="goods-detail-section" style="padding:0 15px;" id="group-rules">
      <div class="group-rule">
        <div class="group-tag">拼团</div>
        <text style="vertical-align:middle;display:inline-block;color:#666;">查看拼团规则</text>
        <div class="ico-moon icon-rightarrow" style="color:#ddd;float:right;height: 45px;line-height: 45px;"></div>
      </div>
      <div class="group-step">
        <div class="ico-moon icon-group-join"></div>
        <text class="arr">&gt;&gt;</text>
        <div class="ico-moon icon-group-pay1"></div>
        <text class="arr">&gt;&gt;</text>
        <div class="ico-moon icon-group-complete"></div>
        <div class="step-description">
          <text>加入拼团或自己开团</text><text>支付货款</text><text>拼团成功分别发货逾期未完成退款</text>
        </div>
      </div>
    </div>

    <div id="groups-wrap" class="goods-detail-section" style="padding:0 15px;">
      <div class="grouping">进行中的拼团：</div>
      <div class="group-item-wrap">
        <div class="group-item">
          <img src="app_data/t_14966428515934f523ae28a.png">
          <div class="group-item-content">
            <div style="font-weight:bold;">大东</div>
            <div style="color:#666;font-size:12px;">还差<text style="color:red;">5</text>人 剩余20:12:56</div>
          </div>
          <div class="group-item-price">￥20</div>
          <div class="join-group-btn" data-num="" data-token="">去参团</div>
        </div>
      </div>
      <div class="more-group">查看全部拼团 <div class="ico-moon icon-downarrow"></div></div>
      <div class="more-group">收起 <div class="ico-moon icon-downarrow" style="transform:rotate(180deg);"></div></div>
      <div class="no-group">
        <text>暂无进行中的拼团</text><div class="start-group open-group">马上开团</div>
      </div>
    </div>
<!--     <div class="goods-detail-section">
      <div class="block-item goods-app-item right-arrow-bar icon-rightarrow"><span class="goods-app-name"></span><span class="pull-right">进入应用</span></div>
    </div> -->
    <div style="padding: 8px;text-align:center;background:#f4f4f4;color:#b2b2b2;font-size:12px;">
      <div class="line"></div>
      <span class="icon-good-comment goods-ico"></span><span style="display: inline-block;vertical-align:middle;margin-right:3px;">评价</span>
      <div class="line"></div>
    </div>
    <div class="goods-detail-section">
      <div class="block-item">
        <div style="border-bottom:1px solid #f4f4f4;padding-bottom: 8px;">评价 (<span class="goods-comment-count">0</span>)</div>
        <!-- <div>
          <span class="goods-comment-label">有图 (<span class="goods-pic-comment">0</span>)</span>
          <span class="goods-comment-label">好评 (<span class="goods-positive-comment">0</span>)</span>
          <span class="goods-comment-label">中评 (<span class="goods-neutral-comment">0</span>)</span>
          <span class="goods-comment-label" style="background: #f4f4f4">差评 (<span class="goods-negative-comment">0</span>)</span>
        </div> -->
        <div class="comment-item"></div>
        <div style="text-align:center;"><a data-router="commentPage" class="allComment" style="">查看全部评价</a></div>
      </div>
    </div>
    <div style="padding: 8px;text-align:center;background:#f4f4f4;color:#b2b2b2;font-size:12px;">
      <div class="line"></div>
      <span class="icon-good-detail goods-ico"></span><span style="display: inline-block;vertical-align:middle;margin-right:3px;">详情</span>
      <div class="line"></div>
    </div>
    <div class="goods-detail-section">
      <div class="block-item">
        <div style="border-bottom:1px solid #f4f4f4;padding-bottom: 8px;" "="">产品详情</div>
        <div class="goods-details">hello goods</div>
      </div>
    </div>
  </div>
<!--   <div class="goods-bottom-opt">
    <div class="goods-appointment-bottom-bar">
      <div class="btn btn-orange make-appointment">去预约</div>
    </div>
    <div class="flex-box goods-bottom-bar">
      <div class="goods-opt-item flex-sub-box-2">
        <div class="btn btn-orange buy-goods-directly">立即购买</div>
      </div>
      <div class="goods-opt-item flex-sub-box-2">
        <div class="btn add-to-shoppingcart">加入购物车</div>
      </div>
    </div>
  </div> -->
  <div class="goods-bottom-opt" id="common-bottom">
    <div class="goods-appointment-bottom-bar">
      <div class="btn btn-orange make-appointment">去预约</div>
    </div>
    <div class="goods-bottom-bar">
      <div class="flex-sub-box-3">
        <div class="goods-opt-item flex-sub-box-2 router" data-router="shoppingCart">
          <text class="ico-moon icon-shoppingcart"></text>
          <div>购物车</div>
        </div>
        <div class="goods-opt-item flex-sub-box-2 router" data-router="appHomepage">
          <text class="ico-moon icon-store2"></text>
          <div>店铺</div>
        </div>
      </div>
      <div class="flex-sub-box-3">
        <label class="btn btn-yellow add-to-shoppingcart">加入购物车</label>
      </div>
      <div class="flex-sub-box-3">
        <label class="btn btn-orange buy-goods-directly">立即购买</label>
      </div>
    </div>
  </div>

  <div class="goods-bottom-opt" id="group-bottom">
    <div class="flex-sub-box-2">
      <label class="btn buy-goods-directly" style="background-color:#f33c52;">单独购买</label>
    </div>
    <div class="flex-sub-box-2">
      <label class="btn open-group" style="background-color:#d0011b;">马上开团</label>
    </div>
  </div>
</div>
<script>
(function(){
  $('#goodsDetail').on('click', '.goods-app-item', function(){
    // 进入应用
    window.location.href = '/app?_app_id='+GetQueryString('_app_id');

  }).on('click', '[data-router="commentPage"]', function(){
    var para = {
          router: 'commentPage',
          detail: GetQueryString('detail')
        };

    APP.turnToPage(para);
  }).on('click','#group-rules',function(){
    APP.turnToPage({
      router: 'groupRules'
    });
  });

})();
</script>

    <style type="text/css">
#previewGoodsOrder {
	background: #f4f4f4;
	padding-bottom: 70px;
}
#previewGoodsOrder .goods-min-num, #previewGoodsOrder .goods-add-num {
  position:relative;
  display:inline-block;
  font-size:16px;
  line-height:10px;
  font-weight:700;
  color:#666;
  outline:0!important;
  width:37px;
  height:29px;
  background-color:#fff;
  border:1px solid #999;
  text-indent:-9999px;
  overflow:hidden;
  vertical-align:middle;
  width:20px;
  height:20px;
  line-height:20px;
  font-weight:normal;
  background-color:#ffcc01;
  border-color:#ffcc01;
  border-radius:50%;
}
#previewGoodsOrder .goods-min-num {
  background-color:#fff;
  border-color:#333;
}
#previewGoodsOrder .goods-min-num::before,#previewGoodsOrder .goods-add-num::after {
  position:absolute;
  width:8px;
  height:2px;
  top:0;
  left:0;
  right:0;
  margin:auto;
  background-color:#6c6c6c;
  bottom:0;
  content:'';
}
#previewGoodsOrder .goods-add-num::after {
  position:absolute;
  top:0;
  bottom:0;
  left:0;
  right:0;
  margin:auto;
  content:'';
  width:2px;
  height:8px;
  background-color:#6c6c6c;
}
#previewGoodsOrder .goods-add-num::before {
  position:absolute;
  width:8px;
  height:2px;
  top:0;
  left:0;
  right:0;
  margin:auto;
  background-color:#6c6c6c;
  bottom:0;
  content:'';
}
#previewGoodsOrder .goods-add-num::before,#previewGoodsOrder .goods-add-num::after {
  background-color:#fff;
}
#previewGoodsOrder .preview-goods-list li>div{
	display: inline-block;
	vertical-align: top;
}
#previewGoodsOrder .goods-list-title{
	margin-left: 13px;
	width: 100px;
}
#previewGoodsOrder .preview-goods-list li {
	margin-bottom: 2px;
}
#previewGoodsOrder .preview-goods-section {
	padding: 13px;
	background: #fdfdfd;
	margin-bottom: 2px;
}
#previewGoodsOrder .goods-list-title p {
  text-overflow: ellipsis;
  overflow: hidden;
  white-space: nowrap;
}
#previewGoodsOrder .goods-title-price{
	color: #ff7100;
}
#previewGoodsOrder .preview-goods-remark-input {
	width: 100%;
	height: 80px;
  padding: 8px;
  box-sizing: border-box;
	border: none;
	background-color: #e9e7e8;
	outline: none;
	resize: none
}
#previewGoodsOrder .preview-goods-discount-select {
	width: 100%;
	height: 100%;
	position: absolute;
	top: 0;
	left: 0;
	outline: none;
	opacity: 0;
}
#previewGoodsOrder .goods-list-img img {
	width: 50px;
	height: 50px;
}
#previewGoodsOrder .goods-sure-num {
	margin: 0 10px;
}
#previewGoodsOrder .preview-goods-discount-box {
	position: relative;
}
#previewGoodsOrder .preview-goods-discount-select option {
	width: 100%;
}
#previewGoodsOrder .limit-word {
  font-size: 12px;
  background: #e9e7e8;
  margin-top: -14px;
  text-align: right;
  padding-right: 5px;
  position: relative;
  z-index: 10;
}
#previewGoodsOrder .bottom-nav {
  line-height: 47px;
  border-top:1px solid #eee;
  font-size: 0;
  background-color: #fff;
}
#previewGoodsOrder .preview-goods-total-price {
  display: inline-block;
  width: calc(100% - 100px);
  font-size: 14px;
  vertical-align:middle;
  color: #666;
  text-align: left;
  text-indent: 15px;
}
#previewGoodsOrder .bottom-nav .preview-goods-goto-pay {
  display: inline-block;
  width: 100px;
  font-size: 14px;
  border-radius: 0;
  color: #fff;
  background-color: #ff7100;
  line-height: inherit;
  vertical-align: middle;
}
#previewGoodsOrder .preview-goods-list .preview-goods-num-options {
  display: inline-block;
  float: right;
  margin-top: 10px;
}
#previewGoodsOrder .radio-box.checked {
  background-color: #333;
}
#previewGoodsOrder .radio-box {
  display: inline-block;
  width: 20px;
  height: 20px;
  padding: 4px 3px;
  margin-right: 6px;
  box-sizing: border-box;
  border-radius: 50%;
  line-height: 13px;
  background-color: #c7c4c4;
}
#previewGoodsOrder .radio-box img {
  width: 100%;
}
#previewGoodsOrder .preview-goods-selfhelp-detail {
	display: none;
}
#previewGoodsOrder .orderDetail-payment {
  margin: 5px 0 0;
}
#previewGoodsOrder .right-arrow-bar {
  line-height: 18px;
  color: #444;
  padding-right: 30px;
}
#previewGoodsOrder .right-arrow-bar:before {
  font-size: 16px;
  width: 25px;
}
#previewGoodsOrder .preview-goods-discount-box .icon-rightarrow {
  margin-right: -6px;
  font-size: 16px;
}
.inweixin #previewGoodsOrder .preview-goods-payment-section {
  display: none;
}
</style>
<div class="page" id="previewGoodsOrder">
	<div>
		<ul class="preview-goods-list"></ul>
	</div>
	<div class="preview-goods-order-remark preview-goods-section">
		<textarea class="preview-goods-remark-input" placeholder="买家留言"></textarea>
		<div class="limit-word"><span>0</span>/30</div>
	</div>
  <div class="preview-goods-section preview-goods-delivery-way">
    <span class="preview-goods-radio-box radio-box checked" pickup-way="express"><img src="app_data/checked.png"></span>快递
    <span class="preview-goods-radio-box radio-box" pickup-way="selfhelp" style="margin-left: 30px;"><img src="app_data/checked.png"></span>上门自提
  </div>
  <div class="preview-goods-section preview-goods-address-detail right-arrow-bar icon-rightarrow"></div>
  <div class="preview-goods-section preview-goods-selfhelp-detail">
    <div>
      <p class="ico-moon icon-location">
      	<span class="preview-goods-store-name"></span>
      </p>
    </div>
    <div style="margin: 12px 0;">
      <p class="ico-moon icon-phone">
      	<a class="preview-goods-store-phone" href=""></a>
      </p>
    </div>
    <div style="font-size:12px;color:#aaa;">亲，勾选上门自提，需要自己去门店取货哦!</div>
  </div>
  <div class="preview-goods-section" style="margin-top:10px;">
  	<span>商品金额</span>
  	<span class="pull-right" style="color:#f15a0c;">￥ <span class="preview-goods-total-count"></span></span>
  </div>
	<div class="preview-goods-section preview-goods-discount-box">
    <span>优惠方式：</span>
		<div class="pull-right icon-rightarrow"></div>
	  <select class="preview-goods-discount-select"></select>
		<div style="margin-top:10px;">
      <span class="preview-goods-selected-discount"></span>
		  <span class="pull-right preview-goods-deduction-container">- ￥ <span class="preview-goods-deduction"></span></span>
    </div>
	</div>
	<div class="preview-goods-section">
		<span>运费</span>
		<span class="pull-right">¥ <span class="preview-goods-express-fee"></span></span>
	</div>
	<div class="preview-goods-section preview-goods-balance-section">
		<div>
			<span>使用储值金</span>
			<div class="switch-btn pull-right">
        <input class="preview-goods-switch-input" checked="checked" type="checkbox">
        <label class="switch-btn-inner"></label>
      </div>
    </div>
    <div class="preview-balance-deduction-section" style="margin-top: 10px;"><span>储值金抵扣</span><span class="pull-right">- ￥ <span class="preview-goods-use-balance"></span></span></div>
	</div>
	<div class="preview-goods-section preview-goods-payment-section">
    <div class="orderDetail-payment"><img src="app_data/weixin.jpg"><span class="pull-right orderDetail-check-box check-box checked" payment="0"><img src="app_data/checked.png"></span></div>
    <div class="orderDetail-payment" payment="zfb"><img src="app_data/zhifubao.jpg"><span class="pull-right orderDetail-check-box check-box" payment="1"><img src="app_data/checked.png"></span></div>
  </div>
  <div class="preview-goods-section writeAdditionalInfo">
    <span>补充信息</span>
    <span class="pull-right icon-rightarrow"></span>
  </div>
  <div class="bottom-nav">
    <div class="preview-goods-total-price">合计: <span style="color:#f15a0c;">￥ <span class="preview-goods-pay-count"></span></span></div>
    <span class="preview-goods-goto-pay">去付款</span>
  </div>
</div>
<script type="text/javascript">
(function(){
	var appId = GetQueryString('_app_id'),
      _previewGoodsOrder;

	$('#previewGoodsOrder').on('click','.goods-add-num, .goods-min-num',function(){
    // 商品个数加减
    var $this = $(this),
        type = $this.attr('data-type'),
        number = +$this.closest('.preview-goods-num-options').find('.goods-sure-num').text(),
        goodsLi = $this.closest('li'),
        goodsIndex = goodsLi.attr('goods-index'),
        price = +goodsLi.attr('price'),
        number = type == 'add' ? number + 1 : number - 1,
        _previewGoodsOrder = _previewGoodsOrder || APP.OfficialPages['preview-goods-order'],
        seckill = goodsLi.attr('data-seckill');

    if(number < 1 ){
      confirmTip({content:'确定删除该商品？'}, function(){
        $ajax('/index.php?r=AppShop/deleteCart','post',{
          app_id: appId,
          cart_id_arr: [goodsLi.attr('id')],
          sub_shop_app_id: GetQueryString('franchisee')
        },'json',function(data) {
          if (data.status !== 0) {
            alertTip(data.data);
            return;
          }
          _previewGoodsOrder.cart_arr.splice(goodsIndex, 1);

          // 到店无商品返回上一页
          if(!_previewGoodsOrder.cart_arr.length){
            window.history.back();
            return;
          }

          goodsLi.remove();

          for(var i=0;i<goodsLi.siblings('li').length;i++){
            if(goodsLi.attr('goods-id') != goodsLi.siblings('li')[i].attr('goods-id')){
              var additional_info = JSON.parse($('#previewGoodsOrder .writeAdditionalInfo').attr('data-goodsinfo'));
              delete additional_info[goodsLi.attr('goods-id')];
              $('#previewGoodsOrder .writeAdditionalInfo').attr('data-goodsinfo',JSON.stringify(additional_info));
            }
          }

          resetTemplateGoodsIndex();
          _previewGoodsOrder.selected_benefit = '';
          _previewGoodsOrder.getPreviewPrice();




        })
      });
      return;
    }

    $ajax(
      '/index.php?r=AppShop/addCart','get',{
        app_id: appId,
        goods_id: goodsLi.attr('goods-id'),
        sub_shop_app_id: GetQueryString('franchisee'),
        model_id: goodsLi.attr('model-id') || 0,
        ck_id: GetCookiePara(),
        num: number,
        is_seckill : seckill == 1 ? 1 : ''
      },'json',function(data) {
        if (data.status !== 0) {
          alertTip(data.data);
          return;
        }
        _previewGoodsOrder.cart_arr[goodsIndex] = data.data;
        _previewGoodsOrder.selected_benefit = '';
        $this.closest('.preview-goods-num-options').find('.goods-sure-num').text(number);
        _previewGoodsOrder.getPreviewPrice();
      }
    );

  }).on('click', '.preview-goods-goto-pay' ,function(){
    // 生成订单并支付
    var remark = $('#previewGoodsOrder .preview-goods-remark-input').val().trim();

  	if( remark.length > 30){
  		alertTip('买家留言字数超过30');
  		return;
  	}

    var payIdArr = [],
        _previewGoodsOrder = _previewGoodsOrder || APP.OfficialPages['preview-goods-order'],
        selected_benefit = _previewGoodsOrder.selected_benefit,
        additional_info = '',
        paymentWay = $('#previewGoodsOrder .orderDetail-payment').find('.orderDetail-check-box.checked').attr('payment'),
        franchisee = GetQueryString('franchisee');

    if(_previewGoodsOrder.is_self_delivery == 0 && !_previewGoodsOrder.address_id){
      alertTip('请选择地址');
      return;
    }

    $.each($('#previewGoodsOrder .preview-goods-list li'),function(i,ele){
      payIdArr.push({
        cart_id: $(ele).attr('id'),
        goods_id: $(ele).attr('goods-id'),
        model_id: $(ele).attr('model-id'),
        num: $(ele).find('.goods-sure-num').text()
      });
    })

    if($('#previewGoodsOrder .writeAdditionalInfo').css('display') != 'none'){
      if($('#previewGoodsOrder .writeAdditionalInfo').attr('data-goodsinfo')){
        additional_info = JSON.parse($('#previewGoodsOrder .writeAdditionalInfo').attr('data-goodsinfo'));
      }else{
        alertTip('请填写补充信息');
        return;
      }
    }

    if(_previewGoodsOrder.requesting){
      return;
    }
    _previewGoodsOrder.requesting = true;

    if (paymentWay == 1) {
      var newWindow = window.open();
    }

    $ajax('/index.php?r=AppShop/addCartOrder','post',{
      app_id: appId,
      cart_arr: payIdArr,
      sub_shop_app_id: franchisee,
      selected_benefit: selected_benefit,
      is_balance: _previewGoodsOrder.is_balance ? 1 : 0,
      is_self_delivery: _previewGoodsOrder.is_self_delivery,
      remark: remark,
      address_id: _previewGoodsOrder.address_id,
      additional_info: additional_info

    },'json', function(data){
      if(data.status != 0){
        _previewGoodsOrder.requesting = false;
        if (paymentWay == 1) {
          newWindow.close();
        }
        alertTip(data.data);
        return;
      }

      // 支付
      var orderId = data.data;
      function paySuccessCallback(){
        if(! franchisee ){
          $.ajax({
            url: '/index.php?r=AppMarketing/CheckAppCollectmeStatus',
            type: 'get',
            data: {
              'app_id': appId,
              'order_id': orderId
            },
            dataType: 'json',
            success: function(res){
              var collectBenefit = '';
              if(res.valid == 0){
                collectBenefit = 1;
              }
              APP.turnToPage({
                router: 'goodsOrderPaySuccess',
                detail: orderId,
                franchisee: franchisee,
                collectBenefit: collectBenefit,
                redirect: true
              });
            }
          });
        } else {
          APP.turnToPage({
            router: 'goodsOrderPaySuccess',
            detail: orderId,
            franchisee: franchisee,
            redirect: true
          });
        }
      }
      if(_previewGoodsOrder.payment == 0){
        $.ajax({
          url: '/index.php?r=AppShop/paygoods',
          type: 'get',
          dataType: 'json',
          data: {
            app_id: appId,
            order_id: orderId,
            total_price: 0
          },
          success: function(res){
            _previewGoodsOrder.requesting = false;
            if(res.status != 0){
              alertTip(res.data);
              return;
            }
            alertTip('支付成功', function(){
              paySuccessCallback();
            });
          },
          fail: function(){
            _previewGoodsOrder.requesting = false;
          }
        });
        return;
      }
      _previewGoodsOrder.requesting = false;
      if (paymentWay == 1) {
        newWindow.location.href = '/index.php?r=AppShop/getUniPay&order_id=' + orderId + '&payment_id=1';
        // window.open('/index.php?r=AppShop/getUniPay&order_id=' + orderId + '&payment_id=1');
        window.history.back();
      } else {
        // 获取二维码
        $.ajax({
          url: '/index.php?r=AppShop/getOrder',
          dataType: 'json',
          data: {
            order_id: orderId,
            app_id: appId,
            sub_shop_app_id: franchisee
          },
          success:function(data){
            if(data.status !== 0){
              alertTip(data.data);
              return;
            }
            APP.setPayPageCode(data);
            APP.turnToPage({
              router: 'payPage',
              detail: orderId,
              franchisee: franchisee,
              redirect: true
            });
          }
        });
      }
    }, function(){
      _previewGoodsOrder.requesting = false;
      if (paymentWay == 1) {
        newWindow.close();
      }
    })

  }).on('click', '.orderDetail-check-box', function() {
    // 选择支付方式
    $('#previewGoodsOrder .orderDetail-check-box.checked').removeClass('checked');
    $(this).addClass('checked');

  }).on('change','.preview-goods-discount-select',function(){
    // 更改优惠方式
    var index = $(this).val(),
        _previewGoodsOrder = _previewGoodsOrder || APP.OfficialPages['preview-goods-order'];

    _previewGoodsOrder.selected_benefit = _previewGoodsOrder.benefit_list[index];
  	$('#previewGoodsOrder .preview-goods-selected-discount').text(_previewGoodsOrder.selected_benefit.name);
    if(index == 0){
      $('#previewGoodsOrder .preview-goods-deduction-container').hide();
    } else {
      $('#previewGoodsOrder .preview-goods-deduction-container').show();
    }
    _previewGoodsOrder.getPreviewPrice();

  }).on('click','.preview-goods-radio-box',function(){
    // 更换取货方式
    _previewGoodsOrder = _previewGoodsOrder || APP.OfficialPages['preview-goods-order'];
    $(this).addClass('checked').siblings('.checked').removeClass('checked');
    if($(this).attr('pickup-way') == 'express'){
      $('#previewGoodsOrder .preview-goods-address-detail').show().siblings('.preview-goods-selfhelp-detail').hide()
      _previewGoodsOrder.is_self_delivery = 0;

    } else {
      $('#previewGoodsOrder .preview-goods-address-detail').hide().siblings('.preview-goods-selfhelp-detail').show();
      _previewGoodsOrder.is_self_delivery = 1;
    }
    _previewGoodsOrder.getPreviewPrice();

  }).on('change','.preview-goods-switch-input',function(){
    _previewGoodsOrder = _previewGoodsOrder || APP.OfficialPages['preview-goods-order'];

    if($(this).prop('checked')){
      _previewGoodsOrder.is_balance = 1;
      $('#previewGoodsOrder .preview-balance-deduction-section').show();
    } else {
      _previewGoodsOrder.is_balance = 0;
      $('#previewGoodsOrder .preview-balance-deduction-section').hide();
    }
    _previewGoodsOrder.getPreviewPrice();

  }).on('input','.preview-goods-remark-input',function(evt){
    var val = evt.target.value;
		if(val.length >= 30){
			$('#previewGoodsOrder .limit-word').css('color','red');
      val = val.slice(0, 30);
		}else{
			$('#previewGoodsOrder .limit-word').css('color','');
		}
    $('#previewGoodsOrder .limit-word span').text(val.length);
    $(this).val(val);

  }).on('click', '.preview-goods-address-detail', function() {
    APP.turnToPage({
      router: 'addressDialog',
      from: 'previewGoodsOrder'
    })
    // APP.showAddressDialog();

  }).on('click','.writeAdditionalInfo',function(){
    var additionArr = $('#previewGoodsOrder .writeAdditionalInfo').data('additionalArr'),
        arr = [];
    for(var i = 0;i < additionArr.length;i++){
      arr.push(additionArr[i].delivery_id);
    }
    APP.turnToPage({
      router: 'goodsAdditionalInfo',
      additionalArr: arr,
      from: 'previewGoodsOrder'
    })
  });

  function resetTemplateGoodsIndex(){
    $('#previewGoodsOrder .preview-goods-list li').each(function(index, el){
      $(el).attr('goods-index', index);
    });
  }

})();


</script>

    <style rel="stylesheet">
#goodsOrderPaySuccess {
  height: 100%;
  background: #efeff5;
}
#goodsOrderPaySuccess .normal-area {
  text-align: center;
  padding-top: 40px;
  background-color: #fff;
}
#goodsOrderPaySuccess .normal-area img {
  width: 80%;
}
#goodsOrderPaySuccess .normal-area .goods-order-success-tip {
  padding: 13px 0;
  font-size: 16px;
}
#goodsOrderPaySuccess .collect-benefit-area {
  background: #fff;
  color:#818181;
}
#goodsOrderPaySuccess .collect-item {
  position: relative;
  width: 100%;
  border-bottom: 1px solid #ddd;
  overflow:hidden;
}
#goodsOrderPaySuccess .collect-item .star-num {
  margin: 10px 20px 15px;
}
#goodsOrderPaySuccess .collect-item .star-list {
  margin: 0 auto 10px;
  width: 195px;
  text-align: left;
  font-size: 0;
}
#goodsOrderPaySuccess .collect-item .star-list .star-item {
  display: inline-block;
  width: 30px;
  height: 30px;
  margin-right: 15px;
  margin-bottom: 10px;
}
#goodsOrderPaySuccess .collect-item .star-list .star-item:nth-of-type(4n-3) {
  margin-left: 15px;
}
#goodsOrderPaySuccess .collect-item .star-full {
  position: absolute;
  top: -12px;
  right: -12px;
  transform: rotate(-25deg);
  padding: 4px;
  border: 1px solid #fd888a;
  border-radius: 50%;
}
#goodsOrderPaySuccess .collect-item .star-full-text {
  width: 40px;
  height: 40px;
  line-height: 40px;
  font-size: 23px;
  text-align: center;
  color: #fd888a;
  border: 1px solid #fd888a;
  border-radius: 50%;
}
#goodsOrderPaySuccess .collect-benefit-area .tip-item {
  line-height: 20px;
  padding: 10px 20px;
}
/* 按钮区域 */
#goodsOrderPaySuccess .btn-area {
  display: none;
}
#goodsOrderPaySuccess .btn-area .finish-btn {
  display: block;
  margin: 15px 15px 0;
  height: 38px;
  line-height: 38px;
  background-color: #ff7100;
  text-align: center;
  color: #fff;
  border-radius: 5px;
}
#goodsOrderPaySuccess .btn-area .check-order-btn {
  display: block;
  margin: 10px 15px 0;
  height: 38px;
  line-height: 38px;
  border: 1px solid #e5e6ea;
  background-color: #fff;
  text-align: center;
  color: #000;
  border-radius: 5px;
}
</style>
<div class="page" id="goodsOrderPaySuccess">
  <div class="normal-area">
    <div>
      <img src="app_data/file_5940abcba6241.jpg">
    </div>
    <div class="goods-order-success-tip">支付成功</div>
  </div>
  <div class="collect-benefit-area">
    <div class="collect-item">
      <div class="star-num">集集乐个数: <span class="star-number"></span></div>
      <div class="star-list"></div>
      <div class="star-full">
        <div class="star-full-text">满</div>
      </div>
    </div>
    <div class="tip-item">
      <div class="full-tip">获得一张<span class="collect-reward"></span></div>
      <div class="no-full-tip">消费每满<span class="collect-value"></span>元，累计一颗星，集满可获得<span class="collect-reward"></span>一张</div>
    </div>
  </div>
  <div class="btn-area">
    <span class="finish-btn">完成</span>
    <span class="check-order-btn">查看订单</span>
  </div>
</div>
<script>
(function(){
  $('#goodsOrderPaySuccess').on('click', '.finish-btn', function(){
    // 进入应用
    window.location.href = '/app?_app_id='+GetQueryString('_app_id');

  }).on('click', '.check-order-btn', function(){
    APP.turnToPage({
      router: 'goodsOrderDetail',
      detail: GetQueryString('detail'),
      franchisee: GetQueryString('franchisee'),
      redirect: true
    })
  });

})();
</script>

    <style rel="stylesheet">
#shoppingCart .shoppingCart-top-nav {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  height: 42px;
  line-height: 42px;
  padding: 0 10px;
  margin-bottom: 10px;
  text-align: center;
  z-index: 9;
  box-shadow: 0 1px 2px #eee;
  background-color: #fff;
}
#shoppingCart .top-nav-right {
  position: absolute;
  top: 0;
  right: 10px;
}
#shoppingCart .shoppingCart-edit-complete {
  display: none;
}

#shoppingCart .shoppingCart-edit-bar {
  display: none;
  position: fixed;
  top: 51px;
  left: 0;
  right: 0;
  background: #fff;
  margin-bottom: 10px;
  line-height: 31px;
  padding: 5px 10px;
}
#shoppingCart .shoppingCart-list-wrap {
  /*position: absolute;*/
  margin-top: 45px;
  margin-bottom: 45px;
  background-color: #e6e6e6;
  /*left: 0;*/
  /*right: 0;*/
  overflow-x: hidden;
  overflow-y: auto;
  -webkit-transition: all linear .5s;
          transition: all linear .5s;
}
#shoppingCart .shoppingCart-goods-list {
  background-color: #fff;
  margin-bottom: 10px;
}
#shoppingCart .shoppingCart-goods-list:last-child {
  margin-bottom: 0;
}
#shoppingCart .shoppingCart-goods-list > li {
  position: relative;
  overflow: hidden;
  border-bottom:1px solid #e5e5e5;
}
#shoppingCart .shoppingCart-goods-list > li:first-child{
  border-top:1px solid #e5e5e5;
}
#shoppingCart .shoppingCart-goods-content {
  padding: 10px 90px 10px 0;
  height: 60px;
}
#shoppingCart .shoppingCart-goods-right {
  position: absolute;
  bottom: 10px;
  right: 12px;
  line-height: 20px;
  text-align: right;
}
#shoppingCart .shoppingCart-goods-list .check-box {
  margin: 23px 10px 0;
  float: left;
}
#shoppingCart .shoppingCart-goods-cover {
  width: 60px;
  height: 60px;
  float: left;
  margin-right: 10px;
}
#shoppingCart .shoppingCart-goods-title {
  font-size: 12px;
}
#shoppingCart .shoppingCart-bottom-nav {
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  padding-left: 10px;
  line-height: 45px;
  z-index: 9;
  background-color: #fff;
  box-shadow: 0 -1px 2px #eee;
}
#shoppingCart .shoppingCart-all-price {
  color: #ff7100;
}
#shoppingCart .shoppingCart-goto-pay {
  width: 80px;
  background-color: #ff7100;
  color: #fff;
  border-radius: 0;
  line-height: 45px;
  padding: 0 5px;
}
.shoppingCart-pay-dialog {
  text-align: center;
}
.shoppingCart-pay-dialog .shoppingCart-check-box {
  margin-top: 6px;
}
.shoppingCart-dialog-detail > div {
  line-height: 34px;
}
.shoppingCart-payment {
  text-align: left;
  padding: 0 15px;
}
.shoppingCart-pay-directly {
  margin: 0 15px;
}


/*按钮样式*/
#shoppingCart .minus,
#shoppingCart .plus {
  position: relative;
  display: inline-block;
  font-size: 16px;
  outline: 0!important;
  text-indent: -9999px;
  overflow: hidden;
  vertical-align: middle;
  width: 20px;
  height: 20px;
  line-height: 20px;
  font-weight: normal;
  background-color: #f1f1f1;
  color: #878787;
  border-radius: 2px;
  border: none;
}
#shoppingCart .minus.disabled,
#shoppingCart .plus.disabled {
  background-color: #f9f9f9;
  color: #cacaca;
}
#shoppingCart .minus::before,
#shoppingCart .plus::after,
#shoppingCart .plus::before {
  position:absolute;
  width:8px;
  height:2px;
  top:0;
  left:0;
  right:0;
  margin:auto;
  background-color:#878787;
  bottom:0;
  content:'';
}
#shoppingCart .plus::after {
  width:2px;
  height:8px;
}
#shoppingCart .minus.disabled:before,
#shoppingCart .plus.disabled:before,
#shoppingCart .plus.disabled:after {
  background-color: #cacaca;
}
#shoppingCart input {
  border: none;
}
#shoppingCart .quantity input{
  border: none;
  height: 20px;
  background-color: #f1f1f1;
  padding: 0;
  margin: 0 1px;
  border-radius: 0;
}
.shoppingCart-goods-price-wrap{
  color:#ff7223;
  font-size:12px;
  margin-top:2px;
}
.shoppingCart-goods-original-price {
  margin-top: 2px;
  color: #818181;
  font-size: 10px;
}
.shoppingCart-goods-original-price > span{
  text-decoration: line-through;
}
</style>
<div class="shoppingCart-wrap page" id="shoppingCart">
  <div class="shoppingCart-top-nav">购物车<span class="top-nav-right"><span class="shoppingCart-edit-btn">编辑</span><span class="shoppingCart-edit-complete">完成</span></span></div>
  <div class="shoppingCart-bottom-nav">
    <span style="margin-right:5px;">
      <span class="shoppingCart-select-all shoppingCart-check-box check-box">
        <img src="app_data/checked.png">
      </span> 全选
    </span>
    <span class="btn pull-right shoppingCart-goto-pay">结算</span>
    <span class="pull-right" style="margin-right:10px;">合计:￥<span class="shoppingCart-all-price">0.00</span></span>
  </div>
  <div class="shoppingCart-edit-bar"><span class="shoppingCart-select-all check-box shoppingCart-check-box"><img src="app_data/checked.png"></span> 全选<span class="shoppingCart-delete-goods btn btn-red pull-right">删除所选</span></div>
  <div class="shoppingCart-list-wrap">
    <ul class="shoppingCart-goods-list">
      <!-- <li>
        <span class="shoppingCart-check-box check-box"><img src="http://cdn.jisuapp.cn/zhichi_frontend/static/webapp/images/checked.png"></span>
        <div class="shoppingCart-goods-content">
          <img class="shoppingCart-goods-cover">
          <div class="ellipsis shoppingCart-goods-title">茱莉蔻玫瑰护手霜 40ml</div>
          <div class="quantity">
            <button class="minus disabled" type="button" disabled="true"></button><input type="text" class="txt" value="1"><button class="plus" type="button"></button>
            <div class="response-area response-area-minus"></div>
            <div class="response-area response-area-plus"></div>
          </div>
        </div>
        <div class="shoppingCart-goods-right"><p>￥<span class="shoppingCart-goods-price">145.00</span></p><p>&times;<span class="shoppingCart-goods-count">1</span></p></div>
      </li> -->
    </ul>
  </div>
  <div class="shoppingCart-pay-dialog page-dialog-wrap">
    <div class="page-bottom-dialog">
      <div class="page-bottom-content">
        <div class="page-dialog-close shoppingCart-dialog-close">×</div>
        <div class="dialog-block-item shoppingCart-dialog-title">请选择支付方式</div>
        <div class="dialog-block-item shoppingCart-dialog-detail">
          <!-- <div>请在20分钟内完成支付</div> -->
          <div>支付金额<span class="shoppingCart-pay-price">￥0.00</span></div>
          <div class="shoppingCart-payment">使用支付宝支付 <span class="pull-right shoppingCart-check-box check-box checked"><img src="app_data/checked.png"></span></div>
          <div class="shoppingCart-payment">使用微信支付 <span class="pull-right shoppingCart-check-box check-box"><img src="app_data/checked.png"></span></div>
        </div>
        <div class="dialog-block-item">
          <div class="btn btn-red btn-block shoppingCart-pay-directly">立即支付</div>
        </div>
      </div>
    </div>
  </div>
</div>
<script>
(function(){

var $shoppingCart = $('#shoppingCart');
var appId = GetQueryString("_app_id");
$shoppingCart.on('click', '.shoppingCart-edit-btn', function(){
  // 编辑
  $(this).hide().siblings('.shoppingCart-edit-complete').css('display', 'block');
  $shoppingCart.find('.shoppingCart-edit-bar').slideDown();
  $shoppingCart.find('.shoppingCart-list-wrap').css({
    'margin-top': '100px',
    'margin-bottom': 0
  });
  $shoppingCart.find('.shoppingCart-bottom-nav').css('display', 'none');
  setSelectAll();

}).on('click', '.shoppingCart-edit-complete', function(){
  // 完成编辑
  $(this).hide().siblings('.shoppingCart-edit-btn').css('display', 'block');
  $shoppingCart.find('.shoppingCart-edit-bar').slideUp();
  $shoppingCart.find('.shoppingCart-list-wrap').css({
    'margin-top': '45px',
    'margin-bottom': '45px'
  });
  $shoppingCart.find('.shoppingCart-bottom-nav').css('display', 'block');
  recalculateCartCountPrice();
  setSelectAll();

}).on('click', '.response-area-plus', function(){
// 加商品个数
  var $input = $(this).siblings('input'),
      num = Number($input.val()) || 1,
      $minusBtn = $(this).siblings('.minus'),
      $plusBtn = $(this).siblings('.plus'),
      $goods = $(this).closest('li');

  if($plusBtn.hasClass('disabled')){
    return;
  }
  $minusBtn.removeClass('disabled');

  $.ajax({
    url: '/index.php?r=AppShop/addCart',
    type: 'get',
    data: {
      app_id   : appId,
      goods_id: $goods.attr('goods-id'),
      model_id: $goods.attr('model-id') || 0,
      ck_id: GetCookiePara(),
      num: ++num ,
      is_seckill : $goods.attr("is_seckill") == '1' ? 1 : ''
    },
    dataType: 'json',
    success: function(data){
      if(data.status !== 0) {
        alertTip(data.data);
        if(data.status === 2){
          $input.val(data.stock);
          $goods.find('.shoppingCart-goods-count').text(data.stock);
        }
      } else {
        $input.val(num);
        $goods.find('.shoppingCart-goods-count').text(num);
      }
      recalculateCartCountPrice();
      // setSelectAll();
    }
  });


}).on('click', '.response-area-minus', function(){
// 减商品个数
  var $input = $(this).siblings('input'),
      num = Number($input.val()) === NaN ? 1 : Number($input.val()),
      $minusBtn = $(this).siblings('.minus'),
      $plusBtn = $(this).siblings('.plus'),
      $goods = $(this).closest('li');

  if($minusBtn.hasClass('disabled')){
    return;
  }
  $plusBtn.removeClass('disabled');
  // $(this).closest('li').find('.shoppingCart-goods-count').text(num-1);
  if(num-1 <= 0){
     confirmTip({content:'确定删除该商品？'},function(){
      $.ajax({
        url : '/index.php?r=AppShop/deleteCart',
        type: 'get',
        data: {
          app_id   : appId,
          ck_id: GetCookiePara(),
          cart_id_arr: [$goods.attr('data-id')],
          sub_shop_app_id: GetQueryString('franchisee'),
        },
        dataType: 'json',
        success: function(data){
          if(data.status !== 0) { alertTip(data.data); return; }
          $goods.remove();
          recalculateCartCountPrice();
        }
      });
     })
    return;
  }
  $.ajax({
    url: '/index.php?r=AppShop/addCart',
    type: 'get',
    data: {
      app_id   : appId,
      goods_id: $goods.attr('goods-id'),
      model_id: $goods.attr('model-id') || 0,
      ck_id: GetCookiePara(),
      num: --num ,
      is_seckill : $goods.attr("is_seckill") == '1' ? 1 : ''
    },
    dataType: 'json',
    success: function(data){
      if(data.status !== 0) {
        alertTip(data.data);
        if(data.status === 2){
          $input.val(data.stock);
          $goods.find('.shoppingCart-goods-count').text(data.stock);
        }
      } else {
        $input.val(num);
        $goods.find('.shoppingCart-goods-count').text(num);
      }
      recalculateCartCountPrice();
      // setSelectAll();
    }
  });

}).on('click', '.shoppingCart-check-box', function(){
// 勾选
  if($(this).closest('.shoppingCart-pay-dialog').length){
    $shoppingCart.find('.shoppingCart-pay-dialog .shoppingCart-check-box').removeClass('checked');
    $(this).addClass('checked');
    return;
  }

  $(this).hasClass('checked') ? $(this).removeClass('checked') : $(this).addClass('checked');

  if($(this).hasClass('shoppingCart-select-all')){
    $(this).hasClass('checked')
    ? $shoppingCart.find('.shoppingCart-goods-list .shoppingCart-check-box').addClass('checked')
    : $shoppingCart.find('.shoppingCart-goods-list .shoppingCart-check-box').removeClass('checked');

  } else {
    setSelectAll();
  }
  recalculateCartCountPrice();

}).on('click', '.shoppingCart-goto-pay', function(){
// 结算
  var $selected = $shoppingCart.find('.shoppingCart-goods-list .shoppingCart-check-box.checked'),
      arr,
      goodsIdArr = [],
      goodsTypeArr,
      // notBusinessFlag = false,
      selectGoodsType = '',
      sameGoodsType = true;

  if(!$selected.length){
    alertTip('请选择商品');
    return;
  }

  goodsTypeArr = [];
  arr = [];
  $.each($selected, function(index, li){
    li = $(li).closest('li');
    var goods_type = li.attr('goodsType'),
        cart_id = li.attr('data-id');
    arr.push(cart_id);
    goodsTypeArr.push(goods_type);
    goodsIdArr.push({
              'cart_id':cart_id,
              'goods_id':li.attr('goods-id'),
              'model_id':li.attr('model-id'),
              'model':li.attr('model'),
              'num': li.find('input').val(),
              'goods_type': goods_type
            });

    selectGoodsType = selectGoodsType == '' ? goods_type : selectGoodsType;
    if(sameGoodsType && selectGoodsType != goods_type){
      sameGoodsType = false;
    }
  });

  if(!sameGoodsType){
    alertTip('商品混合，不可下单，请重新选择。');
    return;
  }

  $.ajax({
    url: '/index.php?r=AppShop/precheckShoppingCart',
    type: 'get',
    data: {
      app_id: appId,
      cart_arr: goodsIdArr || '',
      sub_shop_app_id: GetQueryString('franchisee') || '',
      parent_shop_app_id: GetQueryString('franchisee') ? appId : ''
    },
    dataType:'json',
    success:function(data){
      if(data.status == 1) {
        var goodsId = data.expired_goods_arr;
        if (goodsId.length && goodsId){
          for (var i = 0; i < goodsId.length; i++) {
            var id = goodsId[i].goods_id;
            for (var j = goodsIdArr.length - 1; j >= 0; j--) {
              if (id == goodsIdArr[j].goods_id) {
                // list[j].selected = false;
                // console.log(list[j].goods_id)
                confirmTip({content:data.data},function(){});
                // notBusinessFlag = true;
                $shoppingCart.find('.shoppingCart-goods-list li[goods-id='+id+']').find('.checked').trigger('click');
              }
            };
          }
        }

        recalculateCartCountPrice();
      } else if (data.status == 401 || data.status == 2){
        // 未登录
        // app.login();
        return;
      }else if(data.status == 0){
        if(selectGoodsType == 0){
          APP.OfficialPages['preview-goods-order'].address_id = '';
          APP.turnToPage({router:'previewGoodsOrder', cart_arr: arr});
        }else if(selectGoodsType == 3){
          APP.turnToPage({router:'tostorePayment', bussinessId: arr});
        }
      }
    }
  });

}).on('click', '.shoppingCart-delete-goods', deleteGoods);// 删除

$shoppingCart.find('.shoppingCart-list-wrap').on('scoll', function(){
  var $this = $(this);

  if($this.hasClass('scrolling')){ return; }
  $this.addClass('scrolling');
  setTimeout(function(){
    $this.removeClass('scrolling');
  }, 100);
  if(isScrollToBottom($this, $shoppingCart.find('.shoppingCart-goods-list'))){
    APP.getShoppingCartData();
  }
});

function deleteGoods(){
  var goodsList = $shoppingCart.find('.shoppingCart-goods-list .shoppingCart-check-box.checked'),
      idArr;

  if(!goodsList.length) { alertTip('请选择商品'); return; }

  idArr = [];
  $.each(goodsList, function(index, li){
    li = $(li).closest('li');
    idArr.push(li.attr('data-id'));
  });
  $.ajax({
    url : '/index.php?r=AppShop/deleteCart',
    type: 'get',
    data: {
      app_id   : appId,
      ck_id: GetCookiePara(),
      cart_id_arr: idArr,
      sub_shop_app_id: GetQueryString('franchisee'),
    },
    dataType: 'json',
    success: function(data){
      if(data.status !== 0) { alertTip(data.data); return; }
      goodsList.closest('li').remove();
    }
  });
}
function setSelectAll(){
  $shoppingCart.find('.shoppingCart-goods-list .shoppingCart-check-box').not('.checked').length
  ? $shoppingCart.find('.shoppingCart-select-all').removeClass('checked')
  : $shoppingCart.find('.shoppingCart-select-all').addClass('checked');
}

})();
function GetQueryString(name) {
    var reg = new RegExp("(^|&)"+ name +"=([^&]*)(&|$)"),
        r = window.location.search.substr(1).match(reg);

    if (r != null) {
        return decodeURIComponent(r[2]);
    }
    return null;
}
function recalculateCartCountPrice(){
  var $shoppingCart = $('#shoppingCart'),
      $checked = $shoppingCart.find('.shoppingCart-goods-list .checked'),
      totalCount = count = price = 0;

  $checked.length && $.each($checked, function(index, li){
    li = $(li).closest('li');
    count = Number($(li).find('.shoppingCart-goods-count').text());
    totalCount += count;
    price += Number($(li).find('.shoppingCart-goods-price').text()) * count;
  });

  $shoppingCart.find('.shoppingCart-goto-pay').find('span').text(totalCount);
  $shoppingCart.find('.shoppingCart-all-price').text('￥' + price.toFixed(2));
}

</script>

    <style rel="stylesheet">
.myOrder-wrap {
  background-color: #eee;
  height: 100%;
}
.myOrder-content-container {
  display: none;
  margin-top: 47px;
  overflow-x: hidden;
  overflow-y: auto;
}
.myOrder-all.myOrder-content-container {
  display: block;
}
.myOrder-tab-list {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  z-index: 1;
  line-height: 38px;
  background: #fff;
  text-align: center;
}
.myOrder-tab-list > li {
  border-bottom: 1px solid transparent;
}
.myOrder-tab-list > li.active {
  color: #ff7100;
  border-color: #ff7100;
}
.myOrder-pay-price {
  color: #d20e10;
}
.myOrder-list-wrap {
  padding: 0 10px;
  margin-bottom: 7px;
  background-color: #fff;
}
.myOrder-goods-cover {
  position: absolute;
  left: 0;
  width: 50px;
  height: 50px;
}
.myOrder-goods-title {
  padding: 0 73px 0 63px;
  height: 50px;
  font-size: 12px;
  overflow: hidden;
  word-break: break-all;
}
.myOrder-goods-right {
  position: absolute;
  top: 10px;
  right: 0;
  max-width: 73px;
  line-height: 20px;
  text-align: right;
}
.myOrder-list-bottom {
  text-align: right;
  line-height: 32px;
  padding: 7px 0;
}
.myOrder-list-bottom .btn {
  padding: 3px 8px;
}
.myOrder-list-count {
  margin-right: 15px;
}
.myOrder-franchisee-name {
  padding: 5px 0;
  color: #aaa;
}
.myOrder-transfer .myOrder-list-bottom > div:first-child {
  display: none;
}
.myOrder-transfer .myOrder-goods-cover {
  border-radius: 50%;
  background-color: #09ba07;
  line-height: 54px;
  font-size: 34px;
  text-align: center;
  color: #fff;
}
.myOrder-transfer .myOrder-goods-title {
  padding-top: 13px;
  height: 37px;
  font-size: 14px;
}
.myOrder-transfer .myOrder-goods-right {
  top: 24px;
}
#myOrder .btn.btn-orange {
  color: #ff7100;
  border-color: #ff7100;
  background: #fff;
}
#myOrder .myOrder-ebusiness .goodsCountHide,#myOrder .myOrder-goodsOrder{
  display: none;
}
#myOrder .goodsStatusOrange,#myOrder .myOrder-pay-price{
  color: #ff7100;
}
#myOrder .dialog-block-item{
  border: none;
}
#myOrder .myOrder-goods-list li{
  background: #f9f9f9;
}
</style>
<div class="myOrder-wrap page" id="myOrder" style="height: 495px;">
  <div class="myOrder-single-wrap">
    <ul class="flex-box myOrder-tab-list">
<!--       <li class="flex-sub-box-5 active" data-href="myOrder-all" data-page="1" data-goods-type>全部</li><li class="flex-sub-box-5" data-href="myOrder-toPay" data-page="1" data-type="0" data-goods-type>待付款</li><li class="flex-sub-box-5" data-href="myOrder-sending" data-page="1" data-type="1" data-goods-type>待发货</li><li class="flex-sub-box-5" data-href="myOrder-receiving" data-page="1" data-type="2" data-goods-type>待收货</li><li class="flex-sub-box-5" data-href="myOrder-comment" data-page="1" data-type="3" data-goods-type>待评价</li> -->
    </ul>
    <div>
      <div class="myOrder-all myOrder-content-container"></div>
      <div class="myOrder-toPay myOrder-content-container"></div>
      <div class="myOrder-sending myOrder-content-container"></div>
      <div class="myOrder-receiving myOrder-content-container"></div>
      <div class="myOrder-comment myOrder-content-container"></div>
      <div class="myOrder-complete myOrder-content-container"></div>
      <div class="myOrder-closed myOrder-content-container"></div>
    </div>
  </div>
  <div class="myOrder-multiple-wrap">
    <ul class="flex-box myOrder-tab-list">
<!--       <li class="flex-sub-box-5" data-href="myOrder-ebusiness" data-page="1" data-type="0" data-goods-type="0">电商</li><li class="flex-sub-box-5" data-href="myOrder-appointment" data-page="1" data-type="0" data-goods-type="1">预约</li><li class="flex-sub-box-5" data-href="myOrder-takeout" data-page="1" data-type="0" data-goods-type="2">外卖</li> -->
    </ul>
    <div>
      <div class="myOrder-ebusiness myOrder-content-container"></div>
      <div class="myOrder-appointment myOrder-content-container"></div>
      <div class="myOrder-takeout myOrder-content-container"></div>
      <div class="myOrder-tostore myOrder-content-container"></div>
      <div class="myOrder-transfer myOrder-content-container"></div>
    </div>
  </div>
</div>
<script id="myOrder-template" type="text/template">
<div class="myOrder-list-wrap" data-id=${order_id} data-status=${status} data-franchisee=${app_id}>
  <div class="dialog-block-item"><span>${add_time}</span><span class="pull-right goodsStatusOrange">${orderStatus}</span></div>
  ${franchisee_name}
  <ul class="myOrder-goods-list">${goods_info}</ul>
  <div class="myOrder-list-bottom">
    <div><span class="myOrder-list-count goodsCountHide">共&nbsp;${goods_num}&nbsp;件</span><span>合计：<span class="myOrder-pay-price">￥${orderPrice}</span></span></div>
    ${btnStatus}
  </div>
</div>
</script>
<script>
(function(){
var appId = GetQueryString('_app_id');
$('#myOrder').height(window.innerHeight);
$('#myOrder').on('scroll' , function(event) {
  var _this = $(this),
      wheight = _this.height(),
      scrolltop = _this.scrollTop(),
      _c = _this.children(':visible'),
      cheight = _c.height(),
      _li = _c.children('.myOrder-tab-list').children('.active');

  if(cheight - scrolltop - wheight < 150){
    APP.getOrderList(_li);
  }

}).on('click', '.myOrder-tab-list > li', function(){
  var li = $(this),
      container = $('#myOrder .myOrder-content-container').css('display', 'none').filter('.'+li.attr('data-href')).css('display', 'block'),
      orderListLength = container.find('.myOrder-list-wrap').length;

  li.addClass('active').siblings('.active').removeClass('active');
  if(!orderListLength) {
    APP.getOrderList(li);
  }

}).on('click', '.myOrder-goods-list', function(){
  // 订单详情
  var franchisee = $(this).closest('.myOrder-list-wrap').attr('data-franchisee');
  var router = '';
  debugger;
  if($(this).closest('.myOrder-content-container').hasClass('myOrder-transfer')){
    router = 'transferDetail';
  } else if($(this).closest('#myOrder').find('.myOrder-tab-list:visible li.active').attr('data-goods-type') == 3 || $(this).closest('.myOrder-content-container').hasClass('myOrder-tostore')) {
    router = 'tostoreOrderDetail';
  } else if(($(this).closest('#myOrder').find('.myOrder-tab-list:visible li.active').attr('data-goods-type') == 0 || $(this).closest('.myOrder-content-container').hasClass('myOrder-ebusiness'))){
    router = 'goodsOrderDetail';
  } else {
    router = 'orderDetail';
  }
  APP.turnToPage({
    router: router,
    detail: $(this).closest('.myOrder-list-wrap').attr('data-id'),
    franchisee: franchisee == GetQueryString('_app_id') ? '' : franchisee
  });

}).on('click', '.myOrder-check-logistics', function(){
  var franchisee = $(this).closest('.myOrder-list-wrap').attr('data-franchisee');
  APP.turnToPage({
    router: 'logisticsPage',
    detail: $(this).closest('.myOrder-list-wrap').attr('data-id'),
    franchisee: franchisee == GetQueryString('_app_id') ? '' : franchisee
  });

}).on('click', '.myOrder-make-comment', function(){
  var franchisee = $(this).closest('.myOrder-list-wrap').attr('data-franchisee');
  APP.turnToPage({
    router: 'makeComment',
    detail: $(this).closest('.myOrder-list-wrap').attr('data-id'),
    franchisee: franchisee == GetQueryString('_app_id') ? '' : franchisee
  });

}).on('click', '.myOrder-pay-directly', function(){
  // 立即支付
  var li = $(this).closest('.myOrder-list-wrap');
  var franchisee = $(this).closest('.myOrder-list-wrap').attr('data-franchisee');
  // $('#orderPayDialog').attr('order-id', li.attr('data-id')).find('.orderPay-pay-price').text(li.find('.myOrder-pay-price').text().substr(1));
  // APP.showOrderPayDialog();
  APP.turnToPage({
    router: $(this).attr('data-goods-type') == 5 ? 'transferDetail' : (($(this).closest('#myOrder').find('.myOrder-tab-list:visible li.active').attr('data-goods-type') == 3 || $(this).closest('.myOrder-content-container').hasClass('myOrder-tostore'))? 'tostoreOrderDetail':(($(this).closest('#myOrder').find('.myOrder-tab-list:visible li.active').attr('data-goods-type') == 0 || $(this).closest('.myOrder-content-container').hasClass('myOrder-ebusiness')) ? 'goodsOrderDetail':'orderDetail')),
    detail: li.attr('data-id'),
    franchisee: franchisee == GetQueryString('_app_id') ? '' : franchisee
  });

}).on('click', '.myOrder-sure-receipt, .myOrder-cancel-order, .myOrder-apply-drawback, .myOrder-delete', function(){
// 确认收货、取消订单、申请退款
  var listWrap = $(this).closest('.myOrder-list-wrap'),
      id = listWrap.attr('data-id'),
      franchisee = $(this).closest('.myOrder-list-wrap').attr('data-franchisee'),
      text, url;

  if($(this).hasClass('myOrder-sure-receipt')){
    text = '确认已收到货物？';
    url = 'AppShop/comfirmOrder';
  } else if($(this).hasClass('myOrder-cancel-order')){
    text = '确认取消订单？';
    url = 'AppShop/cancelOrder';
  } else if($(this).hasClass('myOrder-apply-drawback')){
    text = '确认要申请退款？';
    url = 'AppShop/applyRefund';
  } else if($(this).hasClass('myOrder-delete')){
    text = '订单删除后不可找回，确认删除？';
    url = 'AppShop/HideOrder';
  }

  confirmTip({content:text}, function(){
    updateOrder(id, url, franchisee);
  });

}).on('click', '.myOrder-verification-code', function(){
  var franchisee = $(this).closest('.myOrder-list-wrap').attr('data-franchisee');
  APP.turnToPage({
      router: 'verificationCodePage',
      detail: $(this).parents('.myOrder-list-wrap').attr('data-id'),
      sub_shop_app_id: franchisee == GetQueryString('_app_id') ? '' : franchisee
  });
});


// 更新订单状态
function updateOrder(orderId, url, franchisee){
  if(!url) {
    alertTip('controller/action undefined');
    return;
  }
  if(!orderId) {
    alertTip('order id undefined');
    return;
  }

  $.ajax({
    url: '/index.php?r='+url,
    type: 'get',
    data: {
      app_id:appId,
      order_id: orderId,
      sub_shop_app_id: franchisee == GetQueryString('_app_id') ? '' : franchisee
    },
    dataType: 'json',
    success: function(data){
      if(data.status !== 0) {
        if(data.status === 2) {
          alertTip('请先登录账号', function(){
            APP.showLogin();
          }, 700);
        } else {
          alertTip(data.data);
        }
        return;
      }
      APP.turnToPage({router:'myOrder' , redirect : true}, 'refresh');
    }
  });
}

})();

</script>

    <style rel="stylesheet">
.orderDetail-wrap {
    background-color: #eee;
}

#orderDetail .page-top-nav {
    position: static;
    margin: 0;
}

.orderDetail-wrap .orderDetail-section {
    background-color: #fff;
    padding: 12px 15px;
    margin-bottom: 6px;
}

.orderDetail-wrap .orderDetail-section:last-child {
    margin-bottom: 0;
}

.orderDetail-wrap .right-arrow-bar {
    line-height: 18px;
}

.orderDetail-pay-count {
    color: #d20e10;
}

.orderDetail-btn-status > span {
    display: inline-block;
    margin-top: 10px;
    margin-left: 10px;
}

.orderDetail-payment {
    margin: 5px 15px 0;
}

.orderDetail-payment > img {
    width: 80px;
}

.orderDetail-wrap .check-box {
    margin-top: 3px;
}

.orderDetail-wrap .list-goods-cover {
    position: absolute;
    left: 0;
    width: 60px;
    height: 60px;
}

.orderDetail-wrap .list-goods-title {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}
.orderDetail-wrap .list-goods-content .list-goods-model {
    color: #aaa;
}

.payPage-wrap {
    background-color: #eee;
}


/*-----------------------陈飞 2016-11-02---------------------*/

.orderDetail-wrap .pay-way {
    background-color: white;
    margin: 10px 0px;
}

.orderDetail-wrap .check-box.checked {
    background-color: #C40B1D;
}

.orderDetail-wrap .list-goods-content {
    position: absolute;
    left: 70px;
    top: 8px;
    text-overflow: ellipsis;
    width: 224px;
}

.orderDetail-wrap .list-goods-right {
    position: absolute;
    top: 51px;
    left: 70px;
    width: 224px;
}

.orderDetail-wrap .list-goods-right p:first-child {
    float: left;
}

.orderDetail-wrap .list-goods-right .quantity {
    float: right;
}

.orderDetail-order-list .dialog-block-item {
    height: 71px;
}

.orderDetail-order-list .quantity .plus:after,
.orderDetail-order-list .quantity .minus:before,
.orderDetail-order-list .quantity .plus:before,
.orderDetail-order-list .quantity .minus.disabled:before,
.orderDetail-order-list .quantity .plus.disabled:after,
.orderDetail-order-list .quantity .plus.disabled:before {
    background-color: #C7091B;
}


.leavemsg-wrap div {
    margin: 0 auto;
    position: relative;
    margin-top: 10px;
    margin-bottom: 10px;
}

.leavemsg-wrap input[type="text"] {
    max-width: 100%;
    height: 40px;
    border: 1px solid #DDD;
    text-indent: 10px;
    width: 100%;
}

.leavemsg-wrap .leavePicForSeller {
    height: 100px;
}

.btn_addPic {
    display: block;
    position: relative;
    width: 80px;
    height: 80px;
    overflow: hidden;
    border: 1px solid #EBEBEB;
    background: none repeat scroll 0 0 #F3F3F3;
    color: #999999;
    cursor: pointer;
    text-align: center;
    text-decoration: none;
    float: left;
    /* top: 50%;
    -webkit-transform: translateY(-50%);
    -moz-transform: translateY(-50%);
    -ms-transform: translateY(-50%);
    transform: translateY(-50%);*/
    top: 16px;
}

.filePrew {
    display: block;
    position: absolute;
    top: 0;
    left: 0;
    width: 140px;
    height: 39px;
    font-size: 100px;
    /* 增大不同浏览器的可点击区域 */
    opacity: 0;
    /* 实现的关键点 */
    filter: alpha(opacity=0);
    /* 兼容IE */
}

.btn_addPic img {
    position: absolute;
    width: 50px;
    height: 50px;
    left: 50%;
    top: 50%;
    -webkit-transform: translate(-50%, -50%);
    -moz-transform: translate(-50%, -50%);
    -ms-transform: translate(-50%, -50%);
    transform: translate(-50%, -50%);
}

.imgList {
    float: right;
    height: 100px;
    width: 200px;
    overflow: auto;
    top: 5px;
}

.imgList a {
    display: block;
    float: left;
    height: 90px;
    width: 90px;
    background: #EEE;
    margin-left: 10px;
    margin-top: 5px;
    position: relative;
}

.imgList a img {
    width: 70px;
    height: 70px;
    padding: 10px;
}

.imgList a span{
    position: absolute;
    right: -5px;
    display: block;
    top: -1px;
    border-radius: 50%;
    height: 20px;
    width: 20px;
    text-align: center;
    line-height: 20px;
    color: #fff;
    font-size: 23px;
    background-color: #d9534f;
    cursor: pointer;
    display: none;
}

.broadcast-img-dele {
    display: none;
    position: absolute;
    top: 0;
    right: 0;
    width: 24px;
    height: 24px;
    border-radius: 50%;
    color: #fff;
    font-size: 23px;
    line-height: 24px;
    background-color: #d9534f;
}
.appointmentInfo {
    display:none;
}
#discountDialog .discount-list{
    max-height: 300px;
    overflow: auto;
}
#discountDialog .discount-list ul li {
    list-style: none;
    text-align: center;
    font-size: 15px;
    padding-top: 10px;
    padding-bottom: 10px;
    border-bottom: 1px solid #EEE;
}
#orderDetail .select-discount .icon-rightarrow{
    float: right;
    height: 24px;
    line-height: 24px;
}
#orderDetail .imitate-wx-switch {
    display: inline-block;
    width: 38px;
    height: 20px;
    vertical-align: middle;
    margin-left: 8px;
}
#orderDetail .imitate-wx-switch input {
    display: none;
}
#orderDetail .imitate-wx-switch label {
    display: block;
    position: relative;
    vertical-align: top;
    -webkit-user-select: none;
    height: 20px;
    border: 13px;
}
#orderDetail .imitate-wx-switch label:before {
    content: '';
    display: block;
    border-radius: 13px;
    height: 19px;
    border: 1px solid #dfdfdf;
    background-color: white;
    -webkit-transform: scale(1, 1);
    -webkit-transition: all 0.3s ease;
}
#orderDetail .imitate-wx-switch label:after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    margin-top: -10px;
    margin-left: -10px;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    background-color: white;
    box-shadow: 0 1px 3px rgba(0,0,0,0.4);
    -webkit-transform: translateX(-9px);
    -webkit-transition: all 0.3s ease;
}
#orderDetail .imitate-wx-switch input:checked+label:after{
    transform: translateX(10px);
}
#orderDetail .imitate-wx-switch input:checked+label:before{
    background-color: #ffb200;
    border-color: #ffb200;
}
#orderDetail .orderDetail-balance {
    display: inline-block;
}
#orderDetail .dialog-block-item .balance-area {
    margin: 5px 0;
}
#orderDetail .freight-loation label{
    margin-right: 10px;
}
#orderDetail .radio-box {
    display: inline-block;
    width: 20px;
    height: 20px;
    padding: 4px 3px;
    margin-right: 6px;
    box-sizing: border-box;
    border-radius: 50%;
    line-height: 13px;
    background-color: #c7c4c4;
}
#orderDetail .radio-box img {
    width: 100%;
}
#orderDetail .radio-box.checked {
    background-color: #C40B1D;
}
#orderDetail .freight-since{
    display: none;
}
#orderDetail .icon-location,#orderDetail .icon-phone {
    display: inline-block;
}
#orderDetail .freight-loation-phone {
    margin: 10px 0;
    display: inline-block;
}
#orderDetail .freight-loation-name {
    text-decoration: underline;
    white-space: nowrap;
    text-overflow: ellipsis;
    display: inline-block;
    width: 90%;
    overflow: hidden;
}
#orderDetail .btn.btn-orange {
   color: #ff7710;
   border-color: #ff7710;
   background-color: #fff;
}
</style>
<div class="orderDetail-wrap page" id="orderDetail">
    <div class="orderDetail-section" style="color:#fff;background-color:#535961;">
        <div style="margin-bottom:4px;">订单状态：<span class="orderDetail-status"></span></div>
        <div>订单号：<span class="orderDetail-order-id"></span></div>
    </div>
    <!-- 运费 -->
    <div class="orderDetail-section freight-loation">
            <span class="orderDetail-radio-box radio-box checked" locaionradio="1"><img src="app_data/checked.png"></span>快递
            <span class="orderDetail-radio-box radio-box" locaionradio="2" style="margin-left: 30px;"><img src="app_data/checked.png"></span>上门自提
    </div>

    <div class="orderDetail-section orderDetail-address-detail right-arrow-bar icon-rightarrow" style="color: #444;">

    </div>
    <div class="orderDetail-section freight-since">
        <div>
            <p class="icon-location"></p>
            <span class="freight-loation-name"></span>
        </div>
        <div>
            <p class="ico-moon icon-phone"></p>
            <a class="freight-loation-phone" href=""></a>
        </div>
        <div>
            亲，勾选上门自提，需要自己去门店取货哦!
        </div>
    </div>
    <div class="dialog-block-item pay-way">
        <div class="orderDetail-payment"><img src="app_data/weixin.jpg"><span class="pull-right orderDetail-check-box check-box checked" payment="0"><img src="app_data/checked.png"></span></div>
        <div class="orderDetail-payment" payment="zfb"><img src="app_data/zhifubao.jpg"><span class="pull-right orderDetail-check-box check-box" payment="1"><img src="app_data/checked.png"></span></div>
    </div>
    <div class="orderDetail-section">
        <ul class="orderDetail-order-list">

        </ul>
        <div class="dialog-block-item tostoreBenefit">
            <div class="select-discount">店铺优惠<span class="icon-rightarrow"></span><span class="pull-right discount-type">暂无优惠</span></div>
            <div>优惠抵扣<span class="pull-right">￥<span class="orderDetail-benefit-deduction"></span></span></div>
        </div>
        <div class="dialog-block-item">
            <div class="appointmentInfo">预约时间<span class="pull-right orderDetail-appo-time"></span></div>
            <div>备注<span class="pull-right tostoreRemark"></span></div>
            <div>商品金额<span class="pull-right">￥<span class="orderDetail-total-price"></span></span></div>
            <div>运费<span class="pull-right">￥<span class="orderDetail-express-fee"></span></span></div>
            <div class="balance-area">余额
                <div class="imitate-wx-switch pull-right">
                    <input id="isUseBalancePay" checked="checked" type="checkbox">
                    <label for="isUseBalancePay"></label>
                </div>
                <span class="pull-right">￥<span class="orderDetail-balance"></span></span>
            </div>
            <div class="balance-deduction">余额抵扣<span class="pull-right">- ￥<span class="orderDetail-balance-deduction"></span></span></div>
        </div>
        <div class="txt-r orderDetail-btn-status"></div>
    </div>
</div>
<div class="payPage-wrap page txt-c" id="payPage">
    <div style="margin-top:30%; margin-bottom:30px;">
        <img class="orderDetail-pay-qrcode" style="width:150px;">
    </div>
    <div style="font-size:16px;">长按二维码扫描支付</div>
</div>
<div id="discountDialog" class="page-dialog-wrap" style="display: none;">
    <div class="page-bottom-dialog">
        <div class="page-bottom-content">
            <div class="sure-local-area">
                <span>取消</span>
                <span>确定</span>
            </div>
            <div class="discount-list">
                <ul>
                </ul>
            </div>
        </div>
    </div>
</div>
<script>
(function() {
    //优惠选择事件绑定
    $("#discountDialog .discount-list ul li").click(function(){
        $(this).addClass("clickliStyle").siblings("li").removeClass("clickliStyle");
    });
    $("#orderDetail .select-discount").click(function(){
        $("#discountDialog").show().find(".page-bottom-dialog").slideDown(400);
    });
    $("#discountDialog").on("click", ".sure-local-area span:first-child", function() {
        $("#discountDialog .page-bottom-dialog").slideUp(400, function() {
            $("#discountDialog").hide();
            $(".clickliStyle").removeClass("clickliStyle");
        });
    }).on("click", ".sure-local-area span:last-child", function() {

        var tempStr = $(".clickliStyle").html(),
            id = $(".clickliStyle").data("value"),
            type = $(".clickliStyle").data("type");

        changeOrder(type,id);

        $(".discount-type").html("").html(tempStr);

        $("#discountDialog .page-bottom-dialog").slideUp(400, function() {
            $("#discountDialog").hide();
            $(".clickliStyle").removeClass("clickliStyle");
        });
    });
    $("#orderDetail #isUseBalancePay").click(function(){
        isUseBalance(Number($(this).is(':checked')));
    });

    var appId = GetQueryString('_app_id');

    function getTotalMoney(){
        var totalMoney=0;
        $.each($(".list-goods-right p:first-child"),function(index,ele){
            totalMoney+=Number($(ele).attr('data-price'));
        });
        return totalMoney;
    }
    $('#orderDetail').on("keyup",".pay-buy-count",function(){
        var $input=Number($(this).val());
        var $price=Number($(this).attr("data-price"));
        var stock=Number($(".response-area-plus").attr("data-stock"));
        if(typeof $input=="number" && !isNaN($input)){
            if($input>stock){
                $(this).val(stock);
                $input=stock;
                $(".response-area-plus").siblings('.plus').addClass('disabled');
            }else if($input<1){
                $(this).val(1);
                $input=1;
                $('.response-area-minus').siblings('.minus').addClass('disabled');
            }
            var totalPrice = $input*$price;
            $(this).closest(".list-goods-right").find("p:first-child").text("￥" + totalPrice);
            $(".orderDetail-total-price").text(getTotalMoney().toFixed(2));
            $(".orderDetail-cancel-order").text("应付金额:￥" + getTotalMoney().toFixed(2));
        }else{
            alertTip("请输入正确的数量!");
            $(this).val(1);
            totalPrice=1*$price;
            $(this).closest(".list-goods-right").find("p:first-child").text("￥" + totalPrice);
            $(".orderDetail-total-price").text(getTotalMoney().toFixed(2));
            $(".orderDetail-cancel-order").text("应付金额:￥" + getTotalMoney().toFixed(2));
        }
    }).on("click", ".response-area-plus", function() {
        var $input = $(this).siblings('input'),
            num = Number($input.val()),
            $minusBtn = $(this).siblings('.minus'),
            $plusBtn = $(this).siblings('.plus'),
            stock = Number($(this).attr("data-stock"));
        if ($plusBtn.hasClass('disabled') && num>=stock) {
            $input.val(stock);
            return;
        }
        $minusBtn.removeClass('disabled');
        $input.val(num + 1);
        if (num + 1 == stock) {
            $plusBtn.addClass('disabled');
        }
        var totalPrice = Number($input.val()) * Number($(this).attr("data-price"));
        $(this).closest(".list-goods-right").find("p:first-child").attr('data-price', totalPrice);
        $(".orderDetail-total-price").text(getTotalMoney().toFixed(2));
        $(".orderDetail-cancel-order").text("应付金额:￥" + getTotalMoney().toFixed(2));
    }).on('click', '.response-area-minus', function() {
        var $input = $(this).siblings('input'),
            num = Number($input.val()) || 1,
            $minusBtn = $(this).siblings('.minus'),
            $plusBtn = $(this).siblings('.plus');

        if ($minusBtn.hasClass('disabled') && num ==1) {
            return;
        }
        $plusBtn.removeClass('disabled');
        if (num - 1 < 1) {
            $input.val(1);
            $minusBtn.addClass('disabled');
        }else{
             $input.val(num - 1);
        }
        var totalPrice = Number($input.val()) * Number($(this).attr("data-price"));
        $(this).closest(".list-goods-right").find("p:first-child").attr('data-price', totalPrice);
        $(".orderDetail-total-price").text(getTotalMoney().toFixed(2));
        $(".orderDetail-cancel-order").text("应付金额:￥" + getTotalMoney().toFixed(2));
    }).on('click', '.orderDetail-address-detail', function() {
        APP.turnToPage({
          router: 'addressDialog',
          from: 'orderDetail'
        })
        // APP.showAddressDialog();

    }).on('click', '.orderDetail-check-box', function() {
        $('.orderDetail-check-box.checked').removeClass('checked');
        $(this).addClass('checked');

    }).on('click', '.orderDetail-radio-box', function() {
        // 运费单选框
        $('.orderDetail-radio-box.checked').removeClass('checked');
        $(this).addClass('checked');
        if($(this).attr('locaionRadio') == 2){
            freightWay(1);
            $('#orderDetail .freight-since').show();
            $('#orderDetail .orderDetail-address-detail').hide();
        }else{
            freightWay(0)
            $('#orderDetail .freight-since').hide();
            $('#orderDetail .orderDetail-address-detail').show();
        }

    }).on('click', '.orderDetail-pay-directly', function() {
        // 支付
        var id = $('.orderDetail-order-id').text().trim(),
            payment = $('.orderDetail-payment').find('.orderDetail-check-box.checked').attr('payment');

        if (!id) {
            alertTip('order id undefined');
            return;
        }
        if (!($('.orderDetail-name').length || $(this).attr('data-goods-type') == 3 || $('.orderDetail-radio-box.checked').attr('locaionradio') == 2)) {
            alertTip('请填写地址信息');
            return;
        }
        var additional_info={};
        $("#orderDetail .leavemsg-wrap").each(function(index,element){
            var tempgoodsId=$(element).attr("data-goodsId");
            additional_info[tempgoodsId]=[];
            $(element).find("div").not(".imgList").each(function(index,ele){
                var obj={};
                obj.title=$(ele).attr("data-value");
                if($(ele).hasClass("leavePicForSeller")){
                    var temp=[];
                    $(ele).find(".imgList img").each(function(index,e){
                        temp.push($(e).attr("src"));
                    });
                    obj.value=temp;
                    obj.type="picture";
                }else{
                    obj.value=$(ele).find("input").val();
                    obj.type="text";
                }
                additional_info[tempgoodsId].push(obj);
            });
        });
        if(!$.isEmptyObject(additional_info)){
          saveLeaveMessage(id,additional_info);
        }
        console.log("添加用户留言信息");
        //执行一个请求函数保存用户给卖家的留言
        function saveLeaveMessage(order_id,info){
          $.ajax({
              url:"/index.php?r=AppShop/SetAdditional",
              type:"POST",
              data:{
                  order_id:order_id,
                  additional_info:info
              },
              dataType:"JSON",
              success:function(data){
                  console.log(data);
              },
              error:function(data){
                  alertTip(data.data)
              }
          });
        }
        if ($('.orderDetail-cancel-order .num').text().trim() == 0) {
            $.ajax({
                url: '/index.php?r=AppShop/paygoods',
                type: 'get',
                dataType: 'json',
                data: {
                    app_id: appId,
                    order_id: id,
                    total_price: 0
                },
                success: function(res){
                    if(res.status!=0){
                        alertTip(res.data);
                        return;
                    }
                    alertTip('支付成功', function(){
                        APP.turnToPage({
                            router: 'orderDetail',
                            detail: $('.orderDetail-order-id').text().trim(),
                            franchisee: GetQueryString('franchisee'),
                            redirect: true
                        }, 'refresh');
                    });
                }
            });
            return;
        }
        if (payment == 1) {
            // 支付宝支付
            window.open('/index.php?r=AppShop/getUniPay&order_id=' + id + '&payment_id=1');
        } else {
              APP.turnToPage({
                  router: 'payPage'
              });
        }
    }).on('click', '.orderDetail-make-comment', function() {
        APP.turnToPage({
            router: 'makeComment',
            detail: $('.orderDetail-order-id').text().trim(),
            franchisee: GetQueryString('franchisee')
        });

    }).on('click', '.orderDetail-check-logistics', function() {
        APP.turnToPage({
            router: 'logisticsPage',
            detail: $('.orderDetail-order-id').text().trim(),
            franchisee: GetQueryString('franchisee')
        });

    }).on('click', '.orderDetail-sure-receipt,.orderDetail-apply-drawback, .orderDetail-receive-drawback', function() {
        // 确认收货、取消订单、申请退款
        var id = $('.orderDetail-order-id').text().trim(),
            text, url;

        if ($(this).hasClass('orderDetail-sure-receipt')) {
            text = '确认已收到货物？';
            url = 'AppShop/comfirmOrder';
        } else if ($(this).hasClass('orderDetail-cancel-order')) {
            text = '确认取消订单？';
            url = 'AppShop/cancelOrder';
        } else if ($(this).hasClass('orderDetail-apply-drawback')) {
            text = '确认要申请退款？';
            url = 'AppShop/applyRefund';
        } else if ($(this).hasClass('orderDetail-receive-drawback')) {
            text = '确认已收到退款？';
            url = 'AppShop/comfirmRefund';
        }

        confirmTip({
            content: text
        }, function() {
            updateOrder(id, url);
        });

    }).on('click', '.orderDetail-verification-code', function(){
        APP.turnToPage({
            router: 'verificationCodePage',
            detail: $('.orderDetail-order-id').text().trim(),
            sub_shop_app_id: GetQueryString('franchisee')
        });
    });
    // 更新订单状态
    function updateOrder(orderId, url) {
        if (!url) {
            alertTip('controller/action undefined');
            return;
        }
        if (!orderId) {
            alertTip('order id undefined');
            return;
        }

        $.ajax({
            url: '/index.php?r=' + url,
            type: 'get',
            data: {
                app_id:appId,
                order_id: orderId,
                sub_shop_app_id: GetQueryString('franchisee')
            },
            dataType: 'json',
            success: function(data) {
                if (data.status !== 0) {
                    alertTip(data.data);
                    return;
                }
                APP.turnToPage({
                    router: 'orderDetail',
                    detail: GetQueryString('detail'),
                    franchisee: GetQueryString('franchisee')
                }, 'refresh');
            }
        });
    }

    //更改订单优惠方式
    function changeOrder(type,id){
        $.ajax({
            url: '/index.php?r=AppShop/ChangeOrder',
            type: 'POST',
            data: {
                app_id:appId,
                order_id:GetQueryString('detail') ,
                discount_type: type,
                coupon_id: id,
                sub_shop_app_id: GetQueryString('franchisee')
            },
            dataType: 'json',
            success: function(data) {
                if (data.status !== 0) {
                    alertTip(data.data);
                    return;
                }
                APP.turnToPage({
                    router: 'orderDetail',
                    detail: data.data[0].form_data.order_id,
                    franchisee: GetQueryString('franchisee'),
                    redirect: true
                }, 'refresh');
            }
        });
    }

    // 更改是否使用余额
    function isUseBalance(isBalance){
        $.ajax({
            url: '/index.php?r=AppShop/ChangeOrder',
            type: 'POST',
            data: {
                app_id:appId,
                order_id:GetQueryString('detail'),
                sub_shop_app_id: GetQueryString('franchisee'),
                is_balance: isBalance
            },
            dataType: 'json',
            success: function(data) {
                if (data.status !== 0) {
                    alertTip(data.data);
                    return;
                }
                APP.turnToPage({
                    router: 'orderDetail',
                    detail: data.data[0].form_data.order_id,
                    franchisee: GetQueryString('franchisee'),
                    redirect: true
                }, 'refresh');
            }
        });
    }

    // 更改运费方式
    function freightWay(delivery){
        // var totalPrice = $('#orderDetail').find('.orderDetail-cancel-order .num').text(),
        //     express = $('#orderDetail').find('.orderDetail-express-fee').attr('express_fee');
        $.ajax({
            url: '/index.php?r=AppShop/setAddress',
            type: 'get',
            data: {
                is_self_delivery:delivery,
                order_id: $('.orderDetail-order-id').text(),
                address_id: $('#orderDetail .orderDetail-name').closest('div').attr('data-freight'),
                sub_shop_app_id: GetQueryString('franchisee')
            },
            dataType: 'json',
            success: function(data) {
                if (data.status !== 0) {
                    if (data.status === 2) {
                        alertTip('请先登录账号', function() {
                            APP.showLogin();
                        }, 700);
                    } else {
                        alertTip(data.data);
                    }
                    return;
                }
                APP.freightWayChangeOrder();
            },
            error:function(data){
                alertTip("网络状况可能不太好喔");
            }
        });
    }
})();
</script>

    <style rel="stylesheet">
.myAddress-show-wrap {
  background-color: #eee;
}
.myAddress-top-nav {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  height: 42px;
  line-height: 42px;
  padding: 0 10px;
  text-align: center;
  box-shadow: 0 1px 2px #eee;
  background-color: #fff;
}
.myAddress-top-right {
  position: absolute;
  top: 0;
  right: 10px;
  width: 40px;
}
.myAddress-bottom-nav {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  height: 48px;
  line-height: 48px;
  font-size: 16px;
  text-align: center;
  color: #666;
  background-color: #fff;
  box-shadow: 0 -1px 2px #eee;
}
.myAddress-content-container {
  overflow-y: auto;
  overflow-x: hidden;
}
.myAddress-show-wrap .myAddress-content-container {
  margin-bottom: 50px;
}
.myAddress-edit-wrap .myAddress-content-container {
  margin-top: 49px;
}
.myAddress-defalut-address, .myAdress-other-address {
  margin-bottom: 15px;
  padding: 0 10px;
  background-color: #fff;
}
.myAddress-address-list li {
  border-bottom: 1px solid #eee;
  -webkit-transition: transform .5s linear;
          transition: transform .5s linear;
}
.myAddress-address-list li.moveLeft {
  -webkit-transform: translateX(-51px);
          transform: translateX(-51px);
}
.myAddress-address {
  display: inline-block;
  padding-top: 10px;
  line-height: 20px;
}
.myAddress-address dl {
  position: relative;
}
.myAddress-address dl,
.myAddress-address dd {
  margin: 0
}
.myAddress-address dt {
  position: absolute;
  width: 70px;
}
.myAddress-address dd {
  padding-left: 75px;
}
.myAddress-make-default, .myAddress-delete {
  display: inline-block;
  padding: 10px 10px 10px 0;
  color: #938CF9;
}
.myAddress-delete {
  padding-left: 10px;
  color: #F57979;
  float: right;
}
.myAddress-edit-wrap {
  display: none;
}
.myAddress-edit-wrap .dialog-block-item {
  padding: 0;
}
.myAddress-edit-input {
  width: 100%;
  box-sizing: border-box;
  height: 36px;
  padding: 4px 10px;
  border-radius: 4px;
  border: none;
}
.myAddress-edit-wrap textarea {
  height: 145px;
  padding-top: 10px;
  resize: none;
}
.myAddress-edit-wrap select {
  width: 30%;
  min-width: 95px;
  margin-right: 3px;
}
</style>
<div class="myAddress-wrap page" id="myAddress">
  <div class="myAddress-show-wrap">
    <div class="myAddress-content-container">
      <div class="myAddress-defalut-address">
        <div class="dialog-block-item"><b>默认地址</b> <!-- <span class="myAddress-delete">删除</span> --></div>
        <ul class="myAddress-address">
          <li style="color:#a8a8a8;">暂无默认地址</li>
          <!-- <dl>
            <dt>收件人：</dt><dd>哈哈哈</dd>
            <dt>联系电话：</dt><dd>18654584480</dd>
            <dt>联系地址：</dt><dd>深圳市南山区后海大道2378号</dd>
          </dl> -->
        </ul>
      </div>
      <div class="myAdress-other-address">
        <div class="dialog-block-item"><b>其他地址</b></div>
        <ul class="myAddress-address-list">
          <li style="color:#a8a8a8;">暂无其他地址</li>
          <!-- <li>
            <div class="myAddress-address"><dl>
              <dt>收件人：</dt><dd>哈哈哈</dd>
              <dt>联系电话：</dt><dd>18654584480</dd>
              <dt>联系地址：</dt><dd>深圳市南山区后海大道2378号</dd>
            </dl></div>
            <div><span class="myAddress-make-default">设为默认</span><span class="myAddress-delete">删除</span></div>
          </li>
          <li>
            <div class="myAddress-address"><dl>
              <dt>收件人：</dt><dd>哈哈哈</dd>
              <dt>联系电话：</dt><dd>18654584480</dd>
              <dt>联系地址：</dt><dd>深圳市南山区后海大道2378号</dd>
            </dl></div>
            <div><span class="myAddress-make-default">设为默认</span><span class="myAddress-delete">删除</span></div>
          </li>
          <li>
            <div class="myAddress-address"><dl>
              <dt>收件人：</dt><dd>哈哈哈</dd>
              <dt>联系电话：</dt><dd>18654584480</dd>
              <dt>联系地址：</dt><dd>深圳市南山区后海大道2378号</dd>
            </dl></div>
            <div><span class="myAddress-make-default">设为默认</span><span class="myAddress-delete">删除</span></div>
          </li> -->
        </ul>
      </div>
    </div>
    <div class="myAddress-bottom-nav"><span style="font-size:30px; margin-right:11px; vertical-align:top; color:#aaa;">+</span>添加新地址</div>
  </div>
  <div class="myAddress-edit-wrap">
    <div class="myAddress-top-nav"><span class="top-nav-back icon-leftarrow"></span>添加收货地址 <span class="myAddress-top-right myAddress-save-address">保存</span></div>
    <div class="myAddress-content-container">
      <div style="padding:7px;background:#fff;">
        <div class="dialog-block-item"><input class="myAddress-edit-input" placeholder="收件人姓名" data-name="name"></div>
        <div class="dialog-block-item"><input class="myAddress-edit-input" placeholder="手机号码" data-name="contact"></div>
        <div class="dialog-block-item"><!-- <span>地区</span>： --><select class="myAddress-province-select myAddress-edit-input" data-name="province"><option value="" selected="selected">选择省</option></select><select class="myAddress-city-select myAddress-edit-input" data-name="city"><option value="" selected="selected">选择市</option></select><select class="myAddress-district-select myAddress-edit-input" data-name="district"><option value="" selected="selected">选择区</option></select></div>
        <div><textarea class="myAddress-edit-input" placeholder="详细地址" data-name="detailAddress"></textarea></div>
      </div>
    </div>
  </div>
</div>
<script>
(function(){

$('#myAddress').on('click', '.myAddress-bottom-nav', function(){

  $('.myAddress-edit-input').each(function(){
    $(this).val('');
  });

  if($('.myAddress-province-select').find('option').length <= 1) {
    getArea('.myAddress-province-select', 0, function(){
      $('.myAddress-province-select').prepend('<option value="">选择省</option>');
    });
  }

  $('.myAddress-edit-wrap').css('display', 'block');
  $('.myAddress-show-wrap').css('display', 'none');

}).on('click', '.myAddress-edit-wrap .top-nav-back', function(){
  $('.myAddress-edit-wrap').css('display', 'none');
  $('.myAddress-show-wrap').css('display', 'block');

}).on('click', '.myAddress-save-address', function(){
  var val = info = '',
      para = {}, name;

  $.each($('.myAddress-edit-input'), function(index, field){
    val = $(field).val().trim();
    if(!val){
      info = '请填写'+$(field).attr('placeholder');
      return false;
    } else {
      name = $(field).attr('data-name');
      if(field.tagName.toLowerCase() === 'select'){
        para[name] = {
          text: $(field).find('option:selected').text(),
          id: val
        };
      } else {
        para[$(field).attr('data-name')] = val;
      }
    }
  });

  if(info){
    alertTip(info);
    return;
  }
  addAddress(para);

}).on('click', '.myAddress-make-default', function(){
  setDefaultAddress($(this).closest('li').attr('data-id'));

}).on('click', '.myAddress-delete', function(){
  var $li = $(this).closest('li');
  confirmTip({content:'确认删除该地址？'}, function(){
    deleteAddress($li);
  });

}).on('change', '.myAddress-province-select', function(){
  if (!$(this).val()){
    $('.myAddress-city-select').html('<option value="">选择市</option>');
    $('.myAddress-district-select').html('<option value="">选择区</option>');
    return;
  }
  getArea('.myAddress-city-select', $(this).val(), function(){
    $('.myAddress-city-select').prepend('<option value="">选择市</option>');
    $('.myAddress-district-select').html('<option value="">选择区</option>');
  });

}).on('change', '.myAddress-city-select', function(){
  if (!$(this).val()){
    $('.myAddress-district-select').html('<option value="">选择区</option>');
    return;
  }
  getArea('.myAddress-district-select', $(this).val(), function(){
    $('.myAddress-district-select').prepend('<option value="">选择区</option>');
  });

});

function getArea(container, pid, fn){
  $.ajax({
    url: '/index.php?r=Region/getRegionList',
    type: 'get',
    data: { pid: pid },
    dataType: 'json',
    success: function(data){
      if(data.status !== 0){ alertTip(data.data); return; }
      var list = data.data,
          listStr = '';
      $(list).each(function(index, item) {
          listStr += '<option value="'+item.id+'">'+item.name+'</option>';
      });
      $(container).html(listStr);
      $.isFunction(fn) && fn();
    },
    error: function(jqXHR, textStatus){
      if (textStatus === 'timeout') {
        alertTip('请求超时 请检查网络状况');
      } else {
        alertTip('城市列表请求出错');
      }
    }
  });
}

function addAddress(para){
  $.ajax({
    url: '/index.php?r=AppShop/addAddress',
    type: 'get',
    data: {
      address_info: para,
      ck_id: GetCookiePara()
    },
    dataType: 'json',
    success: function(data){
      if(data.status !== 0) {
        if(data.status === 2) {
          alertTip('请先登录账号', function(){
            APP.showLogin();
          }, 700);
        } else {
          alertTip(data.data);
        }
        return;
      }
      $('.myAddress-edit-wrap .top-nav-back').trigger('click');
      APP.refreshPage(GetQueryString('router'));
    }
  });
}

function deleteAddress(li){
  var id = li.attr('data-id');

  if(!id) {
    alertTip('地址id为空');
    return;
  }
  $.ajax({
    url: '/index.php?r=AppShop/delAddress',
    type:'get',
    data: {
      address_id: id
    },
    dataType: 'json',
    success: function(data){
      if(data.status !== 0) {
        if(data.status === 2) {
          alertTip('请先登录账号', function(){
            APP.showLogin();
          }, 700);
        } else {
          alertTip(data.data);
        }
        return;
      }
      li.remove();
    }
  });

}

function setDefaultAddress(id){
  if(!id) {
    alertTip('地址id为空');
    return;
  }

  $.ajax({
    url: '/index.php?r=AppShop/setDefaultAddress',
    type:'get',
    data: {
      addr_id: id
    },
    dataType: 'json',
    success: function(data){
      if(data.status !== 0) {
        if(data.status === 2) {
          alertTip('请先登录账号', function(){
            APP.showLogin();
          }, 700);
        } else {
          alertTip(data.data);
        }
        return;
      }
      APP.refreshPage(GetQueryString('router'));
    }
  });
}

})();

</script>

    <style>
  /*.app .page[data-router='userCenterPage'] .edit-div {
  display: none;
  position: absolute;
  left: 0;
  top: 0;
  width: 100%;
  color: #202020;
  background-color: #e2e2e2;
  font-size: 14px;
  z-index: 99;
}*/
.centerPage-wrap {
  background-color: #eee;
}
.centerPage-wrap header {
  width: 100%;
  height: 40px;
  line-height: 40px;
  background-color: #fff;
  font-size: 12px;
  text-align: center;
  border-bottom: 1px solid #d8d8d8;
}
.centerPage-wrap header span {
  position: absolute;
  padding-right: 5%;
  padding-left: 5%;
}
.centerPage-wrap .centerPage-save-btn {
  right: 0;
}
.centerPage-wrap.cur-bind-tel .save-btn {
  display: none;
}
.centerPage-wrap .cover-thumb {
  display: block;
  width: 80px;
  height: 80px;
  margin-left: auto;
  margin-right: auto;
  padding-top: 10px;
  padding-bottom: 10px;
  border-radius: 50%;
}
.centerPage-wrap .centerPage-user-info {
  padding-left: 3%;
  padding-right: 3%;
  border-top: 1px solid #d8d8d8;
  border-bottom: 1px solid #d8d8d8;
  margin-top: 15px;
  list-style: none;
  line-height: 40px;
  text-indent: 10px;
  background-color: #fff;
}
.centerPage-wrap.cur-bind-tel .centerPage-user-info {
  display: none;
}
.centerPage-wrap .centerPage-user-info li {
  position: relative;
  border-bottom: 1px solid #ededed;
}
.centerPage-wrap .centerPage-user-info li:last-child {
  border-bottom: none;
}
.centerPage-wrap .centerPage-user-info input[type="text"],
.centerPage-wrap .userCenter-tel p,
.centerPage-wrap .centerPage-sex {
  float: right;
  border: none;
  width: 65%;
  margin-top: 5px;
  line-height: 24px;
  padding: 4px 8px;
  margin-right: 25px;
  text-align: right;
  color: #888;
  font-size: 14px;
}
.centerPage-wrap .icon-rightarrow {
  position: absolute;
  right: 4px;
  top: 50%;
  margin-top: -10px;
  width: 20px;
  height: 20px;
  line-height: 20px;
  font-size: 14px;
  color: #999;
  /*background-image: url(http://cdn.jisuapp.cn/zhichi_frontend/static/webapp/images/icons_mobile.png);
  background-repeat: no-repeat;
  background-size: auto 20px;
  background-position-y: center;
  background-position-x: -186px;*/
}
.centerPage-wrap .shadow-content {
  width: 80%;
  left: 8%;
  top: 50%;
  margin-top: -150px;
  padding: 3% 2%;
  background-color: #fff;
  font-size: 14px;
}
.centerPage-wrap .shadow-content p {
  line-height: 40px;
  text-indent: 10px;
}

.centerPage-wrap .shadow-content .title {
  font-size: 18px;
  color: #41b80e;
  border-bottom: 2px solid #bcbcbc;
}
.centerPage-wrap .centerPage-sex-p:first-child {
  border-bottom: 1px solid #bcbcbc;
}
.centerPage-wrap .centerPage-sex-p span {
  display: none;
  float: right;
  color: #41b80e;
  margin-right: 10px;
}
.centerPage-wrap .selected span {
  display: block;
}

/*.centerPage-wrap .bind-tel-sec {
  display: none;
  width: 100%;
  height: 100%;
  font-size: 14px;
}
.centerPage-wrap.cur-bind-tel .bind-tel-sec {
  display: block;
  font-size: 14px;
}*/
.bindPhone-wrap {
  line-height: 40px;
  /*margin-top: 10px;*/
  padding-left: 5%;
  padding-right: 5%;
  background-color: #eee;
}
.bindPhone-wrap input {
  border: none;
  width: 60%;
  margin-top: 10px;
  line-height: 40px;
  color: #646464;
  border: 1px solid #ddd;
  font-size: 14px;
  text-indent: 5px;
}
.bindPhone-wrap .blue-btn {
  display: block;
  line-height: 40px;
  margin-top: 20px;
  color: #fff;
  background-color: #28a2ef;
  text-align: center;
}
.bindPhone-wrap .orange-btn {
  display: inline-block;
  float: right;
  line-height: 40px;
  padding-right: 10px;
  padding-left: 10px;
  margin-top: 10px;
  color: #fff;
  background-color: #ff7e02;
}
.bindPhone-wrap .get-code-btn.invalid{
  background-color: #ddd;
}
.bindPhone-wrap .bind-new-tel-wrap {
  display: none;
}
.bindPhone-wrap.sec-step .bind-new-tel-wrap {
  display: block;
}
.bindPhone-wrap.sec-step .verify-wrap {
  display: none;
}
.old-pic-url, .new-pic-url {
  float: right;
  margin-top: 10px;
  width: 90px;
  height: 40px;
}
.select-sex-dialog {
  display: none;
  position: fixed;
  left: 0;
  right: 0;
  top: 0;
  bottom: 0;
  height: auto;
  width: auto;
  z-index: 11;
}
</style>
<div class="page centerPage-wrap" id="userCenterPage" data-router="userCenterPage">
  <header>
    <span class="centerPage-save-btn">保存</span>
  </header>
  <ul class="centerPage-user-info">
    <li class="js-change-cover">
      <img class="cover-thumb" src="app_data/default_photo.png">
      <input class="img-upload-input" accept="image/jpg,image/jpeg, image/gif, image/bmp, image/jp2, image/x-ms-bmp, image/x-png" type="file">
      <span class="icon-rightarrow"></span>
    </li>
  </ul>
  <ul class="centerPage-user-info">
    <li><label>昵称</label><span class="icon-rightarrow"></span><input class="nickname" placeholder="请输入您的昵称" type="text"></li>
    <li><label>性别</label><span class="icon-rightarrow"></span><span class="centerPage-sex" data-sex="">&nbsp;</span></li>
    <!-- <li><label>QQ</label><span class="icon-rightarrow"></span><input class="js-qq" type="text" placeholder="请输入您的qq"></li> -->
    <li class="userCenter-tel router" data-router="bindPhonePage"><label>手机号</label><span class="icon-rightarrow"></span><p class="js-tel">&nbsp;</p></li></ul>
    <div class="select-sex-dialog">
      <div class="shadow-content">
        <p class="title">性别</p><p class="centerPage-sex-p" data-sex="0">男<span>√</span></p><p class="centerPage-sex-p" data-sex="1">女<span>√</span></p>
      </div>
      <div class="shadow"></div>
    </div>
</div>
<div class="page bindPhone-wrap" id="bindPhonePage" data-router="bindPhonePage">
  <!-- <section class="bind-tel-sec"> -->
    <section class="verify-wrap">
      <div><input class="old-pic-code-input" placeholder="图形验证码"><img class="old-pic-url" data-type="old"></div>
      <input class="code-input" placeholder="请输入验证码" type="text"><span class="orange-btn get-code-btn" data-type="old">获取验证码</span><p class="blue-btn next-step">下一步</p>
    </section>
    <section class="bind-new-tel-wrap">
      <div><input class="new-pic-code-input" placeholder="图形验证码"><img class="new-pic-url" data-type="new"></div>
      <input class="code-tel" placeholder="请输入手机号" type="text"><span class="orange-btn get-code-btn" data-type="new">获取验证码</span><input class="code-input" placeholder="请输入验证码" style="width:100%;" type="text"><span class="blue-btn bind-new-tel-btn">绑定手机</span>
    </section>
  <!-- </section> -->
</div>
<script type="text/javascript">
(function(){

  var userCenterPage = $('#userCenterPage'),
      bindPhonePage = $('#bindPhonePage');

userCenterPage.on('click', '.centerPage-sex', function(event) {
  event.preventDefault();
  var $sexDialog = $(this).closest('.page').find('.select-sex-dialog'),
      $sexDialogSelect = $sexDialog.find('.centerPage-sex-p');
  if($(this).attr('data-sex')=='0'){
    $sexDialogSelect.filter('[data-sex=0]').addClass('selected').siblings().removeClass('selected');
  }else{
    $sexDialogSelect.filter('[data-sex=1]').addClass('selected').siblings().removeClass('selected');;
  }
  $sexDialog.addClass('zShow');

}).on('click', '.centerPage-sex-p', function(event) {
  event.preventDefault();
  var $sexDialog = $(this).closest('.select-sex-dialog');
  if($(this).hasClass('selected')){
    $sexDialog.removeClass('zShow');
  }else{
    $(this).addClass('selected').siblings().removeClass('selected');
    var sex = $(this).attr('data-sex'),
        sexText = (sex==1 ? '女' : '男');
    userCenterPage.find('.centerPage-sex').attr('data-sex', sex).text( sexText );
    $sexDialog.removeClass('zShow');
  }

}).on('click', '.js-change-cover', function(event) {
  var $this = $(this);
  $this.imgUpload(function(url){
    $this.find('img').attr('src', url);
  });

}).on('click', '.userCenter-tel', function(event) {
  if($(this).find('.js-tel').text().trim()){
    $('#bindPhonePage').removeClass('sec-step');
    getPicCode('old');
  } else {
    $('#bindPhonePage').addClass('sec-step');
    getPicCode('new');
  }
  // event.preventDefault();
  // confirmTip({content:'您确定要绑定新的手机号？'}, function(){
  //   centerPage.addClass('cur-bind-tel');
  // });


}).on('click', '.centerPage-save-btn', function(event) {
  event.preventDefault();
  if($(this).hasClass('js-posting')){
    return;
  }
  $(this).addClass('js-posting');

  var $edit = $(this).parent().parent(),
      cover_thumb = $edit.find('.cover-thumb').attr('src'),
      nickname = $edit.find('.nickname').val(),
      qq = $edit.find('.js-qq').val(),
      sex = $edit.find('.centerPage-sex').attr('data-sex');
  if(nickname.length <= 0){
    alertTip('昵称不能为空，请填写');
    $edit.find('.nickname').focus();
    return;
  }
  saveEdit({cover_thumb: cover_thumb, nickname: nickname, qq: qq, sex: sex, app_id: GetQueryString('_app_id')}, $(this));

});


bindPhonePage.on('click', '.get-code-btn', function(event) {
  getCode($(this));

}).on('click', '.old-pic-url, .new-pic-url', function(event) {
  getPicCode($(this).attr('data-type'));

}).on('click', '.next-step', function(event) {
  verify($(this));

}).on('click', '.bind-new-tel-btn', function(event) {
  bindNewTel($(this));

});

function saveEdit(param, $btn){
  $ajax('/index.php?r=AppData/saveUserInfo', 'post', param, 'json', function(data){
    if(data.status == 0){
      alertTip('保存成功', function(){
        window.history.back();
      });
      var $show = $('.user-center .show-div');
      $show.find('.cover-thumb').attr('src', param.cover_thumb);
      $show.find('.nickname').text(param.nickname);
      $('body').attr('data-nickname', param.nickname).attr('data-cover', param.cover_thumb);
    }else{
      alertTip(data.data);
    };
    $btn.removeClass('js-posting');
  }, function(){
    alertTip('保存个人信息失败，请重试');
    $btn.removeClass('js-posting');
  });
}

function getCode($btn){
  if($btn.hasClass('invalid')){
    return;
  }
  var url = '/index.php?r=AppData/PhoneCode',
      param = {},
      type = $btn.attr('data-type'),
      pic_code = bindPhonePage.find('.old-pic-code-input').val().trim();

  if(type=='new'){
    url = '/index.php?r=AppData/NewPhoneCode';
    pic_code = bindPhonePage.find('.new-pic-code-input').val().trim();
    param.phone = $btn.siblings('input').val();
    if(!checkIfPhone(param.phone)){
      alertTip('请输入正确的手机号');
      return;
    }
  }
  if(!pic_code){
    alertTip('请输入图形验证码');
    bindPhonePage.find('.old-pic-code-input').focus();
    return;
  }
  param.pic_code = pic_code;

  $btn.addClass('invalid');
  $ajax(url, 'post', param, 'json', function(data){
    if(data.status == 0){
      alertTip('验证码已发送');
      var count = 60,
          interval = setInterval(function(){
            var str = '剩余 '+count+' 秒'
            $btn.text(str);
            count--;
          }, 1000);
      setTimeout(function(){
        $btn.removeClass('invalid').text('获取验证码');
        clearInterval(interval);
      }, 60000);
    }else{
      $btn.removeClass('invalid');
      if (data.status == 1) {
        alertTip(data.data);
      } else if (data.status == 2) {
        alertTip('图形验证码错误');
        getPicCode(type);
      }
    };
  }, function(){
    alertTip('发送验证码失败，请重试');
    $btn.removeClass('invalid');
  });
}
function getPicCode(type){
  var img = type == 'new' ? $('.new-pic-url') : $('.old-pic-url');
  img.attr('src', '/index.php?r=Login/GetIdentifyCode&i=' + parseInt(Math.random() * 10000000))
}

function verify($btn){
  if($btn.hasClass('js-posting')){
    return;
  }
  var code = bindPhonePage.find('.verify-wrap > input').val();
  if(code.length<=0){
    alertTip('请输入验证码');
    return;
  }
  $btn.addClass('js-posting');
  $ajax('/index.php?r=AppData/VerifyPhone', 'post', {code: code}, 'json', function(data){
    if(data.status == 0){
      bindPhonePage.addClass('sec-step');
      getPicCode('new');
    }else{
      alertTip(data.data);
    };
    $btn.removeClass('js-posting');
  }, function(){
    alertTip('请输入正确的验证码。');
    $btn.removeClass('js-posting');
  });
}

function bindNewTel($btn){
  if($btn.hasClass('js-posting')){
    return;
  }
  var $bindWrap = $('.bind-new-tel-wrap'),
      phone = $bindWrap.find('.code-tel').val(),
      code = $bindWrap.find('.code-input').val();
  if(!checkIfPhone(phone)){
    alertTip('请输入正确的手机号');
    return;
  }
  if(code.length<=0){
    alertTip('请输入验证码');
    return;
  }

  $ajax('/index.php?r=AppData/VerifyNewPhone', 'post', {phone: phone, code: code}, 'json', function(data){
    if(data.status == 0){
      alertTip('绑定手机号成功', function(){
        window.history.back();
        userCenterPage.find('.js-tel').text(phone);
        bindPhonePage.removeClass('sec-step').find('input').val('');
      });
    }else{
      alertTip(data.data);
    }
    $btn.removeClass('js-posting');
  }, function(){
    alertTip('更改手机号失败，请重试');
    $btn.removeClass('js-posting');
  });
}

})();


</script>

    <style type="text/css">
.center-wrap {
  display: none;
  background-color: #fff;
  border-radius: 4px;
}
.center-wrap > header {
  position: relative;
  margin-bottom: 8%;
  line-height: 50px;
  font-size: 16px;
  text-align: center;
  color: #fff;
  background-color: #08a2e8;
}
.center-wrap > header > .back-btn {
  position: absolute;
  left: 0;
  width: 38px;
  height: 50px;
  line-height: 48px;
  font-size: 18px;
}
.center-wrap > div {
  width: 73%;
  margin-left: auto;
  margin-right: auto;
}
.center-wrap p {
  margin-top: 10px;
  border: 1px solid #ddd;
  background-color: #fff;
  border-radius: 3px;
  text-align: center;
}
.center-wrap .code-p {
  border: none;
  text-align: left;
}
.center-wrap input {
  width: 90%;
  line-height: 20px;
  padding: 8px 0;
  border: none;
  outline:none;
}
.center-wrap .code-input,
.center-wrap .pic-code-input {
  width: 60%;
  border: 1px solid #ddd;
  text-indent: 10px;
  border-radius: 3px;
  box-shadow: none;
}
.center-wrap .get-code-btn,
.center-wrap .pic-code-url {
  float: right;
  width: 35%;
  line-height: 36px;
  height: 36px;
  margin-left: auto;
}
.center-wrap .get-code-btn {
  border: 1px solid #e7940a;
  background-color: #ffb129;
  text-align: center;
  color: #fff;
  font-size: 14px;
}
.center-wrap .sibi {
  margin-top: 20px;
  margin-bottom: 20px;
  text-align: center;
}
#loginDialog .lrf-btn {
  position: relative;
  width: 100%;
  line-height: 35px;
  margin-top: 15px;
  margin-left: auto;
  margin-right: auto;
  background-color: #08a2e8;
  text-align: center;
  color: #fff;
  border-radius: 3px;
}
#loginDialog .invalid-btn {
  background-color: #ddd;
  border-color: #ddd;
}
#loginDialog .register-btn {
  background-color: #48b969;
}
#loginDialog .link-text {
  font-size: 13px;
  color: #486bbc;
  text-decoration: underline;
}
</style>
<div id="loginDialog" class="page" data-router="loginDialog">
  <div class="center-wrap" data-type="login">
    <header>即速应用</header>
    <div>
      <p><input id="login-phone" class="js-phone-input" placeholder="请输入手机号" type="text"></p>
      <!-- <p><input id="login-password" type="password" placeholder="输入登录密码"></p> -->
      <p class="code-p"><input class="pic-code-input" placeholder="图形验证码" type="text"><img class="pic-code-url login-pic-code"></p>
      <p class="code-p"><input id="login-code" class="code-input" placeholder="请输入验证码"><span class="get-code-btn">获取验证码</span></p>
      <div class="js-lrf-btn lrf-btn" data-type="login">登录</div>
      <div class="sibi">
        <!-- <span class="router-type link-text" data-type="register">没有账号？立即注册</span> -->
        <!-- <span class="router-type link-text" data-type="forget" style="float:right;">忘记密码</span> -->
      </div>
    </div>
  </div>
  <div class="center-wrap" data-type="register">
    <header><span class="back-btn router-type icon-leftarrow" data-type="login"></span>注册即速应用账号</header>
    <div>
      <p><input id="register-phone" class="js-phone-input" placeholder="请输入注册手机号" type="text"></p>
      <p class="code-p"><input class="pic-code-input" placeholder="图形验证码" type="text"><img class="pic-code-url register-pic-code"></p>
      <p class="code-p"><input id="register-code" class="code-input" placeholder="请输入验证码" type="text"><span class="get-code-btn">获取验证码</span></p>
<!--       <p><input id="register-password" class="js-password-input" type="password" placeholder="输入6-16位的密码"></p>
      <p><input id="register-confirm-psw" class="js-confirm-psw-input" type="password" placeholder="确认密码"></p> -->
      <div class="js-lrf-btn lrf-btn register-btn" data-type="register">注册</div>
    </div>
  </div>
<!--   <div class="center-wrap" data-type="forget">
    <header><span class="back-btn router-type icon-leftarrow" data-type="login"></span>找回密码</header>
    <div>
      <p><input id="forget-phone" class="js-phone-input" type="text" placeholder="输入注册手机号"></p>
      <p class="code-p"><input id="forget-code" class="code-input" type="text" placeholder="验证码"><span class="get-code-btn">获取验证码</span></p>
      <p><input id="forget-password" class="js-password-input" type="password" placeholder="输入6-16位的密码"></p>
      <p><input id="forget-confirm-psw" class="js-confirm-psw-input" type="password" placeholder="确认密码"></p>
      <div class="js-lrf-btn lrf-btn register-btn" data-type="forget">确定</div>
    </div>
  </div> -->
</div>
<script type="text/javascript">

(function(){
  var appId = GetQueryString('_app_id');

  // 切换页面 type类为触发页面切换的元素标识，元素的data-type属性为切换到页面的路由
  $('#loginDialog').on('click', '.router-type', function(event) {
    $('.center-wrap[data-type='+$(this).attr('data-type')+']').css('display','block').siblings('.center-wrap').css('display', 'none');

  }).on('click', '.js-lrf-btn', function(event) {
  // 登录、注册、找回密码
    if(!$(this).hasClass('invalid-btn')){
      var type = $(this).attr('data-type');
      switch(type){
        case 'login':
          var phone = $('#login-phone').val().trim(),
              // password = $('#login-password').val().trim();
              code = $('#login-code').val().trim();
          if( !checkIfPhone(phone) ){
            alertTip('请输入正确的手机号');
            $('#login-phone').focus();
            return;
          }
          if( !code ){
            alertTip('请输入验证码');
            $('#login-code').focus();
            return;
          }
          // if(password.length < 6 || password.length > 16){
          //   alertTip('请输入6-16位的密码');
          //   $('#login-password').focus();
          //   return;
          // }
          login({
            app_id: appId,
            phone: phone,
            // password: password,
            code: code
          }, $(this));
          break;
        case 'register':
          var phone = $('#register-phone').val().trim(),
              code = $('#register-code').val().trim();
              // password = $('#register-password').val().trim(),
              // confirmPsw = $('#register-confirm-psw').val().trim();
          if( !checkIfPhone(phone) ){
            alertTip('请输入正确的手机号');
            $('#register-phone').focus();
            return;
          }
          if( !code ){
            alertTip('请输入验证码');
            $('#register-code').focus();
            return;
          }
          // if(password.length < 6 || password.length > 16){
          //   alertTip('请输入6-16位的密码');
          //   $('#register-password').focus();
          //   return;
          // }
          // if(password!=confirmPsw){
          //   alertTip('两次密码不一致，请重新输入');
          //   $('#register-password').focus();
          //   return;
          // }
          register({
            app_id: appId,
            phone: phone,
            // password: password,
            code: code
          }, $(this));
          break;
        // case 'forget':
        //   var phone = $('#forget-phone').val().trim(),
        //       code = $('#forget-code').val().trim(),
        //       password = $('#forget-password').val().trim(),
        //       confirmPsw = $('#forget-confirm-psw').val().trim();
        //   if( !checkIfPhone(phone) ){
        //     alertTip('请输入正确的手机号');
        //     $('#forget-phone').focus();
        //     return;
        //   }
        //   if(password.length < 6 || password.length > 16){
        //     alertTip('请输入6-16位的密码');
        //     $('#forget-password').focus();
        //     return;
        //   }
        //   if(password!=confirmPsw){
        //     alertTip('两次密码不一致，请重新输入');
        //     $('#forget-password').focus();
        //     return;
        //   }
        //   resetPassword({phone: phone, password: password, code: code}, $(this));
        //   break;
      }
    }

  }).on('click', '.get-code-btn', function(event) {
  // 获取验证码
    if($(this).hasClass('invalid-btn')){
      return;
    }
    var $siblings = $(this).parent().siblings(),
        phone = $siblings.find('.js-phone-input').val(),
        pic_code = $siblings.find('.pic-code-input').val().trim();

    if(!pic_code){
      alertTip('请输入图形验证码');
      return;
    }
    if( !checkIfPhone(phone) ){
      alertTip('请输入正确的手机号');
      return;
    }
    getPhoneCode(phone, $(this), pic_code);

  }).on('click', '.pic-code-url', function(){
    getPicCode($(this));

  }).on('click', '.shadow', function(){
    APP.hideLogin();

  });

function getPhoneCode(phone, $btn, pic_code){
  $btn.addClass('invalid-btn');
  var url = '/index.php?r=AppUser/phoneCode',
      param = {phone: phone, pic_code: pic_code};

  $ajax(url, 'get', param, 'json', function(data){
    if(data.status==0){
      var $count = $('<span>60</span>');
      $btn.html($count).append('s');
      var count = 59,
          countInterval;

      countInterval = setInterval(function(){
        if(count <= 0){
          clearInterval(countInterval);
          $btn.html('获取验证码').removeClass('invalid-btn');
        }
        $count.text(count--);
      }, 1000);
    }else{
      $btn.removeClass('invalid-btn');
      if (data.status == 1) {alertTip(data.data);return;}
      if (data.status == 2) {alertTip('图形验证码错误');getPicCode($btn.parent().siblings().find('.pic-code-url'));return;}
    }
  },function(){
    $btn.removeClass('invalid-btn');
    alertTip('请求手机验证码失败, 请重试');
  });
}

function getPicCode(img){
  $(img).attr('src', '/index.php?r=Login/GetNewIdentifyCode&i=' + parseInt(Math.random() * 10000000))
}

function register(param, $btn){
  $btn.addClass('invalid-btn');
  $ajax('/index.php?r=AppUser/phoneReg', 'get', param, 'json', function(data){
    if(data.status==0){
      alertTip('注册成功', function(){
        $('#loginDialog .router-type[data-type="login"]:visible').trigger('click');
      }, 700);

    }else{
      $btn.removeClass('invalid-btn');
      alertTip('注册失败.'+data.data);
    }
  },function(){
    $btn.removeClass('invalid-btn');
    alertTip('注册失败，请重试');
  });
}

function login(param, $btn){
  $btn.addClass('invalid-btn');
  $ajax('/index.php?r=AppUser/phoneReg', 'get', param, 'json', function(data){
    var nickname, cover;
    if(data.status==0){
      if((nickname = data.nickname) && (cover = data.cover_thumb)){
        alertTip('登录成功', function(){
          APP.setLogin(data).hideLogin();
        });
      } else {
        var tipText = '';
        if(!nickname && !cover){
          tipText = '请补充个人信息';
        } else if (!nickname){
          tipText = '请填写个人昵称';
        } else if (!cover){
          tipText = '请上传个人头像';
        }
        alertTip('登录成功 '+ tipText, function(){
          APP.setLogin().showPage('userCenterPage');
          window.history.replaceState(null, '', modifyTargetUrl({router: 'userCenterPage'}));
        }, 2000);
      }
      $btn.removeClass('invalid-btn');
    }else{
      $btn.removeClass('invalid-btn');
      alertTip('登录失败.'+data.data);
    }
  },function(){
    $btn.removeClass('invalid-btn');
    alertTip('登录失败，请重试');
  });
}

// function resetPassword(param, $btn){
//   $btn.addClass('invalid-btn');
//   $ajax('/index.php?r=AppUser/resetPassword', 'get', param, 'json', function(data){
//     if(data.status==0){
//       alertTip('重设密码成功, 请返回登录');

//     }else{
//       $btn.removeClass('invalid-btn');
//       alertTip('重设密码失败.'+data.data);
//     }
//   },function(){
//     $btn.removeClass('invalid-btn');
//     alertTip('重设密码失败, 请重试');
//   });
// }

})();

</script>

    <style rel="stylesheet">
.logistics-wrap {
  color: #888;
  background-color: #f6f6f6;
}
.logistics-top-section {
  margin: 12px 0;
}
.logistics-top-section, .logistics-info-container {
  padding: 15px;
  background-color: #fff;
}
.logistics-order-status[status='success'], .logistics-info-list > li:first-child {
  color: #10b935;
}
.logistics-order-status[status='error'] {
  color: #f52f2f;
}
.logistics-info-list {
  margin-left: 7px;
  border-left: 1px solid #ccc;
}
.logistics-info-list > li {
  position: relative;
  padding-left: 22px;
  margin: 20px 0;
  font-size: 13px;
  line-height: 16px;
}
.logistics-info-list > li:before {
  content: '';
  position: absolute;
  top: 0;
  left: -5px;
  width: 10px;
  height: 10px;
  z-index: 2;
  border-radius: 50%;
  background-color: #ccc;
}
.logistics-info-list > li:first-child:before {
  background-color: #10b935;
}
.logistics-info-list > li:first-child:after {
  content: '';
  position: absolute;
  top: -3px;
  left: -8px;
  width: 16px;
  height: 16px;
  z-index: 1;
  border-radius: 50%;
  background-color: #10b935;
  opacity: 0.3;
}
.logistics-info-list > li > div:last-child {
  font-size: 12px;
}

</style>
<div class="logistics-wrap page" id="logisticsPage">
  <div class="logistics-top-section">
    <div style="display:inline-block;">
      <div><span style="color:#333;margin-right:5px;">物流状态</span><span class="logistics-order-status"></span></div>
      <div style="margin-top:10px;font-size:12px;line-height:17px;">
        <div>承运公司：<span class="logistics-company"></span></div>
        <div>运单编号：<span class="logistics-order-id"></span></div>
      </div>
    </div>
  </div>
  <div class="logistics-info-container">
    <div style="color:#333; padding-bottom:10px; margin-bottom:11px; border-bottom:1px solid #ccc;">物流跟踪</div>
    <ul class="logistics-info-list">
<!--       <li>
        <div>深圳市南山区深南花园</div>
        <div>2016-02-29 13:23:56</div>
      </li>
      <li>
        <div>深圳市南山区深南花园</div>
        <div>2016-02-29 13:23:56</div>
      </li>
      <li>
        <div>深圳市南山区深南花园</div>
        <div>2016-02-29 13:23:56</div>
      </li> -->
    </ul>
  </div>
</div>


    <style rel="stylesheet">
.comPage-wrap {
  background-color: #f4f4f4;
}
.comPage-top-section {
  padding: 12px 10px 0;
  background-color: #fff;
}
.comPage-comment-label {
  display: inline-block;
  padding: 5px 7px;
  margin-right: 5px;
  margin-bottom: 12px;
  font-size: 12px;
  color: #333;
  background-color: rgba(255,113,0,0.1);
  border-radius: 4px;
}
.comPage-comment-label.active {
  color: #fff;
  background-color: #ff7100;
}
.comPage-comment-list {
  color: #000;
  background-color: #fff;
}
.comPage-comment-item {
  padding: 10px;
  border-bottom: 8px solid #f4f4f4;
}
.comPage-comment-photo {
  width: 33px;
  height: 33px;
  border-radius: 50%;
  margin-right: 7px;
  vertical-align: middle;
}
.comPage-comment-name {
  font-size: 15px;
}
.comPage-comment-content {
  font-size: 13px;
  line-height: 16px;
  word-wrap: break-word;
}
.comPage-comment-date, .comPage-comment-model {
  color: #aaa;
  font-size: 13px;
}
.comPage-comment-date {
  margin: 8px 0;
  display: inline-block;
}
.comPage-comment-pics {
  margin: 10px 0 0;
}
.comPage-comment-pics > img {
  width: 93px;
  height: 93px;
  margin-right: 8px;
}
.comPage-comment-pics > img:last-child {
  margin: 0;
}
.comPage-bottom-section {
  top: 112px;
  /*height: 200px;*/
  bottom: 0;
  left: 0;
  right: 0;
  overflow-y: auto;
}
</style>
<div class="comPage-wrap page" id="commentPage">
  <div class="comPage-top-section">
    <div style="border-bottom: 1px solid #f4f4f4;">
      <span class="comPage-comment-label active" data-type="0" data-page="1"> 全部 </span><span class="comPage-comment-label" data-type="1" data-page="1">好评 (<span class="comPage-positive-comment">0</span>)</span><span class="comPage-comment-label" data-type="2" data-page="1">中评 (<span class="comPage-neutral-comment">0</span>)</span><span class="comPage-comment-label" data-type="3" data-page="1">差评 (<span class="comPage-negative-comment">0</span>)</span><span class="comPage-comment-label" data-type="4" data-page="1">有图 (<span class="comPage-pic-comment">0</span>)</span>
    </div>
  </div>
  <div class="comPage-bottom-section">
    <ul class="comPage-comment-list">
      <!-- <li class="comPage-comment-item">
        <div><img class="comPage-comment-photo"><span class="comPage-comment-name">文艺狗</span></div>
        <p class="comPage-comment-content">款式大气，手感很好，很适合很喜欢，很满意的一次购物，家人也很好，很热情。</p>
        <div><span class="comPage-comment-date">2016-04-09</span><span class="comPage-comment-model">颜色分类：白色斑点  尺寸：L</span></div>
      </li>
      <li class="comPage-comment-item">
        <div><img class="comPage-comment-photo"><span>文艺狗</span></div>
        <p class="comPage-comment-content">款式大气，手感很好，很适合很喜欢，很满意的一次购物，家人也很好，很热情。</p>
        <div class="comPage-comment-pics">
          <img>
          <img>
          <img>
        </div>
        <div><span class="comPage-comment-date">2016-04-09</span><span class="comPage-comment-model">颜色分类：白色斑点  尺寸：L</span></div>
      </li> -->
    </ul>
  </div>
</div>
<script type="text/javascript">
(function(){
  var scrollTimer;

  $('#commentPage').on('click', '.comPage-comment-label', function(){
    $(this).addClass('active').siblings('.active').removeClass('active');
    APP.getComments($(this).attr('data-type'), 1);
    $(this).attr('data-page', 1);
  });

  $('.comPage-bottom-section').scroll(function(){
    if(scrollTimer) { return; }
    scrollTimer = setTimeout(function(){
      scrollTimer = clearTimeout(scrollTimer);
    }, 100);

    var label = $('.comPage-comment-label.active'),
        toBottom = isScrollToBottom($('.comPage-bottom-section'), $('.comPage-comment-list'));

    if(toBottom){
      APP.getComments(label.attr('data-type'), label.attr('data-page'));
    }

  });

})();
</script>

    <style rel="stylesheet">
.makeCom-wrap {
  padding-bottom: 60px;
  background-color: #f9f9f9;
}
.makeCom-item {
  padding: 10px 10px 0;
  margin: 15px 0;
  background-color: #fff;
  border: 1px solid #ddd;
}
.makeCom-goods-cover {
  width: 80px;
  height: 80px;
  border-radius: 4px;
  margin-right: 10px;
  vertical-align: top;
}
.makeCom-textarea {
  height: 100px;
  width: calc(100% - 100px);
  padding: 0;
  box-sizing: border-box;
  line-height: 18px;
  overflow-x: hidden;
  overflow-y: auto;
  border: none;
  resize: none;
}
.makeCom-textarea:focus {
  outline: none;
}
.makeCom-upload-pic {
  position: relative;
  display: inline-block;
  padding: 6px 0 8px;
  width: 66px;
  color: #999;
  font-size: 12px;
  border: 1px solid #ccc;
  border-radius: 6px;
  text-align: center;
  vertical-align: middle;
}
.makeCom-upload-pic > p {
  font-size: 44px;
  line-height: 35px;
}
.makeCom-upload-pic > input {
  position: absolute;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  opacity: 0;
}
.makeCom-pic-container {
  margin: 10px 0;
}
.makeCom-level-container {
  display: flex;
  display: -webkit-flex;
  display: -moz-flex;
  display: -o-flex;
  margin: 0 -10px;
  border-top: 1px solid #ddd;
}
.makeCom-level-span {
  flex: 1;
  -webkit-flex: 1;
  -moz-flex: 1;
  -o-flex: 1;
  line-height: 40px;
  text-align: center;
}
.makeCom-level-span > span {
  font-size: 18px;
  margin-right: 5px;
  vertical-align: text-bottom;
}
.makeCom-level-span.active .icon-positive, .makeCom-level-span.active .icon-negative,
.makeCom-level-span .icon-positive-active, .makeCom-level-span .icon-neutral-active, .makeCom-level-span .icon-negative-active {
  display: none;
}
.makeCom-level-span.active .icon-positive-active, .makeCom-level-span.active .icon-neutral-active, .makeCom-level-span.active .icon-negative-active {
  display: inline-block;
}
.makeCom-level-span[data-level="1"].active {
  color: #eb5a09;
}
.makeCom-level-span[data-level="2"].active {
  color: #ffb033;
}
.makeCom-level-span[data-level="3"].active {
  color: #6c593b;
}
.makeCom-pic-wrap {
  position: relative;
  display: inline-block;
  width: 64px;
  height: 64px;
  border: 1px solid #ddd;
  vertical-align: middle;
  margin-right: 10px;
}
.makeCom-pic-wrap > img {
  width: 100%;
  height: 100%;
}
.makeCom-remove-pic {
  position: absolute;
  top: -5px;
  right: -5px;
  width: 16px;
  height: 16px;
  font-size: 16px;
  text-align: center;
  border: 1px solid;
  border-radius: 50%;
  color: #999;
  background: #fff;
}
.makeCom-mark-container {
  display: inline-block;
  margin-left: 50px;
  font-size: 20px;
  color: #eee;
  vertical-align: top;
}
.makeCom-mark-container > span {
  /*margin-right: 10px;*/
  padding: 5px;
}
.makeCom-mark-container > span.active {
  color: #f7af25;
}
.makeCom-bottom-nav {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  padding: 10px 20px;
  line-height: 34px;
  background-color: #fff;
  border-top: 1px solid #ddd;
}
.makeCom-make-comment {
  display: block;
}
</style>
<div class="makeCom-wrap page" id="makeComment">
  <div class="makeCom-goods-list">
    <div class="makeCom-item makeCom-goods-comment" data-id="">
      <div>
        <img class="makeCom-goods-cover">
        <textarea class="makeCom-textarea" placeholder="写下购买体会为其他小伙伴提供参考，15字以上"></textarea>
      </div>
      <div class="makeCom-pic-container">
        <div class="makeCom-upload-pic"><p>+</p><span>添加图片</span><input accept="image/jpg,image/jpeg, image/gif,image/png, image/bmp, image/jp2, image/x-ms-bmp, image/x-png" type="file"></div>
      </div>
      <div class="makeCom-level-container">
        <span class="makeCom-level-span active" data-level="1"><span class="icon-positive"></span><span class="icon-positive-active"></span>好评</span>
        <span class="makeCom-level-span" data-level="2"><span class="icon-positive"></span><span class="icon-neutral-active"></span>中评</span>
        <span class="makeCom-level-span" data-level="3"><span class="icon-negative"></span><span class="icon-negative-active"></span>差评</span>
      </div>
    </div>
    <div class="makeCom-item makeCom-goods-comment">
      <div>
        <img class="makeCom-goods-cover">
        <textarea class="makeCom-textarea" placeholder="写下购买体会为其他小伙伴提供参考，15字以上"></textarea>
      </div>
      <div class="makeCom-pic-container">
        <div class="makeCom-upload-pic"><p>+</p><span>添加图片</span><input accept="image/jpg,image/jpeg, image/gif,image/png, image/bmp, image/jp2, image/x-ms-bmp, image/x-png" type="file"></div>
      </div>
      <div class="makeCom-level-container">
        <span class="makeCom-level-span active" data-level="1"><span class="icon-positive"></span><span class="icon-positive-active"></span>好评</span>
        <span class="makeCom-level-span" data-level="2"><span class="icon-positive"></span><span class="icon-neutral-active"></span>中评</span>
        <span class="makeCom-level-span" data-level="3"><span class="icon-negative"></span><span class="icon-negative-active"></span>差评</span>
      </div>
    </div>
    <div class="makeCom-item makeCom-goods-comment">
      <div>
        <img class="makeCom-goods-cover">
        <textarea class="makeCom-textarea" placeholder="写下购买体会为其他小伙伴提供参考，15字以上"></textarea>
      </div>
      <div class="makeCom-pic-container">
        <div class="makeCom-upload-pic"><p>+</p><span>添加图片</span><input accept="image/jpg,image/jpeg, image/gif,image/png, image/bmp, image/jp2, image/x-ms-bmp, image/x-png" type="file"></div>
      </div>
      <div class="makeCom-level-container">
        <span class="makeCom-level-span active" data-level="1"><span class="icon-positive"></span><span class="icon-positive-active"></span>好评</span>
        <span class="makeCom-level-span" data-level="2"><span class="icon-positive"></span><span class="icon-neutral-active"></span>中评</span>
        <span class="makeCom-level-span" data-level="3"><span class="icon-negative"></span><span class="icon-negative-active"></span>差评</span>
      </div>
    </div>
  </div>
  <div class="makeCom-item" style="padding:10px; line-height:30px;">
    <div style="font-size:16px;">店铺评分</div>
    <div>描述相符：<div class="makeCom-mark-container makeCom-fit-score"><span class="icon-star"></span><span class="icon-star"></span><span class="icon-star"></span><span class="icon-star"></span><span class="icon-star"></span></div></div>
    <div>物流服务：<div class="makeCom-mark-container makeCom-logistics-score"><span class="icon-star"></span><span class="icon-star"></span><span class="icon-star"></span><span class="icon-star"></span><span class="icon-star"></span></div></div>
  </div>

  <!-- <div class="makeCom-top-section">
    <div class="makeCom-goods-detail">
      <img class="makeCom-goods-cover">
      <div style="display:inline-block;vertical-align:middle;">
        <p class="makeCom-goods-title">金龙鱼粮油</p>
        <p><span style="color:#f60;">￥ <span class="makeCom-goods-price">109.00</span></span> 元/件</p>
      </div>
      <div>
        <span class="makeCom-level-span" data-level="1"><span class="icon-positive"></span>好评</span>
        <span class="makeCom-level-span" data-level="2"><span class="icon-neutral"></span>中评</span>
        <span class="makeCom-level-span" data-level="3"><span class="icon-negative"></span>差评</span>
      </div>
    </div>
  </div>
  <div class="makeCom-bottom-section">
    <div style="border-bottom:1px solid #ccc; padding:15px;">评价：<div class="makeCom-mark-container"><span></span><span></span><span></span><span></span><span></span></div></div>
    <div style="padding:0 10px 15px;">
      <textarea class="makeCom-textarea" placeholder="长度在15-150个字之间"></textarea>
      <div style="text-align:right;color:#ccc;"><span class="makeCom-word-remain">0</span>/150</div>
      <div class="makeCom-pic-container">
        <div class="makeCom-upload-pic"><p style="font-size:47px;line-height:41px;">&plus;</p><span>添加图片</span></div>
      </div>
    </div>
  </div> -->
  <div class="makeCom-bottom-nav"><span class="makeCom-make-comment btn btn-orange">发表评价</span></div>
</div>
<script type="text/javascript">
(function(){
  $('#makeComment').on('click', '.makeCom-make-comment', function(){
    var para = {},
        infor = {},
        tip = '',
        $comment, $pics, content, level, score, logistics_score, img_arr;

    if(!(score = $('.makeCom-fit-score').attr('score'))){
      tip = '请为描述相符评分';
    }
    if(!(logistics_score = $('.makeCom-logistics-score').attr('score'))){
      tip = '请为物流服务评分';
    }

    if(!tip){
      para.goods = [];
      $('.makeCom-goods-comment').each(function(index, comment){
        $comment = $(comment);
        img_arr = [];

        if( !(content = $comment.find('.makeCom-textarea').val().trim()) || content.length < 10 ){
          tip = '评价内容至少10字';
        }
        if( !(level = $comment.find('.makeCom-level-span.active').attr('data-level')) ) {
          tip = '请选择评价等级';
        }
        if( ($pics = $comment.find('.makeCom-pic-wrap')).length > 3 ) {
          tip = '最多上传3张图片';
        }
        if(tip) { return false; }

        $pics.length && $pics.each(function(i, pic){
          img_arr.push($(pic).attr('data-src'));
        });
        para.goods.push({
          goods_id: $comment.attr('data-id'),
          info: {
            content: content,
            level: level,
            img_arr: img_arr
          }
        });
      });
    }

    if(tip){
      alertTip(tip);
      return;
    }
    para.order_id = GetQueryString('detail');
    para.score = score;
    para.logistics_score = logistics_score;
    para.sub_shop_app_id = GetQueryString('franchisee');

    APP.submitComment(para);

  }).on('click', '.makeCom-remove-pic', function(){
    var _this = $(this),
        _container = _this.closest('.makeCom-pic-container');
        _pic = 0;

    _this.parent().remove();
    _pic = _container.children('.makeCom-pic-wrap');

    if(_pic.length < 3){
      _container.children('.makeCom-upload-pic').children('input').show();
    }

  }).on('click', '.makeCom-upload-pic', function(){
    var _this = $(this),
        _pic = _this.parent().children('.makeCom-pic-wrap');

    if(_pic.length >= 3){
      alertTip("最多上传3张图片");
      return ;
    }

    _this.imgUpload(function(data){
      _this.before('<div class="makeCom-pic-wrap" data-src='+data+'><img src='+data+'><span class="makeCom-remove-pic">&times;</span></div>');
      var _pic = _this.parent().children('.makeCom-pic-wrap');
      if(_pic.length >= 3){
        _this.children('input').hide();
      }
    });

  }).on('click', '.makeCom-level-span', function(){
    $(this).addClass('active').siblings('.active').removeClass('active');

  }).on('click', '.makeCom-mark-container span', function(){
    var index = $(this).index();
    $(this).siblings().removeClass('active');
    $(this).addClass('active').prevAll().addClass('active');
    $(this).parent().attr('score', +index+1);

  });


})();
</script>

    <style rel="stylesheet">
.appointmentPage-wrap {
  padding-bottom: 50px;
}
.appointment-top-section {
  padding: 0 15px;
  line-height: 40px;
}
.appointment-top-section hr {
  margin: 0;
  border: none;
  border-bottom: 1px solid;
  color: #ddd;
}
.appointment-model-field {
  padding: 5px 10px;
}
.appointment-model-right {
  float: right;
}
.appointmentPage-wrap select {
  -webkit-appearance: menulist;
  border: none;
}
.appointment-service-price {
  color: red;
}
.appointment-date-list {
  width: 100%;
  padding-bottom: 10px;
  white-space: nowrap;
  overflow-x: auto;
}
.appointment-date-item {
  display: inline-block;
  padding: 10px 14px;
  border: 1px solid #ddd;
  border-left: none;
  background-color: #eee;
  text-align: center;
}
.appointment-date-item.disabled {
  color: #aaa;
}
.appointment-not-available {
  display: none;
}
.appointment-date-item.disabled .appointment-not-available,
.appointment-period-item.disabled .appointment-not-available {
  display: inline;
}
.appointment-date-item.selected {
  position: relative;
  background-color: #666;
  color: #fff;
}
.appointment-date-item.selected:before {
  content: '';
  position: absolute;
  left: calc(50% - 8px);
  bottom: -8px;
  display: block;
  border-left: 8px solid transparent;
  border-right: 8px solid transparent;
  border-top: 10px solid #666;
}
.appointment-period-list {
  padding: 5px 10px 14px;
}
.appointment-period-item {
  position: relative;
  display: inline-block;
  height: 30px;
  width: 24.5%;
  margin-left: -1px;
  margin-top: -1px;
  padding: 14px 0;
  z-index: 1;
  font-size: 12px;
  text-align: center;
  color: #666;
  background-color: #fff;
  border: 1px solid #aaa;
  vertical-align: top;
}
.appointment-period-item.disabled {
  color: #aaa;
  background-color: #eee;
  border-color: #ccc;
  z-index: 0;
}
.appointment-period-item.selected {
  border-color: #10b935;
  box-shadow: inset 0 0 1px #10b935;
  z-index: 2;
}
.appointment-bottom-bar {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  padding: 10px 15px;
  z-index: 1;
  background: #fff;
  border-top: 1px solid #eee;
}
.sure-make-appointment {
  color: #fff;
  background-color: #10b935;
}
</style>
<div class="appointmentPage-wrap page" id="appointmentPage" data-router="appointmentPage">
  <div class="appointment-top-section">
    <div class="appointment-model-field"><span>服务时长</span><div class="appointment-model-right"><select class="appointment-field-selection appointment-service-long-select"></select><span class="appointment-time-unit"></span></div></div>
    <hr>
    <div class="appointment-model-field"><span>营业时段</span><div class="appointment-model-right"><select class="appointment-field-selection appointment-service-period-select"></select></div></div>
    <hr>
    <div class="appointment-model-field"><span>价格</span><div class="appointment-model-right"><span class="appointment-service-price">70</span> 元</div></div>
  </div>
  <div class="appointment-time-section">
    <div class="appointment-date-list"></div>
    <div class="appointment-period-list"></div>
  </div>
  <div class="appointment-bottom-bar">
    <span class="btn btn-block sure-make-appointment">确认</span>
  </div>
</div>
<script>
(function(){

  $('.appointmentPage-wrap').on('change', '.appointment-service-period-select', function(){
    // 预约页面选择时段
    APP.changeAppointmentCondition();

  }).on('change', '.appointment-service-long-select', function(){
    // 预约页面选择时长
    APP.changeAppointmentCondition();

  }).on('click', '.appointment-date-item', function(){
    $(this).addClass('selected').siblings().removeClass('selected');
    if($(this).attr('data-ifBusiness') == 0){
      $('.appointment-period-list').html('');
      return;
    }
    APP.changeAppointmentCondition();

  }).on('click', '.appointment-period-item', function(){
    if($(this).hasClass('disabled')){
      return;
    }
    $(this).addClass('selected').siblings().removeClass('selected');

  }).on('click', '.sure-make-appointment', function(){
    APP.sureMakeAppointment();

  });
})();
</script>

    <style rel="stylesheet">
    #searchPage{
        background:#fcfaff;
    }
    .search-page-wrap .search{
        height:50px;
        line-height:50px;
        background:#efeff4;
        width:320px;
        border-bottom: 1px solid #d6d6db;
    }
    .search-page-wrap .search-input{
        width:260px;
        border-radius:5px;
        background:#ffffff;
        height:30px;
        line-height:30px;
        margin-left:10px;
        color:#888888;
        display:inline-block;
        border: 1px solid #e6e6ea;
        position:relative;
        text-align: left;
        padding-left: 10px;
    }
    .search-page-wrap .search-input i{
        vertical-align:middle;
        margin-right:5px;
    }
    .search-page-wrap .search-input input{
        vertical-align:middle;
        border-style:none;
        display:inline-block;
        height: 100%;
        width:240px;
        position: absolute;
    }
    .search-page-wrap .search-input span{
        position:absolute;
        right:-33px;
        top:0px;
    }
    .search-page-wrap .quick-tags{
        padding: 20px 20px 10px 20px;
    }
    .search-page-wrap .quick-tags p{
        color: #888888;
        margin-bottom: 15px;
    }
    .search-page-wrap .tags span{
        display: inline-block;
        height: 30px;
        line-height: 30px;
        text-align: center;
        margin-right: 10px;
        margin-bottom: 5px;
        background: #d2d2d2;
        padding: 0 10px;
        border-radius: 50px;
        color: #fff;
    }
</style>
<div class="search-page-wrap page" id="searchPage">
    <div class="element search">
        <div class="search-input">
            <i class="icon-search"></i>
            <form action="" target="id_iframe" style="display: inline;">
                <input autofocus="" id="search" placeholder="搜索" type="search">
            </form>
            <iframe id="id_iframe" name="id_iframe" style="display: none;"></iframe>
            <span>搜索</span>
        </div>
    </div>
    <div class="quick-tags">
        <p>热门标签</p>
        <div class="tags">

        </div>
    </div>
</div>
<script>
    (function(){
        $("#search").change(function(){
            if($(this).val() === ''){
                $("#searchPage .quick-tags").show();
                $('#searchPage .list-vessel-wrap').eq(0).children("ul").empty();
            }
        });
        var oldKeyword = '';
        $("#search").blur(function(){
            var $list = $('#searchPage .list-vessel-wrap').eq(0),
                keyword = $("#search").val(),
                form = $("#searchPage").data("form"),
                type = $list.data("type");
                console.log(type);
            if(keyword === '' || oldKeyword === keyword){
                return;
            }
            APP.search(keyword,$list,form,type);
            oldKeyword = keyword;
        });
    })()
    function cancel(){
        history.go(-1);
        $("#search").val('');
        $("#searchPage .js-list-container").empty();
    }
</script>
    <style rel="stylesheet">
#myMessage {
  min-height: 100vh;
  background-color: #edeeef;
}
#myMessage .myMessage-top-nav {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  height: 42px;
  line-height: 42px;
  text-align: center;
  z-index: 9;
  box-shadow: 0 1px 2px #eee;
  background-color: #f6f7f8;
}
#myMessage .myMessage-return-btn .icon-leftarrow {
  vertical-align: top;
  margin-top: 10px;
  display: inline-block;
}
#myMessage .myMessage-return-btn {
  position: absolute;
  top: 0;
  left: 0;
  width: 36px;
  font-size: 20px;
  text-align: center;
}
#myMessage .myMessage-type-item {
  position: relative;
  display: inline-block;
  width: 70px;
}
#myMessage .myMessage-type-item:first-child {
  margin-right: 10px;
}
#myMessage .myMessage-type-item.active {
  color: #55b737;
  border-bottom: 1px solid #55b737;
}
#myMessage .myMessage-type-item.has-noread::after {
  content: '';
  position: absolute;
  top: 8px;
  right: -5px;
  width: 5px;
  height: 5px;
  background: #ff0000;
  border-radius: 50%;
}
#myMessage .myMessage-type-item.active.has-noread {
  display: none;
}
#myMessage .myMessage-content-container {
  padding-top: 42px;
}
#myMessage .myMessage-content {
  display: none;
}
#myMessage .myMessage-content.active {
  display: block;
}
#myMessage .message-item {
  position: relative;
  margin: 16px 10px 0;
  height: 100px;
  background: #feffff;
  border-radius: 4px;
}
#myMessage .message-item:last-child {
  margin-bottom: 16px;
}
#myMessage .message-item .message-title {
  position: absolute;
  top: 10px;
  left: 12px;
}
#myMessage .message-item.type-pay .message-title ,
#myMessage .message-item.type-form .message-title ,
#myMessage .message-item.type-comment .message-title ,
#myMessage .message-item.type-Administrators .message-title {
  color: #55b737;
}
#myMessage .message-item .message-time {
  position: absolute;
  top: 13px;
  right: 12px;
  font-size: 12px;
  color: #acacac;
}
#myMessage .message-item .message-img {
  position: absolute;
  display: block;
  top: 36px;
  left: 10px;
  width: 50px;
  height: 50px;
}
#myMessage .message-item.type-pay .message-img ,
#myMessage .message-item.type-form .message-img ,
#myMessage .message-item.type-comment .message-img ,
#myMessage .message-item.type-Administrators .message-img {
  border-radius: 50%;
  color: #fff;
  text-align: center;
  font-size: 30px;
}
#myMessage .message-item.type-pay .message-img {
  background: #f6ce59;
}
#myMessage .message-item.type-form .message-img {
  background: #9dd64b;
}
#myMessage .message-item.type-comment .message-img {
  background: #f5ce59;
}
#myMessage .message-item.type-Administrators .message-img {
  background: #adadad;
}
#myMessage .message-item.type-pay .icon-message-pay,
#myMessage .message-item.type-Administrators .icon-notify  {
  display: inline-block;
  vertical-align: top;
  margin-top: 8px;
}
#myMessage .message-item.type-form .icon-message-form ,
#myMessage .message-item.type-comment .icon-message-comment {
  display: inline-block;
  vertical-align: top;
  margin-top: 10px;
}
#myMessage .message-item .message-content {
  position: absolute;
  top: 36px;
  left: 75px;
  width: calc(100% - 85px);
  max-height: 56px;
  overflow: hidden;
}
#myMessage .message-item.type-pay .message-price {
  margin-top: 8px;
}
#myMessage .message-item.type-pay .message-orderNum {
  margin-top: 4px;
  color: #acacac;
}
#myMessage .message-item.type-pay .message-orderNum span:nth-child(2) {
  font-size: 12px;
}
#myMessage .myMessage-detail-form {
  display: none;
  z-index: 1;
}
#myMessage .myMessage-form-list {
  border-top: 1px solid #ddd;
  border-bottom: 1px solid #ddd;
  margin-top: 15px;
  background: #feffff;
}
#myMessage .myMessage-form-item {
  min-height: 36px;
  border-bottom: 1px solid #ddd;
  margin: 0 10px;
  padding: 5px 0;
  line-height: 36px;
}
#myMessage .myMessage-form-item:last-child {
  border: 0;
}
#myMessage .myMessage-form-item .data-name {
  display: inline-block;
  height: 36px;
  width: 85px;
  margin-right: 8px;
  vertical-align: top;
  color: #878889;
  text-align: center;
  overflow: hidden;
}
#myMessage .myMessage-form-item .data-content {
  display: inline-block;
  max-width: calc(100% -90px);
  min-height: 36px;
  line-height: 36px;
  overflow: hidden;
  vertical-align: top;
}
#myMessage .myMessage-form-item .data-img {
  display: inline-block;
  width: 60px;
  height: 60px;
}
#myMessage .myMessage-detail-form .myMessage-form-confirm {
  margin: 14px 10px;
  padding: 10px 0;
  background: #55b737;
  border-radius: 5px;
  color: #fff;
  text-align: center;
  font-size: 16px;
}
#myMessage-system-message {
  height: 625px;
  height: calc(100vh - 42px);
  overflow: auto;
}
#myMessage-interact-message {
  height: 625px;
  height: calc(100vh - 42px);
  overflow: auto;
}
</style>
<div class="myMessage-wrap page" id="myMessage">
  <div class="myMessage-top-nav">
    <div class="myMessage-return-btn">
      <span class="icon-leftarrow"></span>
    </div>
    <ul class="myMessage-type-list">
      <li class="myMessage-type-item active">系统消息</li>
      <li class="myMessage-type-item">互动消息</li>
    </ul>
  </div>
  <div class="myMessage-content-container">
    <div class="myMessage-content active">
      <ul id="myMessage-system-message">
        <!-- <li class="message-item type-pay">
          <div class="message-title">支付成功</div>
          <div class="message-time">2016年11月8日</div>
          <img class="message-img" src="">
          <div class="message-content">
            <div class="message-price">
              <span>支付金额：</span>
              <span>¥80.00</span>
            </div>
            <div class="message-orderNum">
              <span>订单号：</span>
              <span>10000000</span>
            </div>
          </div>
        </li>
        <li class="message-item type-system">
          <div class="message-title">双十二优惠</div>
          <div class="message-time">2016年11月8日</div>
          <img class="message-img" src="">
          <div class="message-content">双十二优惠双十二优惠双十二优惠</div>
        </li>
        <li class="message-item type-form">
          <div class="message-title">表单提交成功</div>
          <div class="message-time">2016年11月8日</div>
          <img class="message-img" src="">
          <div class="message-content">双十二优惠双十二优惠双十二优惠</div>
        </li> -->
      </ul>
    </div>
    <div class="myMessage-content">
      <ul id="myMessage-interact-message">
        <!-- <li class="message-item type-comment">
          <div class="message-title">表单提交成功</div>
          <div class="message-time">2016年11月8日</div>
          <img class="message-img" src="">
          <div class="message-content">双十二优惠双十二优惠双十二优惠</div>
        </li> -->
      </ul>
    </div>
  </div>
  <div class="myMessage-detail-form">
    <ul class="myMessage-form-list">
      <!-- <li class="myMessage-form-item">
        <span class="data-name">数据名</span>
        <span class="data-content">填写内容</span>
      </li>
      <li class="myMessage-form-item">
        <span class="data-name">数据名</span>
        <span class="data-content">填写内容</span>
      </li>
      <li class="myMessage-form-item">
        <span class="data-name">数据名</span>
        <span class="data-content">填写内容</span>
      </li> -->
    </ul>
    <div class="myMessage-form-confirm">确定</div>
  </div>
</div>
<script>
(function(){
  var appId = GetQueryString("_app_id");
  // 绑定事件
  // 返回个人中心
  $('.myMessage-return-btn').on('click', function(){
    window.history.back();
  });
  // 消息跳转
  $('.myMessage-content-container').on('click', '.message-item.type-system', function(){
    // 跳转到对应页面
    var _router = $(this).attr('data-turnToPage');
    APP.turnToPage({
      router: _router
    });
  }).on('click', '.message-item.type-form', function(){
    // 跳转到表单页面
    var _form = $(this).attr('data-form'),
        _form_id = $(this).attr('data-form-id'),
        _formData_id = $(this).attr('data-formData-id'),
        _formData_list = [];

    // 检测是否有此数据，没有则不继续进行
    if (!_formData_id) {
      return;
    }
    // 获取表单的类型列表
    $.ajax({
      url: '/index.php?r=pc/WebAppMgr/getForm',
      data: {
        app_id: appId,
        form_id: _form_id
      },
      type: 'get',
      dataType: 'json',
      success: function(data){
        if (data.status != 0) {
          alertTip(data.data)
          return;
        }
        _formData_list = data.data.field_arr;
        _formData_list.shift(); // 默认去除第一个（非用户创建）
        // 获取表单信息
        $.ajax({
          url: '/index.php?r=AppData/getFormData',
          data: {
            app_id: appId,
            form: _form,
            data_id: _formData_id
          },
          type: 'get',
          dataType: 'json',
          success: function(data){
            if (data.status != 0) {
              alertTip(data.data)
              return;
            }
            var html = '';
            $.each(data.data["0"].form_data, function(entryIndex, entry){
              var entryNum = -1;
              for (var i = 0; i < _formData_list.length; i++) {
                if(_formData_list[i]['field'] == entryIndex) {
                  entryNum = i;
                }
              }
              if (entryNum == -1 ) {
                return true;
              }
              switch(parseInt(_formData_list[entryNum]['type'])){
                //文本
                case 1:
                  html += '<li class="myMessage-form-item"><span class="data-name">'
                        + _formData_list[entryNum]['name'] + '</span><span class="data-content">'
                        + entry +'</span></li>';
                  break;
                //图片
                case 2:
                  html += '<li class="myMessage-form-item"><span class="data-name">'
                        + _formData_list[entryNum]['name'] + '</span><img class="data-img" src="'+ entry +'"></li>';
                  break;
                //富文本
                case 3:
                  html += '<li class="myMessage-form-item"><span class="data-name">'
                        + _formData_list[entryNum]['name'] + '</span><span class="data-content">富文本类型</span></li>';
                  break;
              }
              entryNum++;
            });
            $('.myMessage-detail-form .myMessage-form-list').html(html);
          }
        });
      }
    })
    var url = modifyTargetUrl({
      router: GetQueryString('router'),
      detail: 'form'
    });
    window.history.pushState(null, '', url);
    $('.myMessage-top-nav, .myMessage-content-container').hide();
    $('.myMessage-detail-form').show();
    document.title = '表单消息';
  });
  //表单页绑定事件
  $('.myMessage-detail-form .myMessage-form-confirm').on('click', function(){
    // var url = modifyTargetUrl({
    //   router: GetQueryString('router'),
    //   detail: ' '
    // });
    // window.history.replaceState(null, '', url);
    window.history.back();
    $('.myMessage-detail-form .myMessage-form-list').html();
    $('.myMessage-detail-form').hide();
    $('.myMessage-top-nav, .myMessage-content-container').show();
    document.title = '系统通知';
  });
  // 相关函数
})();

</script>

    <style rel="stylesheet">
	.communityPage-wrap{
		background-color: #eee;
		height: 100vh;
		overflow: hidden;
	}
	.communityPage-scroll{
		width: 100%;
		height: 100%;
		overflow-x: hidden;
		overflow-y: auto;
		-webkit-overflow-scrolling: touch;
	}
	.communityPage-head{
		padding: 10px 15px;
		background-color: #fff;
	}
	.communityPage-search{
		display: inline-block;
		width: 215px;
		height: 30px;
		border-radius: 4px;
		border: 1px solid #d4d4d4;
	}
	.communityPage-search-input{
		width: 175px;
    padding: 0 5px;
		height: 30px;
		border: none;
	}
	.communityPage-search-btn{
		display: inline-block;
		width: 30px;
		height: 30px;
		color: #b2b2b2;
		text-align: center;
		line-height: 30px;
	}
	.communityPage-search-btn > i{
		vertical-align: middle;
	}
	.communityPage-topic-btn ,
	.communityPage-notify-btn{
		display: inline-block;
    width: 30px;
    height: 30px;
    vertical-align: middle;
    text-align: center;
    line-height: 30px;
    font-size: 20px;
    color: #00b6f8;
    margin-left: 6px;
	}
	.communityPage-carousel{
		width: 100%;
		height: 160px;
		display: none;
	}
	.communityPage-carousel > div,
	.communityPage-carousel img{
		width: 100%;
		height: 100%;
	}
	.communityPage-main{
		background-color: #fff;
	}
	.communityPage-info{
		padding: 10px 0;
	}
	.communityPage-img{
		width: 60px;
		height: 60px;
		margin-left: 15px;
		vertical-align: bottom;
	}
	.communityPage-info > div{
		display: inline-block;
		margin-left: 10px;
		vertical-align: bottom;
	}
	.communityPage-title{
		font-size: 16px;
		color: #0e0e0e;
		margin-bottom: 5px;
	}
	.communityPage-num label{
		color: #a3a3a3;
		margin-right: 20px;
	}
	.communityPage-num span{
		color: #00b6f8;
		margin-left: 5px;
	}
	.communityPage-topic{
		border-top: 1px solid #f3f3f3;
		height: 41px;
		white-space: nowrap;
		overflow: auto;
	}
	.communityPage-topic > a{
		display: inline-block;
		width: 65px;
		color: #a3a3a3;
		text-align: center;
    line-height: 40px;
    overflow: hidden;
	}
	.communityPage-topic > a.active{
		color: #00b6f8;
		border-bottom: 1px solid #00b6f8;
	}
	.communityPage-list{
		overflow: hidden;
	}
	.communityPage-li{
		margin-top: 10px;
		background-color: #fff;
		padding: 15px;
	}
/*	.communityPage-li-cover{
		display: inline-block;
		width: 40px;
		height: 40px;
		border-radius: 20px;
		border: 1px solid #eee;
		overflow: hidden;
		vertical-align: bottom;
	}
	.communityPage-li-cover > img{
		width: 100%;
		height: 100%;
	}
	.communityPage-li-author{
		display: inline-block;
		margin-left: 10px;
		vertical-align: bottom;
	}
	.communityPage-li-name{
		color: #f2b302;
		margin-bottom: 5px;
	}
	.communityPage-li-time{
		font-size: 12px;
		color: #959595;
	}*/
	.communityPage-li-title{
		margin-top: 10px;
		font-size: 16px;
		color: #313131;
		text-overflow: ellipsis;
		overflow: hidden;
		white-space: nowrap;
	}
	.communityPage-li-content{
		font-size: 12px;
		color: #909090;
		margin-top: 5px;
		margin-bottom: 5px;
		overflow : hidden;
		/*text-overflow: ellipsis;
		display: -webkit-box;
		-webkit-line-clamp: 5;
		-webkit-box-orient: vertical;*/
	}
/*	.communityPage-li-label{
		color: #ff6c3e;
		font-size: 12px;
		float: right;
	}*/
	.communityPage-li-info{
		float: right;
		color: #a3a3a3;
		margin-left: 10px;
		position: relative;
	}
	.communityPage-li-imgul{
		margin-top: 5px;
	}
	.communityPage-li-imgli{
		display: inline-block;
		width: 90px;
		height: 90px;
		margin: 3px;
		overflow: hidden;
		vertical-align: top;
	}
	.communityPage-li-imgli-one{
		width: auto;
		height: auto;
	}
	.communityPage-li-imgli > img{
		width: 100%;
		height: 100%;
	}
	.communityPage-li-imgli-one > img{
		width: auto;
		height: auto;
		max-height: 120px;
		max-width: 290px;
	}
	.communityPage-li-info > i{
		font-size: 14px;
		margin-right: 3px;
		line-height: 20px;
		vertical-align: middle;
	}
	.communityPage-li-info > span{
		line-height: 20px;
		vertical-align: middle;
	}
	.communityPage-li-foot{
		margin-top: 10px;
		height: 20px;
	}
	.community-hot{
    display: inline-block;
    width: 16px;
    height: 16px;
    background-color: #ff6c3e;
    font-size: 12px;
    color: #fff;
    text-align: center;
    line-height: 16px;
    margin-right: 5px;
  }
  .communityPage-li-none{
  	text-align: center;
  	margin: 20px auto;
  }
  .communityPage-li-none img{
  	width: 170px;
  }
  .communityPage-li-nomore{
		padding: 15px 0;
		text-align: center;
		font-size: 12px;
		color: #949494;
	}
	.ellipsis-a{
		color: #00b6f8;
    margin-left: 8px;
	}
	.communityPage-publish-btn{
	  width: 45px;
	  height: 45px;
	  border-radius: 50%;
	  background-color: #00b6f8;
	  color: #fff;
	  text-align: center;
	  font-size: 14px;
	  line-height: 45px;
	  box-shadow: 0px 2px 6px #949494;
	  position: fixed;
	  bottom: 30px;
	  right: 15px;
	  transition: bottom 0.5s ease;
		-moz-transition: bottom 0.5s ease;
		-webkit-transition: bottom 0.5s ease;
		-o-transition: bottom 0.5s ease;
	}
	.communityPage-publish-btn.bottom{
		bottom: -50px;
	}
</style>
<div class="communityPage-wrap page" id="communityPage" style="height: 495px;">
	<div class="communityPage-scroll" id="communityPage-scroll">
	  <div class="communityPage-head"><div class="communityPage-search"><input class="communityPage-search-input" id="communityPage-search-input" maxlength="64" type="text"><span class="communityPage-search-btn"><i class="icon-search"></i></span></div><span class="communityPage-notify-btn icon-notify cmn-theme-color"></span><span class="communityPage-topic-btn icon-usercenter cmn-theme-color"></span></div>
	  <div class="communityPage-banner">
	  	<div class="communityPage-carousel" id="communityPage-carousel"></div>
	  </div>
	  <div class="communityPage-main">
	  	<div class="communityPage-info">
	  		<img class="communityPage-img" src="app_data/share_feng.jpg">
	  		<div>
	  			<p class="communityPage-title"></p>
	  			<p class="communityPage-num"><label>话题<span class="communityPage-topic-num cmn-theme-color"></span></label><label>回复<span class="communityPage-comment-num cmn-theme-color"></span></label></p>
	  		</div>
	  	</div>
	  	<div class="communityPage-topic cmn-theme-color-active" id="communityPage-topic"></div>
	  </div>
	  <div class="communityPage-list">
	  	<ul class="communityPage-ul" id="communityPage-ul">
	  	</ul>
	  </div>
  </div>
  <div class="communityPage-publish-btn cmn-theme-bgcolor" id="communityPage-publish-btn"><span>发帖</span></div>
</div>
<script type="text/javascript">
(function(){
	$("#communityPage").height( window.innerHeight );

})();

</script>

    <style rel="stylesheet">
  .communityDetail-wrap{
    height: 100vh;
  }
  .communityDetail-scroll{
    width: 100%;
    height: 100%;
    overflow-x: hidden;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
  }
  .communityDetail-main{
    margin-top: 15px;
    padding: 0 15px;
  }
  .communityDetail-cover{
    border-radius: 5px;
  }
  .communityDetail-author{
    display: inline-block;
    width: 230px;
    width: calc(100% - 57px);
    margin-left: 10px;
    vertical-align: bottom;
  }
  .communityDetail-name{
    display: inline-block;
  }
  .communityDetail-time-time{
    margin-right: 10px;
  }
  .communityDetail-title{
    margin: 10px 0;
    color: #313131;
    font-size: 16px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    vertical-align: middle;
  }
  .communityDetail-content{
    color: #909090;
    line-height: 1.5em;
    font-size: 12px;
    padding: 0 5px;
    margin-top: 10px;
  }
  .communityDetail-imgli{
    display: inline-block;
    width: 90px;
    height: 90px;
    margin: 3px;
    overflow: hidden;
    vertical-align: top;
  }
  .communityDetail-imgli-one{
    width: auto;
    height: auto;
  }
  .communityDetail-imgli > img{
    width: 100%;
    height: 100%;
  }
  .communityDetail-imgli-one > img{
    width: auto;
    height: auto;
    max-height: 120px;
    max-width: 290px;
  }
  .communityDetail-likebtn{
    width: 60px;
    height: 60px;
    border-radius: 50%;
    color: #fff;
    background-color: #00b6f8;
    text-align: center;
    margin: 20px auto;
    overflow: hidden;
  }
  .communityDetail-likebtn span{
    display: inline-block;
    font-size: 24px;
    margin-top: 9px;
  }
  .communityDetail-likebtn p{
    font-size: 12px;
    margin-top: 3px;
  }
  .communityDetail-like{
    margin: 10px 0;
  }
  .communityDetail-like > ul{
    display: inline-block;
    width: 240px;
    height: 25px;
    vertical-align: middle;
    overflow: hidden;
  }
  .communityDetail-like > span{
    font-size: 12px;
    color: #a3a3a3;
  }
  .communityDetail-like-li{
    display: inline-block;
    width: 25px;
    height: 25px;
    border-radius: 15px;
    margin-right: 5px;
    overflow: hidden;
  }
  .communityDetail-like-li > img{
    width: 100%;
    height: 100%;
  }
  .communityDetail-all-post{
    background-color: #eee;
    line-height: 40px;
    padding: 0 15px;
  }
  .communityDetail-list{
    padding-bottom: 50px;
  }
  .communityDetail-item{
    padding: 15px;
    border-bottom: 1px solid #e6e6e6;
  }
  .communityDetail-item .community-li-cover{
    width: 35px;
    height: 35px;
  }
  .communityDetail-floor{
    display: inline-block;
    width: 37px;
    text-align: center;
    color: #aaa;
    margin-top: 5px;
    vertical-align: top;
  }
  .communityDetail-item-right-top{
    float: right;
    font-size: 13px;
    color: #aaa;
    margin-top: 15px;
  }
  .communityDetail-item-content{
    display: inline-block;
    width: 243px;
    width: calc(100% - 47px);
    margin-left: 10px;
    margin-top: 5px;
    vertical-align: top;
  }

  .tail-info{
    display: inline-block;
    margin-left: 10px;
    color: #999;
    text-align: left;
    vertical-align: middle;
    position: relative;
  }
  .tail-info > i{
    margin-right: 3px;
  }
  .communityDetail-item-like span{
    max-width: 40px;
    overflow: hidden;
  }
  .communityDetail-replyto{
    color: #577a9f;
    margin-right: 5px;
  }
  .communityDetail-bottom{
    width: 100%;
    height: 50px;
    box-shadow: 0px -1px 5px #d0d0d0;
    background-color: #fff;
    position: fixed;
    bottom: 0;
    left: 0;
    z-index: 2;
  }
  .communityDetail-btn{
    width: 239px;
    height: 30px;
    font-size: 12px;
    border-radius: 15px;
    border: 1px solid #c0c0c0;
    background-color: #fff;
    margin: 9px 15px;
    text-align: left;
  }
  .communityDetail-btn > span{
    font-size: 16px;
    vertical-align: middle;
    margin-right: 5px;
    margin-left: 15px;
  }
  .communityDetail-likebtn2{
    display: inline-block;
    width: 30px;
    height: 30px;
    text-align: center;
    font-size: 20px;
    line-height: 30px;
    vertical-align: middle;
    border: 1px solid #c0c0c0;
    border-radius: 15px;
  }
  .communityDetail-li-none{
    text-align: center;
    margin: 20px auto;
  }
  .communityDetail-li-none img{
    width: 170px;
  }
  .communityDetail-li-nomore{
    padding: 15px 0;
    text-align: center;
    font-size: 12px;
    color: #949494;
  }
  .communityDetail-publish-btn{
    width: 45px;
    height: 45px;
    border-radius: 50%;
    background-color: #00b6f8;
    color: #fff;
    text-align: center;
    font-size: 12px;
    line-height: 45px;
    box-shadow: 0px 2px 6px #949494;
    position: fixed;
    bottom: 70px;
    right: 15px;
    z-index: 2;
    transition: bottom 0.5s ease;
    -moz-transition: bottom 0.5s ease;
    -webkit-transition: bottom 0.5s ease;
    -o-transition: bottom 0.5s ease;
  }
  .communityDetail-publish-btn.bottom{
    bottom: -50px;
  }
</style>
<div class="communityDetail-wrap page" id="communityDetail" style="height: 495px;">
  <div class="communityDetail-scroll" id="communityDetail-scroll">
    <div class="communityDetail-main">
      <div class="communityDetail-author-info">
        <div class="communityDetail-cover community-li-cover">
          <img class="communityDetail-head" src="app_data/share_feng.jpg">
        </div><div class="communityDetail-author community-li-author">
          <p class="communityDetail-author-p1"><span class="communityDetail-name community-li-name"></span></p>
          <p class="communityDetail-time community-li-time"><span class="communityDetail-time-time"></span> 人气 <span class="communityDetail-popularity"></span></p>
        </div>
      </div>
      <div class="communityDetail-title"></div>
      <div class="communityDetail-img"></div>
      <div class="communityDetail-content"></div>
      <div class="communityDetail-likebtn cmn-theme-bgcolor"><span class="icon-like-solid"></span><p class="communityDetail-likebtn-likecount"></p></div>
      <div class="communityDetail-like"><ul class="communityDetail-like-ul"></ul><span class="communityDetail-like-count">人赞了</span></div>
    </div>
    <div class="communityDetail-all-post">全部跟帖（0）</div>
    <div class="communityDetail-list">
      <ul class="communityDetail-ul">
      </ul>
    </div>
  </div>
  <div class="communityDetail-bottom"><button class="communityDetail-btn"><span class="icon-comment55"></span>我来说两句</button><span class="communityDetail-likebtn2 icon-like"></span></div>
  <div class="communityDetail-publish-btn cmn-theme-bgcolor" id="communityDetail-publish-btn"><span>发帖</span></div>

  <div class="pswp" id="communityDetail-pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="pswp__bg"></div>
    <div class="pswp__scroll-wrap">
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
  </div>
</div>

<script>
(function(){
  $("#communityDetail").height( window.innerHeight );

})();

</script>

    <style rel="stylesheet">
	.communityPublish-wrap{
		background-color: #eee;
	}
	.communityPublish-main{
		padding: 15px;
		background-color: #fff;
		border-bottom: 1px solid #d7d7d7;
	}
	.communityPublish-title-input{
		width: 100%;
		height: 30px;
		border: none;
		border-bottom: 1px solid #e6e6e6;
		outline: none;
	}
	.communityPublish-content-input{
		width: 100%;
		height: 100px;
		border: none;
    margin-top: 10px;
    resize: none;
    outline: none;
	}
	.communityPublish-img-wrap{
		margin-top: 5px;
	}
	.communityPublish-item, .communityPublish-item-add{
		float: left;
    width: 65px;
    height: 65px;
    position: relative;
    margin-right: 7px;
    margin-top: 10px;
	}
	.communityPublish-item > img{
		width: 100%;
		height: 100%;
	}
	.communityPublish-item-delete{
		display: block;
		width: 18px;
		height: 18px;
		text-align: center;
		line-height: 18px;
		font-size: 16px;
		color: #fff;
		border: 1px solid #fff;
		border-radius: 11px;
		background-color: #6d695d;
		position: absolute;
		top: 2px;
		right: 2px;
	}
	.communityPublish-item-add{
		text-align: center;
		line-height: 63px;
		color: #cbcbcb;
		font-size: 60px;
		border: 1px dashed #ccc;
		box-sizing: border-box;
		-webkit-box-sizing: border-box;
		overflow: hidden;
	}
	.communityPublish-tip{
		color: #a3a3a3;
		margin-top: 15px;
		font-size: 0.6em;
	}
	.communityPublish-btn{
		display: block;
		width: 90%;
		height: 35px;
		border: none;
		color: #fff;
		background-color: #00b6f8;
		margin: 0 auto;
    border-radius: 3px;
    margin-top: 20px;
	}
	.communityPublish-classify-wrap{
		margin-top: 20px;
	}
	.communityPublish-classify{
		width: 190px;
		height: 30px;
    margin-left: 10px;
    padding-left: 10px;
    border: 1px solid #ccc;
	}
</style>
<div class="communityPublish-wrap page" id="communityPublish">
	<div class="communityPublish-main">
	  <div class="communityPublish-title"><input class="communityPublish-title-input" id="communityPublish-title-input" placeholder="标题" type="text"></div>
	  <div class="communityPublish-content"><textarea class="communityPublish-content-input" id="communityPublish-content-input" placeholder="话题内容"></textarea></div>
	  <div class="communityPublish-img-wrap">
	  	<ul class="communityPublish-ul clearfix" id="communityPublish-ul">
	  		<li class="communityPublish-item-add"><span>+</span><input class="img-upload-input" accept="image/jpg,image/jpeg, image/gif, image/bmp, image/jp2, image/x-ms-bmp, image/x-png" type="file"></li>
	  	</ul>
	  	<!-- <p class="communityPublish-tip">长按图片可拖动顺序，点击图片可预览大图</p> -->
	  </div>
	  <div class="communityPublish-classify-wrap">
	  	<span>选择分类</span>
	  	<select class="communityPublish-classify" id="communityPublish-classify"><option value="" selected="selected">全部</option></select>
	  </div>
  </div>
  <div class="communityPublish-foot"><button class="communityPublish-btn cmn-theme-bgcolor">发布</button></div>
</div>
<script type="text/javascript">
(function(){
	var appId = GetQueryString('_app_id');

	$("#communityPublish").on('click', '.communityPublish-item-add' , function(event) {
	// 上传图片
		var _this = $(this);
    _this.imgUpload(function(url) {
        _this.before('<li class="communityPublish-item"><img src="'+url+'"><span class="communityPublish-item-delete">×</span></li>');
    });
  }).on('click', '.communityPublish-item-delete', function(event) {
  // 图片删除
  	$(this).closest('li').remove();
  }).on('click', '.communityPublish-btn', function(event) {
  	// 话题发布
  	var _this = $(this);

  	if(_this.hasClass('loading')){
  		return ;
  	}
  	var param = {
      app_id : appId,
      section_id : GetQueryString('detail') , //版块id
      category_id : $("#communityPublish-classify").val(), //分类id 可不传
      title : $('#communityPublish-title-input').val(),
      text : $("#communityPublish-content-input").val(),
      imgs : (function(){
        var imgarr = [];
        $.each( $("#communityPublish-ul").children('li.communityPublish-item') ,function(index, el) {
          imgarr.push($(el).children('img').attr("src"));
        });
        return imgarr;
      }()),
      // is_carousel : 0, //是否开启轮播 1为开启 0不开启
      // top_flag :  0, //是否置顶 1为置顶 0不置顶
      // hot_flag :  0 //是否精品 1是 0否
    };
    var url = '/index.php?r=AppSNS/AddArticle' ;

    if( !param.title ){
      alertTip("请填写标题");
      return;
    }
    if( !param.text ){
      alertTip("请填写话题内容");
      return;
    }
    var article_id = GetQueryString('articleId');
    if(article_id){
    	url = '/index.php?r=AppSNS/UpdateArticle';
    	param.article_id = article_id;
    }

  	_this.addClass('loading');

  	var successfn = function(data){
  		if(data.status == 0){
  			if(article_id){
  				alertTip("修改成功");
  			}else{
  				alertTip("添加成功");
  			}
  			$('#communityPublish-title-input').val('');
  			$("#communityPublish-content-input").val('');
  			$("#communityPublish-ul").children('li.communityPublish-item').remove();
  			$("#communityPublish-classify").val(0);

  			window.history.back();

  		}else if (data.status === 2){
  			alertTip('请先登录账号', function() {
  				APP.showLogin();
  			}, 700);
  		}else{
  			alertTip(data.data);
  		}
  		_this.removeClass('loading');
  	},
  	errorfn = function(data){
  		_this.removeClass('loading');
  	};

    $ajax( url , 'post', param, 'json', successfn , errorfn);

  });

})();

</script>

    <style rel="stylesheet">
	.communityReply-wrap{
		background-color: #eee;
	}
	.communityReply-main{
		width: 100%;
		background-color: #fff;
		border-bottom: 1px solid #d7d7d7;
	}
	.communityReply-text{
		width: 90%;
	    padding: 5%;
	    height: 200px;
	    resize: none;
	    outline: none;
	    border: none;
	}
	.communityReply-btn{
		display: block;
		width: 90%;
		height: 35px;
		border: none;
		color: #fff;
		background-color: #00b6f8;
		margin: 0 auto;
    border-radius: 3px;
    margin-top: 20px;
	}
</style>
<div class="communityReply-wrap page" id="communityReply">
	<div class="communityReply-main">
		<textarea class="communityReply-text" id="communityReply-text" placeholder="回复"></textarea>
	</div>
  	<div class="communityReply-foot"><button class="communityReply-btn cmn-theme-bgcolor">回复</button></div>
</div>
<script type="text/javascript">
(function(){
  var appId = GetQueryString('_app_id');
  $("#communityReply").on('click', '.communityReply-btn', function(event) {
  	// 话题发布
  	var _this = $(this);

  	if(_this.hasClass('loading')){
  		return ;
  	}
  	var param = {
      	app_id : appId ,
        section_id : GetQueryString('section_id') ,
        article_id : GetQueryString('detail') , // 话题id
        comment_id : GetQueryString('comment_id') , // 评论id 如果传这个表示是在回复
        text : $("#communityReply-text").val() ,
        imgs : ''
    };
    if( !param.text ){
      alertTip("请填写回复内容");
      return;
    }

  	_this.addClass('loading');

  	var url = '/index.php?r=AppSNS/AddComment' ,
        successfn = function(data){
            if(data.status == 0){
                alertTip("回复成功");
                $('#communityReply-text').val('');
                window.history.back();
            }else if (data.status === 2){
                alertTip('请先登录账号', function() {
                    APP.showLogin();
                }, 700);
            }else{
                alertTip(data.data);
            }
            _this.removeClass('loading');
        },
        errorfn = function(data){
            _this.removeClass('loading');
        };

    $ajax( url , 'post', param, 'json', successfn , errorfn);

  });

})();

</script>

    <style rel="stylesheet">
	.communityUsercenter-wrap{
		background-color: #eee;
		height: 100vh;
		overflow: hidden;
	}
	.communityUsercenter-head{
		height: 45px;
		color: #3a3a3a;
		background-color: #f8f8f8;
	}
	.communityUsercenter-back{
		float: left;
	    line-height: 45px;
	    margin-left: 10px;
	    width: 30px;
	    text-align: center;
	    font-size: 16px;
	}
	.communityUsercenter-tab{
		text-align: center;
	}
	.communityUsercenter-tab > a{
		display: inline-block;
		width: 80px;
		line-height: 44px;
		margin: 0 10px;
	}
	.communityUsercenter-tab > a.active{
		color: #00b6f8;
		border-bottom: 1px solid #00b6f8;
	}
	.communityUsercenter-content{
	    position: absolute;
	    top: 45px;
	    bottom: 0;
	    left: 0;
	    right: 0;
		overflow: auto;
	}
	.communityUsercenter-content > section{
		height: 100%;
	    overflow-y: auto;
	    overflow-x: hidden;
		display: none;
	}
	.communityUsercenter-content > section.active{
		display: block;
	}
	.communityUsercenter-li{
		margin-top: 10px;
		background-color: #fff;
		padding: 15px;
	}
	.communityUsercenter-myli-title{
		margin-top: 10px;
		color: #313131;
		font-size: 16px;
		text-overflow: ellipsis;
		overflow: hidden;
		white-space: nowrap;
	}
	.communityUsercenter-myli-content{
		font-size: 12px;
		color: #909090;
		margin-top: 5px;
		overflow : hidden;
		text-overflow: ellipsis;
		display: -webkit-box;
		-webkit-line-clamp: 2;
		-webkit-box-orient: vertical;
	}
	.communityUsercenter-imgli{
	    display: inline-block;
	    width: 90px;
	    height: 90px;
	    margin: 3px;
	    overflow: hidden;
	    vertical-align: top;
	}
	.communityUsercenter-imgli-one{
		width: auto;
		height: auto;
	}
	.communityUsercenter-imgli > img{
		width: 100%;
		height: 100%;
	}
	.communityUsercenter-imgli-one > img{
		width: auto;
		height: auto;
		max-height: 120px;
		max-width: 290px;
	}
	.communityUsercenter-myli-label{
		display: inline-block;
	    width: 35px;
	    height: 20px;
	    background-color: #ff6c3e;
	    font-size: 12px;
	    color: #fff;
	    text-align: center;
	    line-height: 20px;
	    border-radius: 3px;
	    float: right;
	}
	.communityUsercenter-myli-info{
		float: right;
		color: #a3a3a3;
		margin-left: 10px;
		position: relative;
	}
	.communityUsercenter-myli-info > i{
		font-size: 14px;
		margin-right: 3px;
		line-height: 20px;
	}
	.communityUsercenter-myli-foot{
		margin-top: 10px;
		height: 20px;
	}
	.communityUsercenter-myli-more{
		position: absolute;
		top : -40px;
		right: 0;
		border-radius: 5px;
		background-color: #333;
		color: #fff;
		font-size: 12px;
		white-space: nowrap;
		display: none;
	}
	.communityUsercenter-myli-more.show{
		display: block;
	}
	.communityUsercenter-myli-more:after{
		content: '';
		display: block;
		position: absolute;
		bottom: -7px;
		right: 5px;
		border-left: 5px solid transparent;
    border-right: 5px solid transparent;
    border-top: 8px solid #333;
	}
	.communityUsercenter-myli-more > span{
		display: inline-block;
		width: 50px;
		height: 30px;
		text-align: center;
		line-height: 30px;
		vertical-align: top;
	}
	.communityUsercenter-myli-more .communityUsercenter-line{
		display: inline-block;
		width: 1px;
		height: 20px;
		margin-top: 5px;
		background-color: #474747;
	}
	.communityUsercenter-more-icon{
		display: inline-block;
		width: 100%;
	}
	.communityUsercenter-reply-li-content{
		margin: 10px 0;
	}
	.communityUsercenter-reply-li-post{
		padding: 8px;
		background-color: #f4f4f4;
	}
	.communityUsercenter-reply-li-post > img{
		width: 40px;
		height: 40px;
		vertical-align: top;
		margin-right: 15px;
	}
	.communityUsercenter-reply-li-post > div{
		display: inline-block;
		font-size: 12px;
		color: #959595;
		vertical-align: top;
	}
	.communityUsercenter-li-none{
		padding: 15px 0;
		text-align: center;
		font-size: 12px;
		color: #949494;
	}
	.communityUsercenter-replyto{
		color: #577a9f;
	    margin-right: 5px;
	}
</style>
<div class="communityUsercenter-wrap page" id="communityUsercenter" style="height: 495px;">
  <div class="communityUsercenter-head">
  	<span class="communityUsercenter-back icon-leftarrow"></span>
  	<nav class="communityUsercenter-tab cmn-theme-color-active">
  		<a class="active" type="publish">发布（<span class="communityUsercenter-mytopic-count">0</span>）</a>
  		<a type="reply">回帖（<span class="communityUsercenter-myreply-count">0</span>）</a>
  	</nav>
  </div>
  <div class="communityUsercenter-content" id="communityUsercenter-content">
  	<section class="active" type="publish">
		<ul class="communityUsercenter-mytopic-ul">
		</ul>
  	</section>
  	<section type="reply">
  		<ul class="communityUsercenter-myreply-ul">
  		</ul>
  	</section>
  </div>
</div>
<script type="text/javascript">
(function(){
	$("#communityUsercenter").height( window.innerHeight );

})();

</script>

    <style rel="stylesheet">
	.communityNotify-wrap{
		background-color: #eee;
		height: 100vh;
		overflow: hidden;
	}
	.communityNotify-head{
		height: 45px;
		color: #3a3a3a;
		background-color: #f8f8f8;
	}
	.communityNotify-back{
		float: left;
	    line-height: 45px;
	    margin-left: 10px;
	    width: 30px;
	    text-align: center;
	    font-size: 16px;
	}
	.communityNotify-tab{
		text-align: center;
	}
	.communityNotify-tab > a{
		display: inline-block;
		width: 80px;
		line-height: 44px;
		margin: 0 10px;
	}
	.communityNotify-tab > a.active{
		color: #00b6f8;
		border-bottom: 1px solid #00b6f8;
	}
	.communityNotify-content{
	    position: absolute;
	    top: 45px;
	    bottom: 0;
	    left: 0;
	    right: 0;
		overflow: auto;
	}
	.communityNotify-content > section{
		height: 100%;
	    overflow-y: auto;
	    overflow-x: hidden;
		display: none;
	}
	.communityNotify-content > section.active{
		display: block;
	}
	.communityNotify-li{
		margin-top: 10px;
		background-color: #fff;
		padding: 15px;
	}
	.communityNotify-li-content{
		margin: 10px 0;
	}
	.communityNotify-li-post{
		padding: 8px;
		background-color: #f4f4f4;
	}
	.communityNotify-li-post > img{
		width: 40px;
		height: 40px;
		vertical-align: top;
		margin-right: 15px;
	}
	.communityNotify-li-post-text{
		display: inline-block;
		font-size: 12px;
		color: #959595;
		vertical-align: top;
		overflow: hidden;
		text-overflow: ellipsis;
		display: -webkit-inline-box;
    	-webkit-line-clamp: 2;
    	-webkit-box-orient: vertical;
	}
	.communityNotify-li-none{
		padding: 15px 0;
		text-align: center;
		font-size: 12px;
		color: #949494;
	}
	.communityNotify-replyto{
	    color: #577a9f;
	    margin-right: 5px;
	}
</style>
<div class="communityNotify-wrap page" id="communityNotify" style="height: 495px;">
  <div class="communityNotify-head">
  	<span class="communityNotify-back icon-leftarrow"></span>
  	<nav class="communityNotify-tab cmn-theme-color-active">
  		<a class="active" type="like">点赞</a>
  		<a type="comment">评论</a>
  	</nav>
  </div>
  <div class="communityNotify-content" id="communityNotify-content">
  	<section class="active" type="like">
		<ul class="communityNotify-like-ul">
		</ul>
  	</section>
  	<section type="comment">
  		<ul class="communityNotify-comment-ul">
  		</ul>
  	</section>
  </div>
</div>
<script type="text/javascript">
(function(){
	$("#communityNotify").height( window.innerHeight );

	$("#communityNotify").on('click' , '.communityNotify-tab > a' , function(){
		var _this = $(this),
				type  = _this.attr("type");

		_this.addClass('active').siblings().removeClass('active');
		$("#communityNotify-content").children('section[type="'+type+'"]').addClass('active').siblings().removeClass('active');
	}).on('click', '.communityNotify-back', function(event) {
		window.history.go(-1);
	});

})();

</script>

    <style rel="stylesheet">
  #vipCard {
    display: none;
    background:#ffffff;
  }
  #vipCard .card-wrap {
    height: 210px;
    padding-top:30px;
    border-bottom:1px solid #dcdcdc;
  }
  #vipCard .card-wrap .card {
    height: 180px;
    width: 84%;
    background: rgb(61, 183, 248);
    margin: 0 auto;
    overflow: hidden;
    border-radius: 10px;
    position: relative;
    background-size: 100% 100%;
  }
  #vipCard .card .logo {
    height: 50px;
    width: 50px;
    overflow: hidden;
    position: absolute;
    left: 20px;
    top: 20px;
  }
  #vipCard .card .logo img {
    height: 100%;
    width: 100%;
  }
  #vipCard .card .title {
    position: absolute;
    top: 20px;
    left: 80px;
    font-size: 18px;
    color: #fff;
  }
  #vipCard .card .level {
    position: absolute;
    top: 48px;
    left: 80px;
    color: #fff;
  }
  #vipCard .card .duration {
    position: absolute;
    bottom: 20px;
    left: 20px;
    color: #fff;
  }
  #vipCard .card-content {

  }
  #vipCard .card-content .item-title {
    position: relative;
    height: 50px;
    line-height: 50px;
    text-indent: 1em;
    border-bottom: 1px solid #dcdcdc;
    padding-left: 16px;
  }
  #vipCard .item-title .ico-moon {
    position:absolute;
    top:15px;
    right:26px;
    width:20px;
    height:20px;
    font-size:20px;
    line-height:20px;
    text-indent: 0;
    transition: transform 1s;
  }
  #vipCard .item-title.active .ico-moon {
    transform: rotate(180deg);
  }
  #vipCard .card-content .item-body {
    display: none;
    border-bottom:1px solid #dcdcdc;
  }
  #vipCard .card-content .item-body.active {
    display: block;
  }
  .vipCard-rights {
    padding:20px 0 0 20px;
  }
  .vipCard-rights .content {
    display:flex;
    flex-wrap: wrap;
    padding-bottom: 15px;
  }
  .vipCard-rights .content .item {
    display: none;
    min-height: 20px;
    font-size: 14px;
    margin-bottom: 10px;
  }
  .vipCard-rights .content .item:nth-child(odd) {
    flex: 30%;
    color: #666;
  }
  .vipCard-rights .content .item:nth-child(even) {
    flex: calc(70% - 20px);
    padding-right:20px;
  }
  .vipCard-notice {
    padding:20px 0 0 20px;
  }
  .vipCard-notice .content {
    display:flex;
    flex-wrap: wrap;
    padding-bottom: 15px;
  }
  .vipCard-notice .content .item {
    min-height: 20px;
    font-size: 14px;
    margin-bottom: 10px;
  }
  .vipCard-notice .content .item:nth-child(odd) {
    flex: 30%;
    color: #666;
  }
  .vipCard-notice .content .item:nth-child(even) {
    flex: calc(70% - 20px);
    padding-right:20px;
  }
  .vipCard-points {
    padding:20px 0 0 20px;
  }
  .vipCard-points .content {
    display:flex;
    flex-wrap:wrap;
    padding-bottom:15px;
  }
  .vipCard-points .content .item {
    min-height: 20px;
    font-size: 14px;
    margin-bottom: 10px;
  }
  .vipCard-points .content .item:nth-child(odd) {
    flex: 30%;
    color: #666;
  }
  .vipCard-points .content .item:nth-child(even) {
    flex: calc(70% - 20px);
    padding-right:20px;
  }
  .vipCard-contact {
    padding:20px 0 0 20px;
  }
  .vipCard-contact .content{
    display:flex;
    flex-wrap: wrap;
  }
  .vipCard-contact .content .item {
    min-height: 20px;
    font-size: 14px;
    margin-bottom: 10px;
  }
  .vipCard-contact .content .item:nth-child(odd) {
    flex: 30%;
    color: #666;
  }
  .vipCard-contact .content .item:nth-child(even) {
    flex: calc(70% - 20px);
    padding-right:20px;
  }
  #vipCard .yes-receive-card,
  #vipCard .no-receive-card {
    display: none;
  }
  #vipCard .no-receive-card .tip-area {
    display: block;
    padding-top: 130px;
    text-align: center;
  }
  #vipCard .no-receive-card .tip-img {
    display: block;
    width: 120px;
    height: 90px;
    margin: 0 auto 22px;
  }
  #vipCard .no-receive-card .tip-text-1 {
    display: block;
    margin-bottom: 10px;
    color: #888;
    font-size: 20px;
  }
  #vipCard .no-receive-card .tip-text-2 {
    display: block;
    color: #b2b2b2;
    font-size: 14px;
  }
</style>
<div class="page" id="vipCard">
  <div class="yes-receive-card">
    <div class="card-wrap">
      <div class="card">
        <div class="logo"><img src="app_data/nav_logo.png" alt="logo"></div>
        <div class="title"></div>
        <div class="level"></div>
        <div class="duration">
          <span>无限期</span>
        </div>
      </div>
    </div>
    <div class="card-content">
      <!--<div class="cate router" data-router="vipRi ghts">会员权益</div>
      <div class="cate router" data-router="vipMustKnow">使用须知</div>
      <div class="cate router" data-router="userScore">个人积分</div>
      <div class="cate router" data-router="contactUs">联系我们</div>-->
      <div class="card-item">
        <div class="item-title" data-item="rights">
          <span>会员权益</span>
          <label class="ico-moon icon-downarrow"></label>
        </div>
        <div class="item-body vipCard-rights">
          <div class="content">
              <div class="item freePostage">包邮</div>
              <div class="item freePostage">所有商品购买后统统包邮</div>
              <div class="item discount">打折</div>
              <div class="item discount">所有商品一律<span class="discount-num"></span>折</div>
              <div class="item coupon">优惠券</div>
              <div class="item coupon"><span class="give-coupon-str"></span>购买商品时抵用</div>
              <div class="item integral">积分</div>
              <div class="item integral">注册成功即赠送<span class="give-integral-num"></span>积分</div>
          </div>
        </div>
      </div>
      <div class="card-item">
        <div class="item-title" data-item="notice">
          <span>使用须知</span>
          <label class="ico-moon icon-downarrow"></label>
        </div>
        <div class="item-body vipCard-notice">
          <div class="content">
            <div class="item">权限说明</div>
            <div class="item">会员权限会随着会员卡等级上升而加强，相应特权请留意会员卡下方的会员权益。</div>
            <div class="item">积分说明</div>
            <div class="item">在积分商品中，100积分可以代替1元使用。</div>
            <div class="item">补充说明</div>
            <div class="item description"></div>
          </div>
        </div>
      </div>
      <div class="card-item">
        <div class="item-title" data-item="points">
          <span>个人积分</span>
          <label class="ico-moon icon-downarrow"></label>
        </div>
        <div class="item-body vipCard-points">
          <div class="content">
            <div class="item">现有积分</div>
            <div class="item current-integral-num"></div>
            <div class="item">总积分</div>
            <div class="item total-integral-num"></div>
            <div class="item">积累规则</div>
            <div class="item">消费<span class="consume-num"></span>元，获得1积分</div>
            <div class="item">使用规则</div>
            <div class="item">100积分 = 1元</div>
            <div class="item">提醒</div>
            <div class="item">消费积分并不会影响升级会员卡，与会员卡升级相关的是总积分</div>
          </div>
        </div>
      </div>
      <div class="card-item">
        <div class="item-title" data-item="contact">
          <span>联系我们</span>
          <label class="ico-moon icon-downarrow"></label>
        </div>
        <div class="item-body vipCard-contact">
          <div class="content">
            <div class="item">店铺名称</div>
            <div class="item app-name"></div>
            <div class="item">联系电话</div>
            <div class="item phone"></div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="no-receive-card">
    <div class="tip-area">
      <img class="tip-img" src="app_data/no-vip.png" alt="暂无可用会员卡">
      <p class="tip-text-1">暂无可用会员卡</p>
      <p class="tip-text-2">获取方式，可留意店家消息</p>
    </div>
  </div>
</div>
    <style rel="stylesheet">
  #couponList {
    background-color:#f6f6f6;
  }
  #couponList .tabs{
    height: 39px;
    line-height: 39px;
    text-align:center;
    background:#ffffff;
    margin-bottom: 10px;
  }
  #couponList .tabs ul {
    height: 100%;
    width: 90%;
    margin: 0 auto;
  }
  #couponList .tabs ul li{
    float:left;
    width: 25%;
    height: 38px;
  }
  #couponList .tabs .active {
    border-bottom: 1px solid #ef7830;
    color: #ef7830;
  }
  .ticket {
    position: relative;
    margin: 12px;
  }
  .ticket::before {
    content: '';
    position: absolute;
    bottom: 20px;
    left: -4px;
    width: 9px;
    height: 9px;
    border-radius: 50%;
    background-color: #f6f6f6;
    z-index: 10;
  }
  .ticket::after {
    content: '';
    position: absolute;
    bottom: 20px;
    right: -4px;
    width: 9px;
    height: 9px;
    border-radius: 50%;
    background-color: #f6f6f6;
    z-index: 10;
  }
  .ticket .top-section {
    height: 75px;
    margin: 0 auto;
    position: relative;
    overflow: hidden;
    background: #fff;
    border-top: 5px solid #ff4d64;
    border-top-left-radius: 4px;
    border-top-right-radius: 4px;
    box-shadow: 0px -5px 5px -5px rgba(0, 0, 0, 0.2),
                5px 0px 5px -5px rgba(0, 0 , 0, 0.2),
                -5px 0px 5px -5px rgba(0, 0 , 0, 0.2);
    z-index: 1;
  }
  .ticket .detail-info {
    position: absolute;
    top: 20px;
    left: 19px;
    width: calc(100% - 100px);
  }
  .ticket .detail-info .name {
    color: #333;
    font-size: 14px;
    line-height: 14px;
    margin-bottom: 10px;
  }
  .ticket .detail-info .use-condition {
    color: #666;
    font-size: 12px;
    line-height: 12px;
    overflow: hidden;
    text-overflow: ellipsis;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
  }
  .ticket .background-word-area {
    position: absolute;
    right: -32px;
    top: -40px;
    padding: 3px;
    border: 1px solid #ff4d64;
    border-radius: 50%;
    color: #fff;
    opacity: 0.1;
  }
  .ticket .background-circle {
    width: 80px;
    height: 80px;
    line-height: 80px;
    background-color:#ff4d64;
    border-radius:50%;
  }
  .ticket .background-word {
    position:absolute;
    bottom: 18px;
    left: 20px;
    font-size: 24px;
    line-height: 24px;
  }
  .ticket .function-btn {
    position: absolute;
    top: 35px;
    right: 18px;
    font-size: 12px;
    width: 60px;
    height: 20px;
    line-height: 20px;
    text-align: center;
    background-color: #ff4d64;
    border-radius: 6px;
    color:#fff;
  }
  .ticket .top-section .right {
    float: left;
  }
  .ticket .bottom-section {
    position: relative;
    margin: 0 auto;
    height: 25px;
    line-height: 25px;
    text-indent: 1em;
    background: #fff;
    font-size: 12px;
    color: #999;
    border-bottom-left-radius: 4px;
    border-bottom-right-radius: 4px;
    white-space: nowrap;
  }
  .ticket .bottom-section > div {
    overflow: hidden;
    text-overflow: ellipsis;
  }
  .ticket .bottom-section::before {
    content: '';
    position: absolute;
    top: 0;
    left: 4px;
    width: calc(100% - 10px);
    border-top: 1px dashed #dbdbdb;
  }
  .ticket .bottom-section::after {
    content: '';
    position: absolute;
    left: 0;
    bottom: 0;
    width: 100%;
    height: 25px;
    border-bottom-left-radius: 4px;
    border-bottom-right-radius: 4px;
    box-shadow: 0px 0px 5px 0px rgba(0, 0 , 0, 0.2);
  }
  .ticket.expired .top-section {
    border-color: #ccc!important;
  }
  .ticket.expired .background-word-area {
    border-color: #ccc!important;
  }
  .ticket.expired .background-circle {
    background-color: #ccc!important;
  }
  .ticket.expired .function-btn {
    background-color: #ccc!important;
  }
  .goto-coupon-list {
    padding: 10px 0 20px;
    color: #ccc;
    text-align: center;
    font-size: 13px;
  }
  /*弹窗*/
  .zc-toast-bg {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    display: none;
    background: rgba(1,1,1,0.5);
    z-index: 999;
  }
  .zc-toast-bg.show {
    display: block;
  }
  .zc-toast {
    position: absolute;
    top: 50%;
    left: 50%;
    margin-left: -80px;
    margin-top: -75px;
    width: 160px;
    height: 65px;
    background: #fff;
    border-radius: 5px;
  }
  .zc-toast .icon {
    position: absolute;
    top: 18px;
    left: 45px;
  }
  .zc-toast .title {
    position: absolute;
    top: 15px;
    left: 60px;
    height: 16px;
    line-height: 15px;
    color: #333;
    font-size: 15px;
  }
  .zc-toast .content {
    position: absolute;
    top: 38px;
    left: 0;
    width: 100%;
    height: 12px;
    line-height: 12px;
    color: #666;
    font-size: 12px;
    text-align: center;
  }
  .zc-toast .icon-gou {
    font-size: 14px;
    background: #55b737;
    position: absolute;
    top: 12px;
    left: 35px;
    width: 20px;
    height: 20px;
    line-height: 20px;
    text-align: center;
    border-radius: 50%;
    color: #fff;
  }
</style>
<div class="page" id="couponList">
  <div class="tabs">
    <ul>
      <li class="active" data-type="-1">全部</li>
      <li data-type="1">未使用</li>
      <li data-type="2">已使用</li>
      <li data-type="3">已失效</li>
    </ul>
  </div>
  <div class="ticket-list">

  </div>
  <div class="zc-toast-bg recharge-success">
    <div class="zc-toast">
      <div class="icon-gou"></div>
      <div class="title">充值成功!</div>
      <div class="content">请到储值金中查看</div>
    </div>
  </div>
</div>
<script>
  (function(){
    $("#couponList").on('click', '.tabs li', function(){
      var type = $(this).attr('data-type');
      $(this).siblings().removeClass("active");
      $(this).addClass("active");
      $('#couponList .ticket-list').html('');
      $.ajax({
        url: '/index.php?r=AppShop/getMyCoupons',
        type: 'get',
        data: {
          app_id: GetQueryString('_app_id'),
          sub_shop_app_id:GetQueryString('franchisee'),
          type: type
        },
        dataType: 'json',
        success: function(res){
          var couponListHtml = '';
          for(var i = 0; i < res.data.length; i++){
            var coupon = res.data[i];
            var conditionText = '';
            var backgroundWord = '';
            var functionBtnHtml = '';
            switch(parseInt(coupon.type)){
              case 0:
                conditionText = '满' + coupon.condition + '元，减' + coupon.value + '元';
                backgroundWord = '满';
                break;
              case 1:
                conditionText = '打' + coupon.value + '折';
                backgroundWord = '折';
                break;
              case 2:
                conditionText = '可抵扣' + coupon.value + '元';
                backgroundWord = '代';
                break;
              case 3:
                if(coupon.extra_condition == ''){
                  conditionText = '直接兑换' + coupon.coupon_goods_info.title;
                } else if(coupon.extra_condition.price){
                  conditionText = '消费满' + coupon.extra_condition.price + '可兑换' + coupon.coupon_goods_info.title;
                } else if(coupon.extra_condition.goods_id){
                  conditionText = '购买' + coupon.condition_goods_info.title + '可兑换' + coupon.coupon_goods_info.title;
                }
                backgroundWord = '兑';
                break;
              case 4:
                conditionText = '储值金' + coupon.value + '元';
                backgroundWord = '储';
                break;
              case 5:
                conditionText = coupon.extra_condition;
                backgroundWord = '通';
                break;
              default:
                break;
            }
            switch(parseInt(coupon.status)){
              case 1:
                if(coupon.type == 0 || coupon.type == 1 || coupon.type == 2){
                  functionBtnHtml = '<div class="function-btn" style="background-color:'+ coupon.list_color +'" >立即买单</div>'; // 跳当面付
                } else if(coupon.type == 3){
                  functionBtnHtml = ''; // 兑换券无跳转
                } else if(coupon.type == 4){
                  functionBtnHtml = '<div class="function-btn" style="background-color:'+ coupon.list_color +'"  >立即充值</div>'; // 储值券直接充值
                } else if(coupon.type == 5){
                  functionBtnHtml = '<div class="function-btn" style="background-color:'+ coupon.list_color +'"  >立即使用</div>'; // 跳详情
                }
                break;
              case 2:
                functionBtnHtml = '<div class="function-btn" >已使用</div>';
                break;
              case 3:
                functionBtnHtml = '<div class="function-btn" >已失效</div>';
                break;
            }
            couponListHtml += '<div class="ticket '+ (coupon['status'] == 1 ? '': 'expired') +'" data-user-coupon-id="'+ coupon.id +'"><div class="top-section"  style="border-color:'+ coupon.list_color +'"  >'
                            + '<div class="detail-info"><div class="name">'+ coupon['title'] +'</div>'
                            + '<div class="use-condition">使用条件：'+ conditionText +'</span></div></div>'
                            + '<div class="background-word-area" style="border-color:'+ coupon.list_color +'" ><div class="background-circle" style="background-color:'+ coupon.list_color +'" ></div><div class="background-word">' + backgroundWord + '</div></div>'
                            + functionBtnHtml + '</div>'
                            + '<div class="bottom-section"><div>有效期 '
                            + coupon.start_use_date + '至' + coupon.end_use_date
                            + ( coupon.exclude_holiday == 0 ? '' : '除去法定节假日' )
                            + ( coupon.exclude_weekend == 0 ? '' : '除去周末' ) +'</div></div></div>';
          }
          $('#couponList .ticket-list').html(couponListHtml);
        }
      })
    }).on('click', '.function-btn', function(){
      var $coupon = $(this).closest('.ticket');
      if($coupon.hasClass('expired')){
        return false;
      }
      var userCouponId = $coupon.attr('data-user-coupon-id');
      var couponType = $coupon.attr('data-type');
      if(couponType == 0 || couponType == 1 || couponType == 2){
        APP.turnToPage({
          router: 'transferPay'
        });
      } else if(couponType == 4){
        $.ajax({
          url: '/index.php?r=AppShop/useCoupon',
          type: 'get',
          data: {
            app_id: GetQueryString('_app_id'),
            user_coupon_id: userCouponId
          },
          dataType: 'json',
          success: function(res){
            if(res.status != 0){
              return false;
            }
            $('#couponList .zc-toast-bg.recharge-success').show();
            setTimeout(function(){
              $('#couponList .zc-toast-bg.recharge-success').hide();
            }, 3000);
            $coupon.addClass('expired');
          }
        });
      } else if(couponType == 5){
        APP.turnToPage({
          router: 'couponDetail',
          detail: userCouponId,
          couponStatus: 'use'
        });
      }
      event.stopPropagation();
    }).on('click', '.ticket', function(event){
      var userCouponId = $(this).attr('data-user-coupon-id');
      APP.turnToPage({
        router: 'couponDetail',
        detail: userCouponId,
        couponStatus: 'use'
      });
    }).on('click', '.zc-toast-bg.recharge-success', function(event){
      $('#couponList .zc-toast-bg.recharge-success').hide();
    });
  })();
</script>

    <style rel="stylesheet">
  #couponDetail {
    height: 100%;
    background-color: #edeeef;
  }
  #couponDetail .coupon-detail-wrap {
    margin: 15px 10px 0;
  }
  #couponDetail .coupon-detail-wrap .top-section {
    position: relative;
    width: 100%;
    height: 45px;
    background: #fff;
    background: radial-gradient(circle at bottom left, transparent 5px, #fff 0) bottom left,
                radial-gradient(circle at bottom right, transparent 5px, #fff 0) bottom right;
    background-size: 50% 100%;
    background-repeat: no-repeat;
    border-top-left-radius: 4px;
    border-top-right-radius: 4px;
    color: #8a8b8c;
    box-shadow: 0px -5px 5px -5px rgba(0, 0, 0, 0.2),
                5px 0px 5px -5px rgba(0, 0 , 0, 0.2),
                -5px 0px 5px -5px rgba(0, 0 , 0, 0.2);
  }
  #couponDetail .coupon-detail-wrap .top-section::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 5px;
    width: calc(100% - 10px);
    border-bottom: 1px dashed #a3a3a3;
  }
  #couponDetail .coupon-detail-wrap .top-section .logo {
    position: absolute;
    top: 10px;
    left: 20px;
    width: 25px;
    height: 25px;
    border-radius: 50%;
  }
  #couponDetail .coupon-detail-wrap .top-section .name {
    position: absolute;
    top: 5px;
    left: 55px;
    height: 35px;
    line-height: 35px;
    font-size: 13px;
  }
  #couponDetail .coupon-detail-wrap .top-section .share {
    position: absolute;
    top: 11px;
    right: 15px;
    color: #000;
    font-size: 20px;
    line-height: 1em;
  }
  #couponDetail .coupon-detail-wrap .middle-section {
    position: relative;
    background: #fff;
    background: radial-gradient(circle at top left, transparent 5px, #fff 0) top left,
                radial-gradient(circle at top right, transparent 5px, #fff 0) top right;
    background-size: 50% 100%;
    background-repeat: no-repeat;
    box-shadow: 5px 0px 5px -5px rgba(0, 0 , 0, 0.2), -5px 0px 5px -5px rgba(0, 0 , 0, 0.2);
  }
  #couponDetail .coupon-detail-wrap .middle-section .qrcode {
    position: absolute;
    top: 30px;
    right: 18px;
    color: #8a8b8c;
    font-size: 20px;
    line-height: 20px;
  }
  #couponDetail .coupon-detail-wrap .middle-section .title {
    padding-top: 24px;
    line-height: 24px;
    font-size: 24px;
    text-align: center;
    font-weight: 400;
  }
  #couponDetail .coupon-detail-wrap .middle-section .sub-title {
    margin-top: 12px;
    line-height: 15px;
    font-size: 15px;
    text-align: center;
  }
  #couponDetail .coupon-detail-wrap .middle-section .function-btn {
    margin: 18px auto;
    width: 145px;
    height: 30px;
    line-height: 30px;
    background: #fd445b;
    border-radius: 4px;
    font-size: 15px;
    text-align: center;
    color: #fff;
  }
  #couponDetail .coupon-detail-wrap .middle-section .detail-item {
    margin: 0 20px;
    padding-bottom: 13px;
    line-height: 16px;
    font-size: 13px;
  }
  #couponDetail .coupon-detail-wrap .middle-section .detail-item .item-name {
    display: inline-block;
    vertical-align: top;
  }
  #couponDetail .coupon-detail-wrap .middle-section .detail-item .item-content {
    display: inline-block;
    color: #8a8b8c;
    width: calc(100% - 70px);
    vertical-align: top;
  }
  #couponDetail .coupon-detail-wrap .middle-section .detail-item.time .item-content {
    line-height: 20px;
  }
  #couponDetail .coupon-detail-wrap .middle-section .detail-item.time .item-content > div  {
    display: inline-block;
  }
  #couponDetail .coupon-detail-wrap .middle-section .detail-item.address {
    display: none;
  }
  #couponDetail .coupon-detail-wrap .middle-section .detail-item.phone {
    display: none;
  }
  #couponDetail .coupon-detail-wrap .bottom-section {
    background-color: #fff;
    border-bottom-left-radius: 4px;
    border-bottom-right-radius: 4px;
    border-top: 1px dashed #a3a3a3;
    box-shadow: 0px 0px 5px 0px rgba(0, 0 , 0, 0.2);
  }
  #couponDetail .coupon-detail-wrap .bottom-section .detail-item {
    display: none;
    margin: 0 20px;
    padding: 12px 0;
    border-bottom: 1px solid #eaebec;
    line-height: 16px;
    font-size: 13px;
  }
  #couponDetail .coupon-detail-wrap .bottom-section .detail-item .item-name {
    display: inline-block;
    vertical-align: top;
  }
  #couponDetail .coupon-detail-wrap .bottom-section .detail-item .item-content {
    display: inline-block;
    width: calc(100% - 70px);
    color: #8a8b8c;
    vertical-align: top;
  }
  #couponDetail .coupon-detail-wrap .bottom-section .goto-homepage {
    position: relative;
    padding: 15px 20px;
    line-height: 13px;
    font-size: 13px;
  }
  #couponDetail .coupon-detail-wrap .bottom-section .goto-homepage .icon-rightarrow {
    position: absolute;
    top: 15px;
    right: 20px;
    color: #8a8b8c;
  }
  #couponDetail .coupon-detail-wrap .middle-section .function-btn.disabled {
    background: #ddd!important;
  }
  #couponDetail .zc-toast-bg {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    display: none;
    background: rgba(1,1,1,0.5);
    z-index: 999;
  }
  #couponDetail .zc-toast-bg.show {
    display: block;
  }
  #couponDetail .zc-toast {
    position: absolute;
    top: 50%;
    left: 50%;
    margin-left: -80px;
    margin-top: -75px;
    width: 160px;
    height: 65px;
    background: #fff;
    border-radius: 5px;
  }
  #couponDetail .zc-toast .icon {
    position: absolute;
    top: 18px;
    left: 45px;
  }
  #couponDetail .zc-toast .title {
    position: absolute;
    top: 15px;
    left: 60px;
    height: 16px;
    line-height: 15px;
    color: #333;
    font-size: 15px;
  }
  #couponDetail .zc-toast .content {
    position: absolute;
    top: 38px;
    left: 0;
    width: 100%;
    height: 12px;
    line-height: 12px;
    color: #666;
    font-size: 12px;
    text-align: center;
  }
  #couponDetail .zc-toast .icon-gou {
    font-size: 14px;
    background: #55b737;
    position: absolute;
    top: 12px;
    left: 35px;
    width: 20px;
    height: 20px;
    line-height: 20px;
    text-align: center;
    border-radius: 50%;
    color: #fff;
  }
  .coupon-verify-wrap {
    display: none;
    margin: 25px 14px 0;
  }
  .coupon-verify-wrap.show {
    display: block;
  }
  .coupon-verify-wrap .top-section {
    position: relative;
    width: 100%;
    height: 150px;
    background: #fff;
    border-top-left-radius: 4px;
    border-top-right-radius: 4px;
    color: #8b8b8b;
    box-shadow: 0px -5px 5px -5px rgba(0, 0, 0, 0.2),
                5px 0px 5px -5px rgba(0, 0 , 0, 0.2),
                -5px 0px 5px -5px rgba(0, 0 , 0, 0.2);
  }
  .coupon-verify-wrap .top-section .cancel {
    position: absolute;
    top: 20px;
    left: 25px;
    color: #333;
  }
  .coupon-verify-wrap .top-section .name {
    padding-top: 60px;
    text-align: center;
    color: #666;
    font-size: 15px;
  }
  .coupon-verify-wrap .top-section .title {
    text-align: center;
    color: #333;
    font-size: 28px;
  }
  .coupon-verify-wrap .division-line {
    position: relative;
    width: 100%;
    border-top: 1px dotted #dbdbdb;
  }
  .coupon-verify-wrap .division-line .left-circle{
    position:absolute;
    top:-5px;
    left:-5px;
    width:10px;
    height:10px;
    border-radius:50%;
    background:#eee;
  }
  .coupon-verify-wrap .division-line .right-circle{
    position:absolute;
    top:-5px;
    right:-5px;
    width:10px;
    height:10px;
    border-radius:50%;
    background:#eee;
  }
  .coupon-verify-wrap .bottom-section {
    background: #fff;
    box-shadow: 5px 0px 5px -5px rgba(0, 0 , 0, 0.2), -5px 0px 5px -5px rgba(0, 0 , 0, 0.2);
    border-bottom-left-radius: 4px;
    border-bottom-right-radius: 4px;
    z-index: 1;
    text-align: center;
  }
  .coupon-verify-wrap .bottom-section::after {
    content:'';
    position:absolute;
    bottom:0;
    width:100%;
    height:22px;
    border-bottom-left-radius:4px;
    border-bottom-right-radius:4px;
    box-shadow:0px 0px 5px 0px rgba(0, 0 , 0, 0.2);
    z-index:-1;
  }
  .coupon-verify-wrap .bottom-section .verify-block {
    height: 260px;
  }
  .coupon-verify-wrap .bottom-section .success-block {
    height: 150px;
  }
  .coupon-verify-wrap .bottom-section .qrcode {
    display: inline-block;
    width: 150px;
    height: 150px;
    padding-top: 15px;
  }
  .coupon-verify-wrap .bottom-section .code {
    margin-top: 5px;
    color: #333;
    font-size: 15px;
    height: 15px;
    line-height: 15px;
  }
  .coupon-verify-wrap .bottom-section .tip {
    margin-top: 5px;
    font-size: 12px;
    color: #666;
  }
  .coupon-verify-wrap .bottom-section .success-tip {
    padding-top: 40px;
  }
  .coupon-verify-wrap .bottom-section .icon-gou {
    display: inline-block;
    background: #55b737;
    width: 20px;
    height: 20px;
    line-height: 20px;
    text-align: center;
    border-radius: 50%;
    color: #fff;
    font-size: 13px;
  }
  .coupon-verify-wrap .bottom-section .success-tip-text {
    display: inline-block;
    height: 24px;
    line-height: 24px;
    font-size: 17px;
    margin-left: 5px;
    vertical-align: middle;
  }
  .coupon-verify-wrap .bottom-section .back-tip {
    margin-top: 15px;
    font-size: 12px;
    color:#666;
  }
</style>
<div class="page" id="couponDetail">
  <div class="coupon-detail-wrap">
    <div class="top-section">
      <img class="logo" src="app.htm" alt="">
      <div class="name"></div>
    </div>
    <div class="middle-section">
      <div class="title"></div>
      <div class="sub-title"></div>
      <div class="function-btn"></div>
      <div class="icon-qrcode-new qrcode show-coupon-verify"></div>
      <div class="detail-item condition">
        <div class="item-name">使用条件：</div>
        <div class="item-content"></div>
      </div>
      <div class="detail-item time">
        <div class="item-name">可用时间：</div>
        <div class="item-content">
          <div class="date-duration"></div>
          <div class="other-case"></div>
          <div class="time-duration"></div>
        </div>
      </div>
    </div>
    <div class="bottom-section">
      <div class="detail-item address">
        <div class="item-name">店铺地址：</div>
        <div class="item-content"></div>
      </div>
      <div class="detail-item phone">
        <div class="item-name">联系电话：</div>
        <div class="item-content"></div>
      </div>
      <div class="goto-homepage">
        <div class="goto-homepage-text">返回首页</div>
        <div class="icon-rightarrow"></div>
      </div>
    </div>
  </div>
  <div class="zc-toast-bg receive-success">
    <div class="zc-toast">
      <div class="icon-gou"></div>
      <div class="title">领取成功!</div>
      <div class="content">已领<span class="recv-count"></span>张，限领<span class="limit-num"></span>张</div>
    </div>
  </div>
  <div class="zc-toast-bg recharge-success">
    <div class="zc-toast">
      <div class="icon-gou"></div>
      <div class="title">充值成功!</div>
      <div class="content">请到储值金中查看</div>
    </div>
  </div>
  <div class="coupon-verify-wrap">
    <div class="top-section">
      <div class="cancel hide-coupon-verify">取消</div>
      <div class="name"></div>
      <div class="title"></div>
    </div>
    <div class="division-line">
      <div class="left-circle"></div>
      <div class="right-circle"></div>
    </div>
    <div class="bottom-section">
      <div class="verify-block">
        <img class="qrcode" src="app.htm">
        <div class="code">核销码：<span class="verify-code-text"></span></div>
        <div class="tip">提示：请提示商家扫码核销</div>
      </div>
      <div class="success-block" style="display: none;">
        <div class="success-tip">
          <div class="icon-gou"></div>
          <div class="success-tip-text">核销成功!</div>
        </div>
        <div class="back-tip hide-coupon-verify">&gt;&gt;&gt;返回</div>
      </div>
    </div>
  </div>
</div>
<script>
  function receiveCoupon(){
    $.ajax({
      type: "GET",
      url: "/index.php?r=AppShop/RecvCoupon",
      data: {
        app_id: GetQueryString('_app_id'),
        sub_app_id : GetQueryString('sub_id'),
        coupon_id: GetQueryString('detail'),
      },
      contentType: "application/json; charset=utf-8",
      dataType: "json",
      success: function (data) {
        if (data.status !== 0) {
          if (data.data === 2) {
            alertTip('请先登录账号', function() {
              APP.showLogin();
            }, 700);
          } else {
            alertTip(data.data);
          }
          return;
        } else if(data.status == 0) {
          $("#couponDetail .function-btn").css("background","#ddd");
          $("#couponDetail .function-btn").attr("onclick","");
        }
      },
      error: function (msg) {
        console.log(msg);
      }
    });
  }
  (function(){
    $('#couponDetail').on('click', '.function-btn', function(){
      if($(this).hasClass('disabled')){
        return false;
      }
      var $btn = $(this);
      var couponStatus = GetQueryString('couponStatus') || 'receive';
      var couponType = $(this).attr('data-type');
      if(couponStatus == 'receive'){
        $.ajax({
          url: "/index.php?r=AppShop/RecvCoupon",
          type: "get",
          data: {
            app_id: GetQueryString('_app_id'),
            sub_app_id : GetQueryString('sub_id'),
            coupon_id: GetQueryString('detail'),
          },
          contentType: "application/json; charset=utf-8",
          dataType: "json",
          success: function (res) {
            if (res.status !== 0) {
              if (res.data === 2) {
                alertTip('请先登录账号', function() {
                  APP.showLogin();
                }, 700);
              } else {
                alertTip(res.data);
              }
              return;
            } else if(res.status == 0) {
              $('#couponDetail .zc-toast-bg.receive-success .recv-count').text(res.data.recv_count);
              $('#couponDetail .zc-toast-bg.receive-success .limit-num').text(res.data.limit_num);
              $('#couponDetail .zc-toast-bg.receive-success').show();
              setTimeout(function(){
                $('#couponDetail .zc-toast-bg.receive-success').hide();
              }, 3000);
              if(res.data.is_already_recv == 1){
                $("#couponDetail .function-btn").addClass('disabled').html("已领取");
              }
            }
          },
          error: function (msg) {
            console.log(msg);
          }
        });
      } else if(couponStatus == 'use'){
        if(couponType == 0 || couponType == 1 || couponType == 2){
          APP.turnToPage({
            router: 'transferPay'
          });
        } else if(couponType == 4){
          $.ajax({
            url: '/index.php?r=AppShop/useCoupon',
            type: 'get',
            data: {
              app_id: GetQueryString('_app_id'),
              user_coupon_id: GetQueryString('detail')
            },
            dataType: 'json',
            success: function(res){
              if(res.status != 0){
                return false;
              }
              $('#couponDetail .zc-toast-bg.recharge-success').show();
              setTimeout(function(){
                $('#couponDetail .zc-toast-bg.recharge-success').hide();
              }, 3000);
              $btn.addClass('disabled');
            }
          });
        }
      }
    }).on('click', '.goto-homepage', function(){
      // 进入应用
      window.location.href = '/app?_app_id='+GetQueryString('_app_id');
    }).on('click', '.show-coupon-verify', function(){
      $('#couponDetail .coupon-detail-wrap').hide();
      $('#couponDetail .coupon-verify-wrap').show();
    }).on('click', '.hide-coupon-verify', function(){
      $('#couponDetail .coupon-verify-wrap').hide();
      $('#couponDetail .coupon-detail-wrap').show();
    });
  })();
</script>
    <style rel="stylesheet">
  #couponReceiveListPage {
    display: none;
    background-color: #f6f6f6;
  }
  #couponReceiveListPage .ticket {
    position: relative;
    margin: 12px;
  }
  #couponReceiveListPage .ticket::before {
    content: '';
    position: absolute;
    bottom: 20px;
    left: -4px;
    width: 9px;
    height: 9px;
    border-radius: 50%;
    background-color: #f6f6f6;
    z-index: 10;
  }
  #couponReceiveListPage .ticket::after {
    content: '';
    position: absolute;
    bottom: 20px;
    right: -4px;
    width: 9px;
    height: 9px;
    border-radius: 50%;
    background-color: #f6f6f6;
    z-index: 10;
  }
  #couponReceiveListPage .ticket .top-section {
    height: 75px;
    margin: 0 auto;
    position: relative;
    overflow: hidden;
    background: #fff;
    border-top: 5px solid #ff4d64;
    border-top-left-radius: 4px;
    border-top-right-radius: 4px;
    box-shadow: 0px -5px 5px -5px rgba(0, 0, 0, 0.2),
                5px 0px 5px -5px rgba(0, 0 , 0, 0.2),
                -5px 0px 5px -5px rgba(0, 0 , 0, 0.2);
    z-index: 1;
  }
  #couponReceiveListPage .ticket .detail-info {
    position: absolute;
    top: 20px;
    left: 19px;
    width: calc(100% - 100px);
  }
  #couponReceiveListPage .ticket .detail-info .name {
    color: #333;
    font-size: 14px;
    line-height: 14px;
    margin-bottom: 10px;
  }
  #couponReceiveListPage .ticket .detail-info .use-condition {
    color: #666;
    font-size: 12px;
    line-height: 12px;
    overflow: hidden;
    text-overflow: ellipsis;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
  }
  #couponReceiveListPage .ticket .background-word-area {
    position: absolute;
    right: -32px;
    top: -40px;
    padding: 3px;
    border: 1px solid #ff4d64;
    border-radius: 50%;
    color: #fff;
    opacity: 0.1;
  }
  #couponReceiveListPage .ticket .background-circle {
    width: 80px;
    height: 80px;
    line-height: 80px;
    background-color:#ff4d64;
    border-radius:50%;
  }
  #couponReceiveListPage .ticket .background-word {
    position:absolute;
    bottom: 18px;
    left: 20px;
    font-size: 24px;
    line-height: 24px;
  }
  #couponReceiveListPage .ticket .function-btn {
    position: absolute;
    top: 35px;
    right: 18px;
    font-size: 12px;
    width: 60px;
    height: 20px;
    line-height: 20px;
    text-align: center;
    background-color: #ff4d64;
    border-radius: 6px;
    color:#fff;
  }
  #couponReceiveListPage .ticket .top-section .right {
    float: left;
  }
  #couponReceiveListPage .ticket .bottom-section {
    position: relative;
    margin: 0 auto;
    height: 25px;
    line-height: 25px;
    text-indent: 1em;
    background: #fff;
    font-size: 12px;
    color: #999;
    border-bottom-left-radius: 4px;
    border-bottom-right-radius: 4px;
    white-space: nowrap;
  }
  #couponReceiveListPage .ticket .bottom-section > div {
    overflow: hidden;
    text-overflow: ellipsis;
  }
  #couponReceiveListPage .ticket .bottom-section::before {
    content: '';
    position: absolute;
    top: 0;
    left: 4px;
    width: calc(100% - 10px);
    border-top: 1px dashed #dbdbdb;
  }
  #couponReceiveListPage .ticket .bottom-section::after {
    content: '';
    position: absolute;
    left: 0;
    bottom: 0;
    width: 100%;
    height: 25px;
    border-bottom-left-radius: 4px;
    border-bottom-right-radius: 4px;
    box-shadow: 0px 0px 5px 0px rgba(0, 0 , 0, 0.2);
  }
  #couponReceiveListPage .ticket.has-receive .top-section {
    border-color: #ccc!important;
  }
  #couponReceiveListPage .ticket.has-receive .background-word-area {
    border-color: #ccc!important;
  }
  #couponReceiveListPage .ticket.has-receive .background-circle {
    background-color: #ccc!important;
  }
  #couponReceiveListPage .ticket.has-receive .function-btn {
    background-color: #ccc!important;
  }
  #couponReceiveListPage .goto-coupon-list {
    padding: 10px 0 20px;
    color: #ccc;
    text-align: center;
    font-size: 13px;
  }
  /*弹窗*/
  #couponReceiveListPage .zc-toast-bg {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    display: none;
    background: rgba(1,1,1,0.5);
    z-index: 999;
  }
  #couponReceiveListPage .zc-toast-bg.show {
    display: block;
  }
  #couponReceiveListPage .zc-toast {
    position: absolute;
    top: 50%;
    left: 50%;
    margin-left: -80px;
    margin-top: -75px;
    width: 160px;
    height: 65px;
    background: #fff;
    border-radius: 5px;
  }
  #couponReceiveListPage .zc-toast .icon {
    position: absolute;
    top: 18px;
    left: 45px;
  }
  #couponReceiveListPage .zc-toast .title {
    position: absolute;
    top: 15px;
    left: 60px;
    height: 16px;
    line-height: 15px;
    color: #333;
    font-size: 15px;
  }
  #couponReceiveListPage .zc-toast .content {
    position: absolute;
    top: 38px;
    left: 0;
    width: 100%;
    height: 12px;
    line-height: 12px;
    color: #666;
    font-size: 12px;
    text-align: center;
  }
  #couponReceiveListPage .zc-toast .icon-gou {
    font-size: 14px;
    background: #55b737;
    position: absolute;
    top: 12px;
    left: 35px;
    width: 20px;
    height: 20px;
    line-height: 20px;
    text-align: center;
    border-radius: 50%;
    color: #fff;
  }
</style>
<div id="couponReceiveListPage" class="page coupon-receive-list-page">
  <div class="ticket-list">
    <!--<div class="ticket has-receive" catchtap="gotoCouponDetail" data-coupon-id="">
      <div class="top-section" >
        <div class="detail-info">
          <div class="name">满减券</div>
          <div class="use-condition">使用条件：<span class="use-condition"></span></div>
        </div>
        <div class="background-word-area">
          <div class="background-circle"></div>
          <div class="background-word">减</div>
        </div>
        <div class="function-btn" data-coupon-id="">已领取</div>
      </div>
      <div class="bottom-section">
        <div></div>
      </div>
    </div>-->
  </div>
  <div class="goto-coupon-list">
    <div catchtap="gotoCouponList">查看我的优惠券&gt;&gt;&gt;</div>
  </div>
  <div class="zc-toast-bg receive-success">
    <div class="zc-toast">
      <div class="icon-gou"></div>
      <div class="title">领取成功!</div>
      <div class="content">已领<span class="recv-count"></span>张，限领<span class="limit-num"></span>张</div>
    </div>
  </div>
</div>
<script>
  (function(){
    $('#couponReceiveListPage').on('click', '.function-btn', function(event){
      var $coupon = $(this).closest('.ticket');
      if($coupon.hasClass('has-receive')){
        return false;
      }
      var couponId = $coupon.attr('data-coupon-id');
      $.ajax({
        url: '/index.php?r=AppShop/recvCoupon',
        type: 'get',
        data: {
          app_id: GetQueryString('_app_id'),
          coupon_id: couponId
        },
        dataType: 'json',
        success: function(res){
          if(res.status != 0){
            return false;
          }
          $('#couponReceiveListPage .zc-toast-bg.receive-success .recv-count').text(res.data.recv_count);
          $('#couponReceiveListPage .zc-toast-bg.receive-success .limit-num').text(res.data.limit_num);
          $('#couponReceiveListPage .zc-toast-bg.receive-success').show();
          setTimeout(function(){
            $('#couponReceiveListPage .zc-toast-bg.receive-success').hide();
          }, 3000);
          if(res.data.is_already_recv == 1){
            $coupon.addClass('has-receive');
            $coupon.find('.function-btn').html('已领取');
          }
        }
      });
      event.stopPropagation();
    }).on('click', '.ticket', function(event){
      var couponId = $(this).attr('data-coupon-id');
      APP.turnToPage({
        router: 'couponDetail',
        detail: couponId,
        couponStatus: 'receive'
      });
    }).on('click', '.goto-coupon-list', function(){
      APP.turnToPage({
        router: 'couponList'
      });
    }).on('click', '.zc-toast-bg.receive-success', function(event){
      $('#couponReceiveListPage .zc-toast-bg.receive-success').hide();
    });
  })();
</script>
    <style rel="stylesheet">
#myIntegral {
  min-height: 100vh;
  background-color: #eeeeee;
}
#myIntegral .myIntegral-content {
  height: 100vh;
  overflow: auto;
}
#myIntegral .integral-detail {
  position: relative;
  background: #5db968;
  height: 125px;
  margin-bottom: 10px;
  color: #fff;
}
#myIntegral .integral-detail .detail-name .single-icon {
  width: 20px;
  height: 20px;
  background: #fff;
  color: #5db968;
  border-radius: 50%;
  display: inline-block;
  text-align: center;
  vertical-align: middle;
  line-height: 20px;
  margin-right: 5px;
  font-size: 12px;
}
#myIntegral .integral-detail .detail-name {
  position: absolute;
  top: 30px;
  left: 25px;
  font-size: 16px;
}
#myIntegral .integral-detail .detail-name text {
  vertical-align: middle;
}
#myIntegral .integral-detail .detail-num {
  position: absolute;
  left: 35px;
  bottom: 18px;
  font-size: 24px;
}
#myIntegral .integral-detail .detail-rule {
  position: absolute;
  top: 32px;
  right: 25px;
}
#myIntegral .integral-detail .detail-rule .single-icon {
  display: inline-block;
  width: 14px;
  height: 14px;
  line-height: 14px;
  background: #5db968;
  color: #fff;
  border-radius: 50%;
  text-align: center;
  vertical-align: middle;
  font-size: 12px;
  border: 1px solid #fff;
}
#myIntegral .integral-detail .detail-rule text {
  font-size: 14px;
}
#myIntegral .message-nav {
  width: 100%;
  height: 42px;
  line-height: 42px;
  text-align: center;
  background-color: #fff;
  border-top: 1px solid #eee;
  border-bottom: 1px solid #e9e9e9;
  z-index: 1;
}
#myIntegral .message-nav .type-item {
  position: relative;
  display: inline-block;
  min-width: 70px;
}
#myIntegral .message-nav .type-item:first-child {
  margin-right: 15px;
}
#myIntegral .message-nav .type-item.active {
  color: #55b737;
  border-bottom: 1px solid #55b737;
}
#myIntegral .message-content {
  display: none;
  /*max-height: calc(100vh - 180px);*/
  margin-bottom: 16px;
}
#myIntegral .message-content.active {
  display: block;
}
#myIntegral .message-item {
  position: relative;
  margin: 0;
  width: 100%;
  background: #fff;
  border-bottom: 1px solid #e9e9e9;
}
/*#myIntegral .message-item:last-child {
  margin-bottom: 16px;
}*/
#myIntegral .message-item .message-title {
  width: calc(100% - 110px);
  padding: 15px 0 0 15px;
  font-size: 15px;
  overflow: hidden;
}
#myIntegral .message-item .message-time {
  margin: 10px 0 12px 15px;
  color: #d6d6d6;
  font-size: 12px;
}
#myIntegral .message-item .message-num {
  position: absolute;
  top: 18px;
  right: 15px;
  overflow: hidden;
  font-size: 14px;
  color: #5db968;
}

/* 积分商品 积分规则页面*/
#myIntegral .myIntegral-rule {
  display: block;
}
#myIntegral .rule-list {
  padding: 10px 0;
  border-bottom: 1px solid #ddd;
  background: #feffff;
}
#myIntegral .rule-item {
  min-height: 36px;
  margin: 0 10px;
  padding: 5px 0;
  line-height: 36px;
}
#myIntegral .rule-item:last-child {
  border: 0;
}
#myIntegral .rule-item .item-name {
  display: inline-block;
  height: 36px;
  width: 85px;
  margin-right: 8px;
  vertical-align: top;
  color: #878889;
  text-align: center;
  overflow: hidden;
}
#myIntegral .rule-item .item-content {
  display: inline-block;
  max-width: calc(100% - 100px);
  min-height: 36px;
  line-height: 36px;
  overflow: hidden;
  vertical-align: top;
}
#myIntegral .rule-item .data-img {
  display: inline-block;
  width: 60px;
  height: 60px;
}
#myIntegral .myIntegral-rule .confirm-btn {
  margin: 14px 10px;
  padding: 10px 0;
  background: #55b737;
  border-radius: 5px;
  color: #fff;
  text-align: center;
  font-size: 16px;
}
#myIntrgral .myIntegral-rule {
  display: none;
}
</style>
<div class="myIntegral-wrap page" id="myIntegral">
  <div class="myIntegral-content">
    <div class="integral-detail">
      <div class="detail-name">
        <div class="single-icon">积</div>
        <span>现有积分/总积分</span>
      </div>
      <div class="detail-num">
        <span><span class="can-use-integral"></span> / <span class="total-integral"></span></span>
      </div>
      <div class="detail-rule">
        <div class="single-icon">?</div>
        <span>积分规则</span>
      </div>
    </div>
    <div class="message-nav">
      <div class="type-item active" data-type="income">收入</div>
      <div class="type-item" data-type="outcome">支出</div>
    </div>
    <div class="message-content active" data-type="income">
      <!-- <div class="message-item">
        <div class="message-title"></div>
        <div class="message-time"></div>
        <div class="message-num"></div>
      </div> -->
    </div>
    <div class="message-content" data-type="outcome">
      <!-- <div class="message-item">
        <div class="message-title"></div>
        <div class="message-time"></div>
        <div class="message-num"></div>
      </div> -->
    </div>
  </div>
  <div class="myIntegral-rule">
    <div class="rule-list">
      <div class="rule-item convert">
        <div class="item-name">积累规则</div>
        <div class="item-content">消费 <span class="consume-num"></span>元，获得 1 积分</div>
      </div>
      <div class="rule-item use">
        <div class="item-name">使用规则</div>
        <div class="item-content"><span class="convert-num"></span> 积分 = 1元</div>
      </div>
      <view class="rule-item login">
        <view class="item-name">额外积分</view>
        <view class="item-content">每天登录送 <span class="login-num"></span> 积分</view> 积分</view>

      <view class="rule-item share">
        <view class="item-name">额外积分</view>
        <view class="item-content">推荐好友送 <span class="share-num"></span> 积分</view>
      </view>
      <view class="rule-item post-comment">
        <view class="item-name">额外积分</view>
        <view class="item-content">商品评论送 <span class="post-comment-num"></span> 积分</view>
      </view>
      <div class="rule-item">
        <div class="item-name">提醒</div>
        <div class="item-content">消费积分并不会影响升级会员卡，与会员升级相关的是总积分</div>
      </div>
    </div>
    <div class="confirm-btn" catchtap="hideIntegralRule">确定</div>
  </div>
</div>
    <style rel="stylesheet">
  #balance {
    min-height: 100vh;
    background-color: #EFEFEF
  }

  #balance .balance-content {
    height: 100vh;
    overflow: auto;
  }

  #balance .balance-detail {
    position: relative;
    background: #ff6602;
    height: 107px;
    color: #fff;
  }

  #balance .balance-detail .detail-text {
    position: absolute;
    top: 26px;
    left: 15px;
    font-size: 14px;
  }

  #balance .balance-detail .detail-num {
    position: absolute;
    left: 15px;
    top: 55px;
    font-size: 25px;
  }

  #balance .balance-detail .detail-recharge {
    position: absolute;
    top: 55px;
    right: 15px;
    width: 64px;
    height: 25px;
    text-align: center;
    line-height: 25px;
    border: 1px solid #fff;
    border-radius: 3px;
    font-size: 12px;
  }

  #balance .message-content {
    display: block;
  }

  #balance .message-item {
    position: relative;
    margin: 0;
    width: 100%;
    height: 64px;
    background: #fff;
  }

  #balance .message-item:last-child {
    margin-bottom: 16px;
  }

  #balance .message-item::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 15px;
    width: calc(100% - 30px);
    border-bottom: 1px solid #eee;
  }

  #balance .message-item:last-child::after {
    display: none;
  }

  #balance .message-item .message-title {
    position: absolute;
    top: 13px;
    left: 15px;
    color: #212121;
    font-size: 15px;
  }

  #balance .message-item .message-num {
    position: absolute;
    top: 13px;
    right: 15px;
    overflow: hidden;
    font-size: 15px;
  }

  #balance .message-item .message-num.add {
    color: #ff6602;
  }

  #balance .message-item .message-num.minus {
    color: #666;
  }

  #balance .message-item .message-balance {
    position: absolute;
    top: 40px;
    left: 15px;
    color: #AAAAAA;
    font-size: 12px;
  }

  #balance .message-item .message-time {
    position: absolute;
    top: 40px;
    right: 15px;
    color: #AAAAAA;
    font-size: 12px;
  }
</style>
<div class="balance-wrap page" id="balance">
  <div class="balance-content">
    <div class="balance-detail">
      <div class="detail-text">当前储值金（元）</div>
      <div class="detail-num"></div>
      <div class="detail-recharge goto-recharge-btn">充值</div>
    </div>
    <div class="message-content">
    </div>
  </div>
</div>
<script>
  (function () {
    $('#balance').on('click', '.goto-recharge-btn', function(){
      APP.turnToPage({
        router: 'recharge',
        redirect: true
      });
    });
  })();
</script>
    <style rel="stylesheet">
  #recharge {
    height: 100%;
  }
  #recharge .select-area {
    margin: 10px 15px 10px;
    padding-bottom: 10px;
    border-bottom: 1px solid #eee;
  }
  #recharge .select-area .area-title {
    text-align: left;
    font-size: 14px;
    color: #212121;
  }
  #recharge .select-list {
    display: flex;
    flex-flow: row wrap;
    margin-top: 5px;
  }
  #recharge .select-item {
    display: inline-flex;
    flex: 0 1 auto;
    width: calc(50% - 5px);
    height: 50px;
    margin-bottom: 5px;
    color: #A7A7A7;
    border: 1px solid #A7A7A7;
    border-radius: 2px;
    box-sizing: border-box;
    flex-direction: column;
    justify-content: center;
    align-items: center
  }
  #recharge .select-item:nth-child(even) {
    margin-left: 10px;
  }
  #recharge .select-item.active {
    border: 1px solid #ff6602;
    color: #ff6602;
  }
  #recharge .select-item .recharge-money {
    font-size: 14px;
  }
  #recharge .select-item .give-money {
    margin-top: 3px;
    font-size: 12px;
  }
  #recharge .instruction-area {
    display: none;
    margin: 0 15px 10px;
  }
  #recharge .instruction-area .area-title {
    text-align: left;
    font-size: 14px;
    color: #212121;
  }
  #recharge .instruction-area .area-content {
    margin: 5px 0;
    color: #AAAAAA;
    font-size: 12px;
    word-wrap: break-word;
  }
  #recharge .payment-area {
    margin: 0 15px 20px;
  }
  #recharge .payment-area .area-title {
    text-align: left;
    font-size: 14px;
    color: #212121;
  }
  #recharge .select-way {
    display: inline-block;
    margin-top: 8px;
    margin-right: 10px;
  }
  #recharge .select-way input[type="radio"] {
    -webkit-appearance: radio;
    vertical-align: top;
    height: 14px;
    margin-top: 1px;
  }
  #recharge .select-way span {
    height: 16px;
    line-height: 16px;
    font-size: 14px;
  }
  #recharge .recharge-btn {
    margin: 0 15px;
    height: 30px;
    line-height: 30px;
    border: 1px solid #ff6602;
    background: #ff6602;
    border-radius: 2px;
    color: #fff;
    text-align: center;
    box-shadow: 0 0 2px 2px #eee;
  }
  #recharge .custom-item {
    margin-top: 5px;
    border: 1px solid #cccccc;
    border-radius: 2px;
    color: #cccccc;
  }
  #recharge .custom-item .item-title {
    color: #A7A7A7;
    margin-top: 15px;
    margin-left: 10px;
    font-size: 14px;
  }
  #recharge .custom-item .item-price-block {
    position: relative;
    border-bottom: 1px solid #cccccc;
    margin: 10px;
    padding-bottom: 5px;
    height: 36px;
    line-height: 36px;
    font-size: 16px;
  }
  #recharge .custom-item .item-price-symbol {
    position: absolute;
    top: 0;
    left: 0;
    color: #000;
  }
  #recharge .custom-item .item-price-input {
    position: absolute;
    top: 0;
    left: 20px;
    height: 36px;
    line-height: 36px;
    font-size: 18px;
    vertical-align: top;
    border: 0;
    outline: 0;
  }
  #recharge .custom-item .item-tip {
    margin: 0 10px 10px;
    font-size: 12px;
  }
  #recharge .custom-item.active {
    border: 1px solid #ff6602;
    color: #ff6602;
  }
  #recharge .custom-item.active .item-title {
    color: #ff6602;
  }
  #recharge .custom-item.active .item-price-symbol {
    color: #ff6602;
  }
  #recharge .custom-item.active .item-price-block {
    border-bottom: 1px solid #ff6602;
  }
  #recharge .coupon-area {
    margin: 0 15px 10px;
    padding-bottom: 10px;
    border-bottom: 1px solid #ccc;
  }
  #recharge .coupon-area .area-title {
    text-align: left;
    font-size: 14px;
  }
  #recharge .coupon-list {
    display: flex;
    flex-flow: row wrap;
    margin-top: 5px;
  }
  #recharge .coupon-item {
    position: relative;
    display: inline-flex;
    flex: 0 1 auto;
    width: calc(50% - 5px);
    height: 75px;
    margin-right: 5px;
    margin-bottom: 10px;
    color: #A7A7A7;
    border: 1px solid #A7A7A7;
    border-radius: 2px;
    box-sizing: border-box;
    flex-direction:column;
    justify-content:center;
    align-items:center;
  }
  #recharge .coupon-item .item-title {
    position: absolute;
    top: 6px;
    font-size: 14px;
  }
  #recharge .coupon-item .price {
    font-size: 20px;
  }
  #recharge .coupon-item .division-line {
    position: absolute;
    top: 35px;
    left: -1px;
    right: -1px;
    height: 10px;
    overflow: hidden;
    z-index: 1;
  }
  #recharge .coupon-item .left-semicircle {
    position:absolute;
    top: 0;
    left: -5px;
    width: 10px;
    height: 10px;
    border: 1px solid #A7A7A7;
    border-radius: 50%;
    background: #fff;
    box-sizing: border-box;
  }
  #recharge .coupon-item .right-semicircle {
    position: absolute;
    top: 0;
    right: -5px;
    width: 10px;
    height: 10px;
    border: 1px solid #A7A7A7;
    border-radius: 50%;
    box-sizing: border-box;
    background: #fff;
  }
  #recharge .coupon-item .bottom-section {
    position:absolute;
    border-top:1px dashed #ccc;
    top:40px;
    font-size:12px;
    width:100%;
    text-align:center;
    padding:2px;
    box-sizing:border-box;
  }
  #recharge .coupon-item .other-case {
    display: inline-block;
  }
  #recharge .coupon-item .time-duration {
    display: inline-block;
  }
  #recharge .coupon-item.active {
    color: #ff6602;
    border: 1px solid #ff6602;
  }
  #recharge .coupon-item.active .left-semicircle,
  #recharge .coupon-item.active .right-semicircle {
    border: 1px solid #ff6602;
  }
  #recharge .coupon-item.active .bottom-section {
    border-top:1px dashed #ff6602;
  }
</style>
<div class="recharge-wrap page" id="recharge">
  <div class="select-area">
    <div class="area-title">储值</div>
    <div class="select-list">
      <!--<div class="select-item active" >
        <div class="recharge-money">100元</div>
        <div class="give-money">赠送20元</div>
      </div>
      <div class="select-item" >
        <div class="recharge-money">100元</div>
      </div>
      <div class="select-item" >
        <div class="recharge-money">100元</div>
        <div class="give-money">赠送20元</div>
      </div>
      <div class="select-item" >
        <div class="recharge-money">100元</div>
      </div>-->
    </div>
    <div class="custom-item">
      <div class="item-title">自定义金额</div>
      <div class="item-price-block">
        <span class="item-price-symbol">¥</span>
        <input class="item-price-input" placeholder="请输入金额" type="digit">
      </div>
      <div class="item-tip"></div>
    </div>
  </div>
  <div class="instruction-area">
    <div class="area-title">储值说明</div>
    <div class="area-content"></div>
  </div>
  <div class="coupon-area">
    <div class="area-title">储值券充值</div>
    <div class="coupon-list">
      <!--<div class="coupon-item {{ ( type == 5 && selectedCouponItem.index == index ) ? 'active' : '' }}" data-index="{{ index }}" catchtap="selectActiveCouponItem" >
        <div class="item-title">¥ <text class="price">{{ item.price }}</text> 储值券</div>
        <div class="division-line">
          <div class="left-semicircle"></div>
          <div class="right-semicircle"></div>
        </div>
        <div class="bottom-section">
          <div class="date-duration">{{ item.dateDuration  }}</div>
          <div class="other-case">{{ item.otherCase }}</div>
          <div class="time-duration">{{ item.timeDuration }}</div>
        </div>
      </div>-->
    </div>
  </div>
  <div class="payment-area">
    <div class="area-title">支付方式</div>
    <div class="select-way">
      <input name="payment" value="wechatPay" checked="checked" type="radio">
      <span>微信</span>
    </div>
    <div class="select-way">
      <input name="payment" value="aliPay" type="radio">
      <span>支付宝</span>
    </div>
  </div>
  <div class="recharge-btn">充值</div>
</div>
    <style rel="stylesheet">
.franchisee-detail-wrap {
  background-color: #eee;
}
.franchisee-detail-wrap .slick-carousel-container {
  width: 100%;
  height: 320px;
  text-align: center;
  overflow: hidden;
  background: #fff;
}
.franchisee-detail-wrap .slick-carousel-container.thumbnail,
.franchisee-detail-wrap .slick-slide {
  font-size: 0;
  width: 100%;
  text-align: center;
  position: relative;
}
.franchisee-detail-wrap .slick-carousel-container.thumbnail:before,
.franchisee-detail-wrap .slick-carousel-container.thumbnail:after,
.franchisee-detail-wrap .slick-slide:before,
.franchisee-detail-wrap .slick-slide:after {
  content: "";
  display: inline-block;
  width: 0;
  height: 100%;
  vertical-align: middle;
}
.franchisee-detail-wrap .slick-carousel-container img {
  display: inline-block;
  max-height: 100%;
  max-width: 100%;
  vertical-align: middle;
  height: 100%;
  width: 100%;
}
/*.franchisee-detail-wrap .slick-slide:after {
  content: '';
  display: inline-block;
  height: 100%;
  vertical-align: middle;
}
.franchisee-detail-wrap .slick-slide {
  display: -webkit-box;
  display: -moz-box;
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
  -webkit-align-items: center;
          align-items: center;
  -webkit-justify-content: center;
          justify-content: center;
}*/
.franchisee-detail-wrap .franchisee-detail-section {

  background: #fff;
}
/*.franchisee-detail-wrap .franchisee-detail-section .franchisee-name{
  padding: 10px 0 10px 10px;
}*/

.franchisee-detail-section .franchisee-imgNews{
	display: flex;
}
 .franchisee-detail-section .franchisee-imgNews img{
 	display: inline-block;
  width: 60px;
  height: 60px;
  border-radius: 50%;
  margin-right: 10px;
  vertical-align: middle;
  border:0;
 }

 .franchisee-detail-section .franchisee-imgNews .imgNews-right{
 	flex: 1;
 }
 .franchisee-detail-section .franchisee-imgNews .imgNews-right p{
 	line-height: 30px;
 }
.franchisee-name {
  font-size: 16px;
  padding: 10px 0 10px 10px;
  color: #323232;
}
.franchisee-description {
  color: #323232;
}
.franchisee-detail-wrap .right-arrow-bar {
  padding-right: 33px;
}
.franchisee-detail-wrap .right-arrow-bar:before {
  font-size: 16px;
}
.franchisee-other-info{
  padding-left: 10px;
}
.franchisee-other-info > div {
  padding: 10px 0;
  border-top: 1px solid #f8f8f8;
  font-size: 13px;
}
.franchisee-other-info > div:last-child {
  margin-bottom: 0;
}
.franchisee-business-hours, .franchisee-address {
  display: inline-block;
  width: calc(100% - 70px);
  vertical-align: top;
  word-break: break-all;
  vertical-align: baseline;


  white-space: nowrap;
text-overflow:ellipsis;
text-overflow: ellipsis;
overflow:hidden;
}
.goods-coupon-list{
  width: 100%;
  position: absolute;
  left: 0;
  top: 0;
  height: 100%;
  display: none;
  background: #efeff5;
  overflow-y: auto;
  overflow-x: hidden;
}
.franchisee-goods-coupon-container{
	position: relative;
	background-color: #efeff5;
	height: auto;
	width: 100%;
	/*overflow-x: scroll;
	white-space: nowrap;*/
}
.coupon_ticket{
  margin-bottom: 10px;
  margin-top: 10px;
}

.coupon_ticket .ticket-wrap{
    height: 80px;
    width: 90%;
    margin: 0 auto;
    background: #fff;
    position: relative;
    overflow: hidden;
}
.coupon_ticket .ticket-wrap::before{
    content: '';
    position: absolute;
    top: -6px;
    left: 85px;
    border: 6px solid #efeff5;
    border-radius: 50%;
}
.coupon_ticket .ticket-wrap::after{
    content: '';
    position: absolute;
    bottom: -6px;
    left: 85px;
    border: 6px solid #efeff5;
    border-radius: 50%;
}
.coupon_ticket .ticket-wrap .price{
    float: left;
    height: 80px;
    width: 90px;
    text-align: center;
    line-height: 80px;
    background: #e66b67;
    color: #fff;
    font-size: 20px;
    border-right: 1px dashed #efeff5;
    margin-right: 15px;
}
.coupon_ticket .ticket-wrap .coupon_right{
    float: left;
}
.ticket-wrap .coupon_right .coupon_name{
    font-size: 16px;
    font-weight: normal;
    margin: 13px 0 8px 0;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    width: 180px;
}
.ticket-wrap .coupon_right p{
    font-size: 12px;
    line-height: 20px;
    color: #b2b2b2;
}
.coupon_bottom{
    width: 90%;
    margin: 0 auto;
    text-indent: 1em;
    padding: 10px 0;
    background: #f7f7f7;
    border-radius: 5px;
    border-top: 1px dotted #c6c6c6;
    font-size: 12px;
    color: #888;
    border: 1px solid #eee;
}
.franchisee-goods-content{
	width: 100%;
	background: #fff;
	padding-left: 10px;
  margin-top: 10px;
  font-size: 13px;
}
.franchisee-goods-content .franchisee-con{
  height: 40px;
  line-height: 40px;
  border-bottom: 1px solid #f8f8f8;
}
.franchisee-goods-content .content-news{
	height:auto;
	border-bottom: 1px solid #f8f8f8;
	padding: 10px 20px 10px 0;
}

.get-goods-coupon{
  padding:10px;
  margin-top: 10px;
  margin-bottom: 10px;
  background: #fff;
  font-size: 13px;
  color: #323232;
}
.franchisee-goods-content .content-news p{
	  width: 100%;
    word-break: break-all;
    text-overflow: ellipsis;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 4;
    overflow: hidden;
    line-height: 22px;
}
.franchisee-goods-content .content-time{
  padding: 10px 0;
}
.franchisee-goods-content .content-time > span{
  display: inline-block;
  line-height: 1.5em;
  width: 70px;
  vertical-align: top;
  color: #666666;
}
.franchisee-goods-content .content-time .franchisee-business-hours{
  display: inline-block;
	height: 100%;
	line-height: 1.5em;
	width: 245px;
  vertical-align: top;
}
.franchisee-goods-list-container, .franchisee-order-list-container,.franchisee-tostore-list-container{
  background: #eee;
  margin-bottom: 10px;
  margin-top: 10px;
}

.franchisee-goods-list-title,.franchisee-order-list-title,.franchisee-tostore-list-title{
  display: block;
  background-color: #fff;
  padding: 10px;
  border-bottom: 1px solid #f8f8f8;
  color: #323232;
}
.franchisee-goods-list-title .goods-list-more,.franchisee-order-list-title .order-list-more,.franchisee-tostore-list-title .tostore-list-more{
	float: right;
}
.franchisee-goods-empty-tip {
  padding: 10px;
  color: #999;
  text-align: center;
}


.franchisee-goods-item {
  position: relative;
  height: 60px;
  padding: 10px;
  padding-right: 0;
  text-decoration: inherit;
  border-bottom: 1px solid #f8f8f8;
  background-color: #fff;
}
.franchisee-goods-item .list-img {
  display: inline-block;
  width: 80px;
  height: 60px;
  vertical-align: middle;
}
.franchisee-goods-item .title-container {
  display: inline-block;
  width: calc(100% - 90px);
  text-decoration: inherit;
  vertical-align: top;
}
.franchisee-goods-item .title-container p {
  width: calc(100% - 10px);
  padding-left: 10px;
  word-break: break-all;
}
.franchisee-goods-item .title-container p:last-child {
  position: absolute;
  bottom: 10px;
}
.franchisee-goods-item .title-container .title {
  text-decoration: inherit;
  overflow : hidden;
  text-overflow: ellipsis;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
}
.franchisee-goods-item .title-container .price {
  color: #ff7100;
  margin-right: 10px;
}
.franchisee-goods-item .title-container .sales {
  font-size: 12px;
  color: #a8a8a8;
}
.franchisee-tip-bar {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  height: 50px;
  line-height: 50px;
  font-size: 16px;
  background-color: rgba(0,0,0,.6);
  color: #fff;
  text-align: center;
}
.franchisee-goods-tab {
  text-align: center;
}
.franchisee-goods-tab span {
  display: inline-block;
  padding: 10px 30px;
  color: #666;
  border-bottom: 1px solid transparent;
}
.franchisee-goods-tab .selected {
  color: #00f010;
  border-bottom: 1px solid #00f010;
}
.franchisee-other-info .ico-moon {
  font-size: 12px;
  margin-right: 5px;
  color: #bababa;
  vertical-align: text-top;
}

.franchisee-goods-list{
	width: 100%;
	/*height: 150px;*/
	margin-bottom: 10px;
	background: #fff;
}
.franchisee-goods-list .goods-list-title{
	padding: 10px;
  border-bottom: 1px solid #d5d5d5;
}
.franchisee-goods-list .goods-list-title span{
	display: inline-block;
	float: right;
}
.franchisee-goods-list .goods-list-news{
	padding-left: 10px;
}
.goods-list-news .goods-list-shops{
	padding: 10px;
	border-bottom: 1px solid #d5d5d5;
	display: flex;
}


.franchisee-goods-order{
	width: 100%;
	background: #fff;
}


.list-more-show,.order-more-show,.tostore-more-show{
	width: 100%;
	position: absolute;
	left: 0;
	top: 0;
	height: 100%;
	display: none;
	background: #eee;
  overflow-y: auto;
  overflow-x: hidden;
}
.franchiseeDetail-container {
	width: 100%;
	height: 100%;
	z-index: 20;
}
.franchisee-goods-list-categroy,
.franchisee-order-list-categroy,
.franchisee-tostore-list-categroy
{
  background-color: #fff;
  width: 100%;
  overflow-x: auto;
  overflow-y: hidden;
}

.list-more-show .franchisee-goods-list-categroy .categroyList,.order-more-show .franchisee-order-list-categroy .categroyList,.tostore-more-show .franchisee-tostore-list-categroy .categroyList{
	width: 100%;
  white-space: nowrap;
  height: 40px;
}
.list-more-show .franchisee-goods-list-categroy .categroyList>li,.order-more-show .franchisee-order-list-categroy .categroyList>li,.tostore-more-show .franchisee-tostore-list-categroy .categroyList>li{
	display: inline-block;
  width: 75px;
  line-height:39px;
  text-align:center;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}
.list-more-show .franchisee-goods-list-categroy .categroyList>li.active,.order-more-show .franchisee-order-list-categroy .categroyList>li.active,.tostore-more-show .franchisee-tostore-list-categroy .categroyList>li.active{
	border-bottom: 1px solid #ff7100;
  color: #ff7100;
}
.list-more-show .franchisee-goods-item,
.order-more-show .franchisee-goods-item,.tostore-more-show .franchisee-goods-item{
  margin-top: 7px;
}


</style>
<div class="franchisee-detail-wrap page" id="franchiseeDetail">
	<div class="franchiseeDetail-container">
  <div class="slick-carousel-container">
  </div>
  	<div class="franchisee-detail-section">
  			<div class="franchisee-name"></div>
    <div class="franchisee-other-info">
      <div><span class="ico-moon icon-fesadress" style="vertical-align: super;"></span><div class="franchisee-address" style="cursor: pointer;" lat="" lng="" address=""></div></div>
      <div><span class="ico-moon icon-fesphone"></span><a class="franchisee-phone"></a></div>
    </div>
  </div>

  <div class="get-goods-coupon">
  <span class="icon-coupon" style="color: #fa575c"></span>&nbsp;&nbsp;店铺活动·领取优惠券<span style="float: right;color: #bababa" class="icon-rightarrow"></span>
  </div>



      <!--电商-->
  <div class="franchisee-goods-list-container goods-listData">
    <div class="franchisee-goods-list-title">商品<span class="goods-list-more" style="font-size: 13px;cursor: pointer;"><span class="icon-rightarrow" style="color: #bababa"></span></span></div>
    <!-- <div class="franchisee-goods-empty-tip">暂无商品</div> -->
    <div data-page="franchisee-detail">
      <ul class="js-list-container"></ul>
    </div>
  </div>
       <!--预约-->
  <div class="franchisee-order-list-container order-listData">
    <div class="franchisee-order-list-title">预约<span class="order-list-more" style="font-size: 13px;cursor: pointer;"><span class="icon-rightarrow" style="color: #bababa"></span></span></div>
    <!-- <div class="franchisee-goods-empty-tip">暂无预约</div> -->
    <div data-page="franchisee-detail">
      <ul class="js-list-container"></ul>
    </div>
  </div>
  <!-- 到店 -->
  <div class="franchisee-tostore-list-container tostore-listData">
    <div class="franchisee-tostore-list-title">到店<span class="tostore-list-more" style="font-size: 13px;cursor: pointer;"><span class="icon-rightarrow" style="color: #bababa"></span></span></div>
    <!-- <div class="franchisee-goods-empty-tip">暂无预约</div> -->
    <div data-page="franchisee-detail">
      <ul class="js-list-container"></ul>
    </div>
  </div>
  <div class="franchisee-goods-content">
    <div class="franchisee-con">
     商户信息&nbsp;&nbsp;<span class="ico-moon icon-attestation" style="color: #54B136"></span>
    </div>
    <div class="content-news">
      <p><b style="color: #666666;font-weight: normal;">商家简介：</b><span class="franchisee-description"></span></p>

    </div>
    <div class="content-time">
      <span>营业时间:&nbsp;</span><div class="franchisee-business-hours"></div>
    </div>
  </div>
 </div>
 <div class="franchisee-tip-bar">商家休息</div>
<div class="list-more-show">
	<div class="franchisee-goods-list-container">
    <div class="franchisee-goods-list-categroy">
    	<ul class="categroyList">

    	</ul>
    </div>
    <div>
      <ul class="js-list-container lists-goods"></ul>
    </div>
  </div>
</div>
<div class="order-more-show">
 	<div class="franchisee-order-list-container">
    <div class="franchisee-order-list-categroy">
    	<ul class="categroyList">

    	</ul>
    </div>
    <div>
      <ul class="js-list-container lists-order"></ul>
    </div>
  </div>
</div>
<div class="tostore-more-show">
  <div class="franchisee-tostore-list-container">
    <div class="franchisee-tostore-list-categroy">
      <ul class="categroyList">

      </ul>
    </div>
    <div>
      <ul class="js-list-container lists-tostore"></ul>
    </div>
  </div>
</div>
<!-- 优惠券列表 -->
 <div class="goods-coupon-list">
  <div class="franchisee-goods-coupon-container">

  </div>
</div>
</div>
<script>
(function(){
//$('#franchiseeDetail').on('click', '.franchisee-goods-tab > span', function(){
//  $(this).addClass('selected').siblings('.selected').removeClass('selected');
//  APP.clickFranchiseeDetailTab($(this).attr('data-form'));
//})
//.on("click",".goods-list-more",function(){
//	var url = modifyTargetUrl({
//                router: GetQueryString('router'),
//                detail: 'rule'
//              });
//              window.history.pushState(null, '', url);
//              document.title = '全部商品';
//	$('.franchiseeDetail-container ').hide();
//	$(".list-more-show").show();
//});


})();
</script>

    <style rel="stylesheet">
.reset-location-wrap {
  background-color: #eee;
}
.location_search_nav {
  padding: 10px;
  text-align: center;
  background-color: #fff;
}
.location_search_content {
  display: inline-block;
  width: calc(100% - 70px);
  margin-right: 5px;
  background-color: #eee;
}
.location_search_content .icon-search {
  display: inline-block;
}
.location_searchi_input {
  width: calc(100% - 40px);
  height: 26px;
  padding: 5px;
  border: none;
  background-color: #eee;
}
.location_search_btn {
  display: inline-block;
  padding: 8px 12px;
  border-radius: 4px;
  background-color: orange;
  color: #fff;
}
.location_current_address {
  background-color: #fff;
  padding: 12px 10px;
}
.location_reset_btn {
  position: absolute;
  right: 10px;
  color: blue;
}
.location_address_text {
  padding-right: 70px;
}
</style>
<div class="reset-location-wrap page" id="resetLocation">
  <div class="location_search_nav">
    <div class="location_search_content">
      <div class="icon-search"></div>
      <input class="location_searchi_input" placeholder="请输入具体地址" type="text">
    </div>
    <div class="location_search_btn">搜索</div>
  </div>
  <div class="location_address_list">
    <div style="padding: 15px 10px 10px;">当前地址</div>
    <div class="location_current_address">
      <div class="location_reset_btn">重新定位</div>
      <div class="location_address_text"></div>
    </div>
  </div>
</div>
<script>
(function(){
  $('.reset-location-wrap').on('click', '.location_search_btn', function(){
    var address = $('.location_searchi_input').val();
    if(!address) return;
    $ajax('/index.php?r=Region/GetLatAndLngByAreaInfo', 'get', {
        address: address
      }, 'json', function(res){
        if(res.status !== 0) { alertTip(data.data); return; }
        APP.setLocation({
          location: res.data.location,
          address: address,
          listId: GetQueryString('listId')
        });
        window.history.back();
      });
  }).on('click', '.location_reset_btn', function(){
    navigator.geolocation.getCurrentPosition(function(position){
      var latitude = position.coords.latitude,
          longitude =position.coords.longitude;

      $.ajax({
        url: '/index.php?r=Region/GetAreaInfoByLatAndLng',
        data: {
          latitude: latitude,
          longitude: longitude
        },
        dataType: 'json',
        success: function(res){
          if(res.status !== 0) { alertTip(data.data); return;}
          var address = res.data.addressComponent.street + res.data.sematic_description;
          APP.setLocation({
            location: {lat: latitude, lng: longitude},
            address: address,
            listId: GetQueryString('listId')
          });
          window.history.back();
        }
      });
    }, function(){
      alertTip('定位失败 请检查网络状况');
    });
  });
})();
</script>

    <style type="text/css" rel="stylesheet">
	#CitylocationPage{
    background:#fcfaff;
  }
  .select-location{
  	height: 36px;
    vertical-align: top;
    line-height: 36px;
    display: inline-block;
    margin: 0 10px;
  }
	.location-edit-input{
    box-sizing: border-box;
    height: 36px;
    padding: 4px 6px;
    border-radius: 4px;
    border: none;
    width: 75px;
    margin-right: 3px;
	}
</style>
<div class="citylocation-page-wrap page" id="CitylocationPage">
	<div><span class="select-location">选择位置</span><select class="location-province-select location-edit-input"><option selected="selected">省</option><option value="34" data-name="台湾省">台湾省</option><option value="33" data-name="澳门特别行政区">澳门特别行政区</option><option value="32" data-name="香港特别行政区">香港特别行政区</option><option value="31" data-name="新疆维吾尔自治区">新疆维吾尔自治区</option><option value="30" data-name="宁夏回族自治区">宁夏回族自治区</option><option value="29" data-name="青海省">青海省</option><option value="28" data-name="甘肃省">甘肃省</option><option value="27" data-name="陕西省">陕西省</option><option value="26" data-name="西藏自治区">西藏自治区</option><option value="25" data-name="云南省">云南省</option><option value="24" data-name="贵州省">贵州省</option><option value="23" data-name="四川省">四川省</option><option value="22" data-name="重庆市">重庆市</option><option value="21" data-name="海南省">海南省</option><option value="20" data-name="广西壮族自治区">广西壮族自治区</option><option value="19" data-name="广东省">广东省</option><option value="18" data-name="湖南省">湖南省</option><option value="17" data-name="湖北省">湖北省</option><option value="16" data-name="河南省">河南省</option><option value="15" data-name="山东省">山东省</option><option value="14" data-name="江西省">江西省</option><option value="13" data-name="福建省">福建省</option><option value="12" data-name="安徽省">安徽省</option><option value="11" data-name="浙江省">浙江省</option><option value="10" data-name="江苏省">江苏省</option><option value="9" data-name="上海市">上海市</option><option value="8" data-name="黑龙江省">黑龙江省</option><option value="7" data-name="吉林省">吉林省</option><option value="6" data-name="辽宁省">辽宁省</option><option value="5" data-name="内蒙古自治区">内蒙古自治区</option><option value="4" data-name="山西省">山西省</option><option value="3" data-name="河北省">河北省</option><option value="2" data-name="天津市">天津市</option><option value="1" data-name="北京市">北京市</option></select><select class="location-city-select location-edit-input"><option selected="selected">城市</option></select><select class="location-district-select location-edit-input"><option selected="selected">区县</option></select></div>
</div>
<script type="text/javascript">
$(function(){
	getArea('.location-province-select', 0, '列表请求出错,请重试')
	$('#CitylocationPage').on('change', '.location-province-select', function(){
		$('.location-city-select').html('<option>城市</option>');
		$('.location-district-select').html('<option>区县</option>');
		getArea('.location-city-select', $(this).val(), '列表请求出错,请重试');
	}).on('change', '.location-city-select', function(){
		$('.location-district-select').html('<option>区县</option>');
		getArea('.location-district-select', $(this).val(), '列表请求出错,请重试');
	}).on('change', '.location-district-select', function(event) {
		APP.citylocation($('#CitylocationPage').attr('data-type'), $(this).val(), $("#CitylocationPage").data('form'), $('#CitylocationPage .list-vessel-wrap').eq(0));
	});
})
	function getArea (container,pid,tip,targetPid, fun){
		showLoading();
		$.ajax({
			url:'/index.php?r=Region/getRegionList',
			type:'get',
			data:{pid: pid},
			dataType:'json',
			success:function(data){
				removeLoading();
				if(data.status == 0){
					var list = data.data,
							listStr = '';
					if (container == '.location-district-select') {
						listStr = '<option value="'+pid+'" data-name="全部">全部</option>';
					}
					$(list).each(function(index, item) {
						listStr += '<option value="'+item.id+'" data-name="'+item.name+'">'+item.name+'</option>';
					});
					$(container).append(listStr);
					if(targetPid){
						$(container).find('option[value="'+targetPid+'"]').prop('selected', true);
					}
					fun && fun();
				}else{
					alertTip(tip);
				}
			},
			error:function(data){
				removeLoading();
				alertTip(tip);
			}
		});
	}
</script>
    <style rel="stylesheet">
#tostoreDetail {
  background-color: #fff;
}
#tostoreDetail .goods-detail-nav {
  width: 100%;
  box-sizing: border-box;
  height: 37px;
  text-align: center;
  background-color: #fff;
  z-index: 1;
}
#tostoreDetail .goods-detail-content {
  margin-bottom: 62px;
}
#tostoreDetail .goods-details-box {
  width: 80%;
  background: #fff;
  margin: 0 auto;
  position: relative;
  top: -30px;
  border-radius: 10px;
}
#tostoreDetail .slick-carousel-container {
  width: 100%;
  height: 325px;
  text-align: center;
  overflow: hidden;
}
#tostoreDetail .slick-slide:after {
  content: '';
  display: inline-block;
  height: 100%;
  vertical-align: middle;
}
#tostoreDetail .slick-slide {
  display: -webkit-box;
  display: -moz-box;
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
  -webkit-align-items: center;
          align-items: center;
  -webkit-justify-content: center;
          justify-content: center;
}
#tostoreDetail .slick-slide > img {
  width: 100%;
  height: auto;
}
#tostoreDetail .goods-header {
  padding: 1px 10px;
}
#tostoreDetail .goods-title,
#tostoreDetail .goods-price {
  padding: 5px 0;
  word-break: break-all;
}
#tostoreDetail .goods-price {
  text-align: center;
  position: relative;
  display: none;
}
#tostoreDetail .goods-rules {
  display: none;
  border-radius: 20px;
  margin: 0 auto;
}
#tostoreDetail .goods-price, #tostoreDetail .goods-models {
  border: none;
}
#tostoreDetail .goods-title {
  font-size: 16px;
  text-align: center;
  padding: 10px 10px 0 10px;
}
#tostoreDetail .goods-current-price {
  color: #f60;
  display: inline-block;
  vertical-align: middle;
  float: left;
  margin-left: 30px;
}
#tostoreDetail .goods-current-price b {
  font-size: 20px;
}
#tostoreDetail .goods-original-price {
  text-decoration: line-through;
  vertical-align: middle;
  color: #999;
  display: inline-block;
}
#tostoreDetail .block-item {
  padding: 10px;
}
#tostoreDetail hr {
  margin: 0;
  border: 0px none;
}
#tostoreDetail .goods-details {
  line-height: 22px;
  word-break: break-all;
  text-align: center;
}
#tostoreDetail .goods-details p {
  margin: 0;
  word-break: break-all;
  white-space: pre-line;
}
#tostoreDetail .goods-details img {
  display: block;
  width: 100%;
  height: auto;
}
#tostoreDetail dl:after {
  content: "";
  display: table;
  clear: both;
}
#tostoreDetail dd {
  margin-left: 10px;
  line-height: 20px;
  width: calc(100% - 70px);
}
#tostoreDetail .goods-bottom-opt {
  display: none;
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  text-align: center;
  padding: 0;
  border: none;
  background-image: -webkit-linear-gradient(bottom, rgba(226,227,231,0.33) 0%, rgba(248,248,248,0.33) 100%);
  background-image: linear-gradient(to top, rgba(226,227,231,0.33) 0%, rgba(248,248,248,0.33) 100%);
  background-color: #fff;
  -webkit-user-select: none;
  user-select: none;
  font-size: 0;
  background: #696969;
}
#tostoreDetail .goods-bottom-opt .goods-opt-item {
  padding:0;
}
#tostoreDetail .btn-orange {
  color: #fff;
  border: none;
  background-color: #696969;
  line-height: 34px;
  text-align: left;
}
#tostoreDetail .add-to-shoppingcart{
  background: #a8a8a8;
  color: #fff;
  border: none;
  line-height:34px;
}

#tostoreDetail .add-to-shoppingcart.router {
  background: #ffcc01;
  color: #fff;
  border-radius: 0;
}
#tostoreDetail .goods-bottom-opt .btn {
  width: 100%;
  box-sizing: border-box;
  border-radius: 0;
}
#tostoreDetail .right-arrow-bar {
  padding-right: 33px;
}
#tostoreDetail .right-arrow-bar:before {
  font-size: 16px;
}
#tostoreDetail .icon-notebook {
  position: relative;
  margin-right: 8px;
  font-size: 26px;
  line-height: 37px;
  width: 45px;
  color: #999;
}
#tostoreDetail .icon-shoppingcart {
  position: relative;
  margin-right: 8px;
  font-size: 24px;
  line-height: 24px;
  width: 45px;
  color: #fff;
  vertical-align: middle;
  margin-left: 20px;
}
#tostoreDetail .goods-comment-label {
  display: inline-block;
  padding: 4px 8px;
  background-color: #f5ece7;
  color: #7c7877;
  margin-right: 5px;
  border-radius: 2px;
  font-size: 12px;
}
#tostoreDetail .comment-item {
  padding: 15px 0 5px;
}
#tostoreDetail .comment-user-photo {
  width: 20px;
  height: 20px;
  border-radius: 50%;
  margin-right: 7px;
  vertical-align: middle;
}
#tostoreDetail .comment-content {
  margin: 10px 0 6px;
  font-size: 13px;
  line-height: 16px;
}
#tostoreDetail .comment-date, .comment-goods-model {
  color: #999;
  font-size: 12px;
}
#tostoreDetail .comment-date {
  margin-right: 8px;
}
#tostoreDetail .goods-app-name {
  display: inline-block;
  width: calc(100% - 80px);
  height: 16px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
#tostoreDetail .cart-goods-num {
  position: absolute;
  top: 0;
  right: 0;
  width: 18px;
  height: 18px;
  line-height: 16px;
  font-size: 14px;
  text-align:center;
  background-color: #ff1616;
  border-radius: 50%;
  color: #fff;
}
#tostoreDetail .goods-price-discount {
  display: inline-block;
  font-size: 14px;
  vertical-align: bottom;
  color: #acacac;
}
#tostoreDetail .goods-num {
  position: absolute;
  right: 20px;
  top: 15%;
}
#tostoreDetail .goods-min-num,#tostoreDetail .goods-add-num {
  position:relative;
  display:inline-block;
  font-size:16px;
  line-height:10px;
  color:#666;
  outline:0!important;
  border:1px solid #999;
  text-indent:-9999px;
  overflow:hidden;
  vertical-align:middle;
  width:20px;
  height:20px;
  line-height:20px;
  font-weight:normal;
  background-color:#ffcc01;
  border-color:#ffcc01;
  border-radius:50%;
}
#tostoreDetail .goods-min-num {
  background-color:#fff;
  border-color:#dedede;
}
#tostoreDetail .goods-min-num::before,#tostoreDetail .goods-add-num::after {
  position:absolute;
  width:8px;
  height:2px;
  top:0;
  left:0;
  right:0;
  margin:auto;
  background-color:#dedede;
  bottom:0;
  content:'';
}
#tostoreDetail .goods-add-num::after {
  position:absolute;
  top:0;
  bottom:0;
  left:0;
  right:0;
  margin:auto;
  content:'';
  width:2px;
  height:8px;
  background-color:#6c6c6c;
}
#tostoreDetail .goods-add-num::before {
  position:absolute;
  width:8px;
  height:2px;
  top:0;
  left:0;
  right:0;
  margin:auto;
  background-color:#6c6c6c;
  bottom:0;
  content:'';
}
#tostoreDetail .goods-add-num::before,#tostoreDetail .goods-add-num::after {
  background-color:#fff;
}
#tostoreDetail .goods-detail-section {
    width: 80%;
    margin: 0 auto;
}
#tostoreDetail .shop-num {
    width: 16px;
    background: red;
    height: 16px;
    line-height: 16px;
    display: inline-block;
    position: absolute;
    top: -4px;
    right: 9px;
    border-radius: 50%;
    color: #fff;
    font-size: 12px;
    text-align: center;
}

/*有规格*/
#tostoreDetail .thumb {
  float: left;
  width: 40px;
  height: 40px;
  margin: 2px 5px 0 10px;
}
#tostoreDetail .thumb img {
  width: 100%;
  height: 100%;
}
#tostoreDetail .goods-base-info {
  margin-left: 55px;
  display: inline-block;
}
#tostoreDetail .pay-goods-title,
#tostoreDetail .pay-goods-price {
  padding-right: 50px;
  line-height: 22px;
}
#tostoreDetail .pay-current-price {
  color: #f60;
  margin-top: 6px;
}
#tostoreDetail .pay-current-price b {
  vertical-align: middle;
  font-size: 16px;
}
#tostoreDetail .pay-goods-models {
  padding: 0 10px;
  margin: -10px 0;
}
#tostoreDetail dl {
  margin: 0;
  padding: 2px;
}
/*#tostoreDetail .pay-goods-models dl:last-child {
  border-bottom: none;
}*/
#tostoreDetail dt, #tostoreDetail dd {
  display: inline-block;
  margin: 0;
  vertical-align: middle;
}
#tostoreDetail dt {
  padding-top: 6px;
  color: #999;
  width: 60px;
  vertical-align: top;
  font-size: 12px;
  text-align: right;
}
#tostoreDetail .pay-goods-models ul {
  /*margin: 10px 0;*/
  max-height: 300px;
  overflow: scroll;
}
#tostoreDetail .pay-goods-models li {
  color:#707070;
  margin-bottom: 2px;
  margin-top: 2px;
  border-radius: 25px;
  padding: 2px 12px;
  font-size: 12px;
  min-width: 42px;
  margin-right: 5px;
}
#tostoreDetail .pay-goods-models li.select {
  position: relative;
  background-color:#fdeab0;
}
#tostoreDetail .pay-goods-models li.select:after {
  content: '';
  position: absolute;
  bottom: 0;
  right: 0;
  width: 12px;
  height: 12px;
}
#tostoreDetail .pay-goods-stock {
  display: inline-block;
  margin: 5px 10px 0 0;
}
#tostoreDetail .pay-buy-next,
#tostoreDetail .pay-add-to-shoppingcart {
  margin: 0 10px;
  padding: 11px 10px;
  font-size: 16px;
  line-height: 16px;
  border-radius: 4px;
}
#tostoreDetail .minus,#tostoreDetail .plus {
  position:relative;
  display:inline-block;
  font-size:16px;
  line-height:10px;
  font-weight:700;
  color:#666;
  outline:0!important;
  width:37px;
  height:29px;
  background-color:#fff;
  border:1px solid #999;
  text-indent:-9999px;
  overflow:hidden;
  vertical-align:middle;
  width:20px;
  height:20px;
  line-height:20px;
  font-weight:normal;
  background-color:#ffcc01;
  border-color:#ffcc01;
  border-radius:50%;
}
#tostoreDetail .minus {
  background-color:#fff;
  border-color: #dedede;
}
#tostoreDetail .minus::before,#tostoreDetail .plus::after {
  position:absolute;
  width:8px;
  height:2px;
  top:0;
  left:0;
  right:0;
  margin:auto;
  background-color:#dedede;
  bottom:0;
  content:'';
}
#tostoreDetail .plus::after {
  position:absolute;
  top:0;
  bottom:0;
  left:0;
  right:0;
  margin:auto;
  content:'';
  width:2px;
  height:8px;
  background-color:#6c6c6c;
}
#tostoreDetail .plus::before {
  position:absolute;
  width:8px;
  height:2px;
  top:0;
  left:0;
  right:0;
  margin:auto;
  background-color:#6c6c6c;
  bottom:0;
  content:'';
}
#tostoreDetail .plus::before,#tostoreDetail .plus::after {
  background-color:#fff;
}
#tostoreDetail .pay-buy-count {
  border: none;
}
#tostoreDetail .dialog-block-item {
  border: none
}
#tostoreDetail .pills-list li {
  border: 1px solid #dedede;
  text-align: center;
}
#tostoreDetail .dialog-block-item {
 padding: 0;
}
#tostoreDetail .goods-sure-num {
  vertical-align: middle;
  margin: 0 10px;
}
#tostoreDetail .businesssTimeString {
  padding-left: 40px;
  font-size: 12px;
  color: #ffcc01;
}
#tostoreDetail .noRouter {
  background: #ffcc01;
  color: #fff;
  border-radius: 0;
}
#tostoreDetail .clearfix:after{
  content: '';
  display: block;
  clear: both;
}
</style>
<div class="goods-detail-wrap page" id="tostoreDetail">
  <div class="goods-details-top">
    <div class="slick-carousel-container"></div>
    <div class="goods-details-box">
      <div class="goods-title">商品标题</div>
      <div class="goods-details"></div>
    </div>
  </div>
  <div class="goods-detail-content">
    <div class="clearfix">
      <div class="goods-price">
        <span class="pull-left tostoreHide" style="display: none;">库存 <span class="pay-goods-stock">6</span></span>
        <div class="goods-current-price"><span>￥&nbsp;</span><b class="js-current-price"></b></div>
        <div class="goods-num">
          <span class="goods-min-num" data-type="min"></span>
          <span class="goods-sure-num">0</span>
          <span class="goods-add-num" data-type="add"></span>
        </div>
      </div>
      <div class="goods-rules">
        <div class="page-bottom-content">
          <div class="pay-goods-models">
            <!-- <dl>
              <dt>颜色分类：</dt>
              <dd>
                <ul class="pills-list">
                  <li class="subModel">红色</li>
                  <li class="subModel">黄色</li>
                  <li class="subModel">三彩</li>
                  <li class="subModel">绿色</li>
                </ul>
              </dd>
            </dl>
            <dl>
              <dt>头枕：</dt>
              <dd><ul class="pills-list">
                  <li class="subModel">大</li>
                  <li class="subModel">中</li>
                  <li class="subModel">小</li>
                </ul></dd>
            </dl> -->
          </div>
          <div class="dialog-block-item" style="margin-top: 10px;padding: 5px 10px;">
            <dl class="clearfix" style="padding: 2px 30px;"><div class="pay-current-price pull-left"><span class="pull-left">
            ￥</span><b class="js-goods-price">299.00 - 388.00</b></div>
            <span class="pull-left tostoreHide" style="display: none;">库存 <span class="pay-goods-stock">6</span></span>
            <div class="quantity pull-right">
              <button class="minus disabled" type="button" disabled="true"></button><input class="pay-buy-count" value="0" type="text"><button class="plus" type="button"></button>
              <div class="response-area response-area-minus"></div>
              <div class="response-area response-area-plus"></div>
            </div></dl>
          </div>
          <!-- <div class="dialog-block-item">
            <div class="btn btn-block btn-orange pay-buy-next">下一步</div>
            <div class="btn btn-block btn-orange pay-add-to-shoppingcart">加入购物车</div>
          </div> -->
        </div>
      </div>
    </div>
    <div class="businesssTimeString"></div>
  </div>
  <div class="goods-bottom-opt">
    <div class="flex-box goods-bottom-bar">
      <div class="goods-opt-item flex-sub-box-2" style="width: 50%;">
        <div class="btn btn-orange buy-goods-directly router" data-router="shoppingCart">
          <span class="icon-shoppingcart">
            <span class="shop-num"></span>
          </span>
          ￥<span class="totalPrice">0.00</span>
        </div>
      </div>
      <div class="goods-opt-item flex-sub-box-2" style="width: 50%;">
        <div class="btn add-to-shoppingcart" data-router="tostorePayment">选好了</div>
      </div>
    </div>
  </div>
</div>
<script>
(function(){
  $('#tostoreDetail').on('click','.goods-add-num,.goods-min-num',function(){
      // 到店无规格加减加入到购物车
      var type = $(this).attr('data-type');
      APP.tostoreToShopcart(type);
  });

  var $tostoreDetail = $('#tostoreDetail');

$tostoreDetail.on('click', '.response-area-plus', function(){
  var $input = $(this).siblings('input'),
      num = Number($input.val()),
      $minusBtn = $(this).siblings('.minus'),
      $plusBtn = $(this).siblings('.plus');
      stock = Number($('#tostoreDetail .goods-rules .pay-goods-stock').text()) || 0;

  if($plusBtn.hasClass('disabled')){
    return;
  }
  $minusBtn.removeClass('disabled');

  if(num+1 > stock){
    alertTip('库存不足');
    $plusBtn.addClass('disabled');
    return;
  }
  // $input.val(num+1);
  APP.tostoreAddToShoppingCart('plus');
}).on('click', '.response-area-minus', function(){
  var $input = $(this).siblings('input'),
      num = Number($input.val()) || 1,
      $minusBtn = $(this).siblings('.minus'),
      $plusBtn = $(this).siblings('.plus');

  if($minusBtn.hasClass('disabled')){
    return;
  }
  $plusBtn.removeClass('disabled');
  // $input.val(num-1);
  if(num-1 <= 0){
    $minusBtn.addClass('disabled');
  }
  APP.tostoreAddToShoppingCart('mins');

}).on('click', '.subModel', function(){
  // 支付框里点击选择型号
  var models = $tostoreDetail.data('goods-info').model_items,
      modelLength = $tostoreDetail.find('.pay-goods-models dl').length,
      stock = 0,
      selectSub, subModelArr, length, price;

  $(this).addClass('select').siblings('.select').removeClass('select');
  selectSub = $tostoreDetail.find('.subModel.select');
  models.length && $.each(models, function(index, item){
    subModelArr = item.model.split(',');
    length = 0;
    $.each(selectSub, function(i, m){
      if(subModelArr.indexOf($(m).attr('data-id')) >= 0){
        length++;
      }
    });
    if(length === selectSub.length){
      stock += Number(item.stock);
      if(length === modelLength){
        price = item.price;
        $tostoreDetail.attr('model-items', item.id);
      }
    }
  });

  $tostoreDetail.find('.pay-goods-stock').text(stock);
  $tostoreDetail.find('.js-goods-price').text(price);
  $tostoreDetail.find('.pay-buy-count').val(0);
  $tostoreDetail.find('.minus, .plus').removeClass('disabled');

}).on('click','.add-to-shoppingcart',function(){
  var appId = GetQueryString('_app_id');
  if(!$(this).hasClass('noRouter')){
    return;
  }
  $.ajax({
    url: '/index.php?r=AppShop/precheckShoppingCart',
    type: 'POST',
    dataType: 'json',
    data: {
            app_id   : appId,
            sub_shop_app_id: GetQueryString('franchisee') || '',
            parent_shop_app_id: GetQueryString('franchisee') ? appId : ''
          },
    success:function(data){
      if(data.status != 0){
        confirmTip({content:data.data},function(){
          APP.turnToPage({
              router: 'shoppingCart'
            });
        });
      }
    }
  })
});



})();
</script>



    <style type="text/css">
	#tostorePayment {
		background: #f4f4f4;
	}
	#tostorePayment .goods-min-num,#tostorePayment .goods-add-num {
	  position:relative;
	  display:inline-block;
	  font-size:16px;
	  line-height:10px;
	  font-weight:700;
	  color:#666;
	  outline:0!important;
	  width:37px;
	  height:29px;
	  background-color:#fff;
	  border:1px solid #999;
	  text-indent:-9999px;
	  overflow:hidden;
	  vertical-align:middle;
	  width:20px;
	  height:20px;
	  line-height:20px;
	  font-weight:normal;
	  background-color:#ffcc01;
	  border-color:#ffcc01;
	  border-radius:50%;
	}
	#tostorePayment .goods-min-num {
	  background-color:#fff;
	  border-color:#333;
	}
	#tostorePayment .goods-min-num::before,#tostorePayment .goods-add-num::after {
	  position:absolute;
	  width:8px;
	  height:2px;
	  top:0;
	  left:0;
	  right:0;
	  margin:auto;
	  background-color:#6c6c6c;
	  bottom:0;
	  content:'';
	}
	#tostorePayment .goods-add-num::after {
	  position:absolute;
	  top:0;
	  bottom:0;
	  left:0;
	  right:0;
	  margin:auto;
	  content:'';
	  width:2px;
	  height:8px;
	  background-color:#6c6c6c;
	}
	#tostorePayment .goods-add-num::before {
	  position:absolute;
	  width:8px;
	  height:2px;
	  top:0;
	  left:0;
	  right:0;
	  margin:auto;
	  background-color:#6c6c6c;
	  bottom:0;
	  content:'';
	}
	#tostorePayment .goods-add-num::before,#tostorePayment .goods-add-num::after {
	  background-color:#fff;
	}

	#tostorePayment .tostorePayment-btn {
    display: inline-block;
    float: right;
    margin-top: 10px;
	}
	#tostorePayment .goods-list li>div{
		display: inline-block;
		vertical-align: top;
	}
	#tostorePayment .goods-list-title{
		margin-left: 10px;
		width: 100px;
	}
	#tostorePayment .goods-list li {
		margin-bottom: 5px;
	}
	#tostorePayment .goods-detail-section {
		padding: 10px 20px;
		background:#fdfdfd;
		margin-bottom:5px;
	}
	.sure-apply-box {
		background:#fdfdfd;
		text-align: center;
		padding: 10px 0;
	}
	#tostorePayment .goods-list-title p {
    text-overflow: ellipsis;
    overflow: hidden;
    white-space: nowrap;
	}
	#tostorePayment .goods-title-price{
		color:#ffca00;
	}
	#tostorePayment .goods-content textarea {
		width:100%;
		height:80px;
		border:none;
		background-color:#e9e7e8;
		outline: none;
		resize: none
	}
	#tostorePayment .goods-yuan {
    width: 25px;
    height: 25px;
    border-radius: 50%;
    background: #a4a0a1;
    display: inline-block;
	}
	#tostorePayment .goods-line {
    display: inline-block;
    width: 130px;
    height: 4px;
    background: #d2d2d2;
    margin-bottom: 30px;
	}
	#tostorePayment .good-eat-btn {
    width: 160px;
    margin: 10px auto;
    position: relative;
    height: 50px;
	}
	#tostorePayment .good-eat-btn > div {
		display: inline-block;
		position: absolute;
	}
	#tostorePayment .good-eat-title {
		display: block;
	}
	#tostorePayment .appointment-sure-time {
		margin-top: 10px;
		width: 100%;
    background: #d2d2d2;
    line-height: 40px;
    text-indent: 15px;
    position: relative;
	}
	#tostorePayment .appointment-time{
    margin-top: 20px;
    display: none;
	}
	#tostorePayment .hour-select,#tostorePayment .minute-select{
		display: inline-block;
		width: 40px;
		line-height: 30px;
		text-align: center;
		height: 30px;
	}
	#tostorePayment .time-select {
		margin-top: 10px;
		text-align: center;
	}
	.tostorePayment-phone {
		outline: none;
    border: 0;
    background: #e9e7e8;
    width: 100%;
    line-height: 34px;
    color: #000;
    font-size: 16px;
    margin-top: 10px;
    text-indent: 10px;
	}
	#tostorePayment .icon-rightarrow {
		float: right;
		font-size: 16px;
	}
	.preferential-way {
		width: 100%;
		height: 100%;
		position: absolute;
		top: 0;
		left: 0;
		outline: none;
		opacity: 0;
	}
	.sure-apply {
		width:180px;
		line-height:38px;
		font-size:14px;
		margin:0 auto;
		border-radius:5px;
		color:#000;
		background-color:#ffca00;
	}
	#tostorePayment .yuan-active{
		background: #ffca00;
	}
	#tostorePayment .goods-list-img img {
		width: 50px;
		height: 50px;
	}
	#tostorePayment .goods-sure-num{
		margin: 0 10px;
	}
	#tostorePayment .preferential-way-box {
		position: relative;
	}
	#tostorePayment .dialog-block-item {
    height: 71px;
	}
	#tostorePayment .pay-way {
    background-color: white;
    margin: 10px 0px;
	}
	#tostorePayment .preferential-way option {
		width: 100%
	}
	#tostorePayment .location-box input[type=radio] {
		-webkit-appearance: radio;
	}
	#tostorePayment .location-box {
		display: inline-block;
	}
	#tostorePayment .location-box label {
		margin-right: 10px;
	}
	#tostorePayment .tostore-location-contain {
		text-align: center;
	}
	#tostorePayment .locationSelect {
	    white-space: nowrap;
    	width: 50px;
	}
	#tostorePayment .limit-word {
	    font-size: 12px;
	    background: #e9e7e8;
	    margin-top: -14px;
	    text-align: right;
	    padding-right: 5px;
	    position: relative;
	    z-index: 10;
	}
	#tostorePayment .sale-businessTime{
		font-size: 12px;
		color: #ffcc01;
		margin-top: 2px;
	}
</style>
<div class="page" id="tostorePayment">
	<div>
		<ul class="goods-list">
			<!-- <li>
				<div class="goods-list-img">
					<img src="" style="width: 70px;height: 50px;background: #000;">
				</div>
				<div class="goods-list-title">
					<p>安乐</p>
					<p class="goods-title-price">$0.01</p>
				</div>
				<div class="tostorePayment-btn">
					<span class="goods-min-num" data-type="min"></span>
			        <span class="goods-sure-num">0</span>
			        <span class="goods-add-num" data-type="add"></span>
				</div>
			</li> -->
		</ul>
	</div>
	<div class="goods-content goods-detail-section">
		<p>备注</p>
		<textarea oninput="inputWord(event)"></textarea>
		<div class="limit-word"><span>0</span>/30</div>
	</div>
	<div class="goods-eat-kind goods-detail-section">
		<p>就餐方式</p>
		<div class="good-eat-btn">
			<div style="left: 0;z-index: 10;">
				<span class="goods-yuan yuan-active" data-way="1"></span>
				<span class="good-eat-title">点餐</span>
			</div><div class="goods-line" style="top: 10px;left: 10px;"></div><div style="right: 0;">
				<span class="goods-yuan order-good" data-way="2"></span>
				<span class="good-eat-title">预约</span>
			</div>
		</div>
		<div class="appointment-time">
			<p>请点击选择取餐时间</p>
			<p class="sale-businessTime"></p>
			<div class="time-select">
				<select class="hour-select">
					<option selected="selected">00</option><option>01</option><option>02</option><option>03</option><option>04</option><option>05</option><option>06</option><option>07</option><option>08</option><option>09</option><option>10</option><option>11</option><option>12</option><option>13</option><option>14</option><option>15</option><option>16</option><option>17</option><option>18</option><option>19</option><option>20</option><option>21</option><option>22</option><option>23</option>
				</select><span style="margin: 0 10px;">:</span><select class="minute-select">
					<option selected="selected">00</option><option>01</option><option>02</option><option>03</option><option>04</option><option>05</option><option>06</option><option>07</option><option>08</option><option>09</option><option>10</option><option>11</option><option>12</option><option>13</option><option>14</option><option>15</option><option>16</option><option>17</option><option>18</option><option>19</option><option>20</option><option>21</option><option>22</option><option>23</option><option>24</option><option>25</option><option>26</option><option>27</option><option>28</option><option>29</option><option>30</option><option>31</option><option>32</option><option>33</option><option>34</option><option>35</option><option>36</option><option>37</option><option>38</option><option>39</option><option>40</option><option>41</option><option>42</option><option>43</option><option>44</option><option>45</option><option>46</option><option>47</option><option>48</option><option>49</option><option>50</option><option>51</option><option>52</option><option>53</option><option>54</option><option>55</option><option>56</option><option>57</option><option>58</option><option>59</option>
				</select>
			</div>
		</div>
		<div class="tostore-location-contain">
			<p style="text-align: left;margin-bottom: 10px;">就餐位置</p>
			<div class="location-box">
				<label class="location-specialId" style="display: none;">
					<input name="locationName" value="2" type="radio"><span class="special-title"></span>
				</label>
				<label>
					<input name="locationName" value="0" checked="checked" type="radio">自取
				</label>
				<label>
					<input name="locationName" value="1" type="radio">其他位置
				</label>
			</div>
			<select class="locationSelect">
				<!-- <option>1号桌</option> -->
			</select>
		</div>
	</div>
	<div class="goods-detail-section preferential-way-box">
		<span>优惠方式：</span>
		<span class="icon-rightarrow"></span>
		<select class="preferential-way">
			<!-- <option></option> -->
		</select>
		<span class="tostore_benefit"></span>
	</div>
	<div class="goods-detail-section" style="padding: 15px 20px;">
		<div>
			<span>使用储值金:</span>
			<div class="switch-btn pull-right">
        <input class="preview-goods-switch-input" checked="checked" type="checkbox">
        <label class="switch-btn-inner"></label>
      </div>
		</div>
		<div class="preview-balance-deduction-section" style="margin-top: 10px;">
			<span>储值金抵扣</span>
			<span class="pull-right">- ￥ <span class="preview-goods-use-balance"></span></span>
		</div>
	</div>
	<div class="goods-detail-section" style="margin: 0;">
		<p>手机号码（必填）：</p>
		<input name="" class="tostorePayment-phone" type="text">
	</div>
	<div class="dialog-block-item pay-way">
      <div class="orderDetail-payment"><img src="app_data/weixin.jpg"><span class="pull-right orderDetail-check-box check-box checked" payment="0"><img src="app_data/checked.png"></span></div>
      <div class="orderDetail-payment" payment="zfb"><img src="app_data/zhifubao.jpg"><span class="pull-right orderDetail-check-box check-box" payment="1"><img src="app_data/checked.png"></span></div>
  </div>
	<div class="sure-apply-box">
		<div class="sure-apply">确认支付 ￥<span class="tostorePayment-price">0.00</span></div>
	</div>
	<p style="font-size: 12px;color: #f00;text-align: center;margin-top: -5px;background-color: #fff;">* 暂不支持退款</p>
</div>
<script type="text/javascript">
	(function(){
		var appId = GetQueryString('_app_id');
	$('#tostorePayment').on('click','.goods-yuan',function(){
		if($(this).hasClass('yuan-active')){return;}
		$(this).addClass('yuan-active').closest('div').siblings().find('.goods-yuan').removeClass('yuan-active');
		if($('.order-good').hasClass('yuan-active')){
			$('.appointment-time').show();
			$('.tostore-location-contain').hide();
			var good_ids = [];
			$.each($('#tostorePayment .goods-list li'),function(index,el){
				good_ids.push($(el).attr('goods-id'));
			})
			$.ajax({
				url: '/index.php?r=AppShop/getAvaliableTostoreAppointBusinessTime',
				type: 'POST',
				dataType: 'json',
				data: {
					app_id: appId,
					good_ids: good_ids
				},
				success:function(data){
					if(data.status != 0){
						alertTip(data.data)
						return;
					}
				  if (data.data.length) {
            var businesssTimeString = '';
            for (var i = 0; i < data.data.length; i++) {
              businesssTimeString += data.data[i].start_time.substring(0, 2) + ':' + data.data[i].start_time.substring(2, 4) + '-' + data.data[i].end_time.substring(0, 2) + ':' + data.data[i].end_time.substring(2, 4) + '/';
            }
            businesssTimeString = '可预约时间：' + businesssTimeString.substring(0, businesssTimeString.length - 1);
           	$('#tostorePayment .sale-businessTime').text(businesssTimeString);
          }
				}
			});

		}else{
			if($('.tostore-location-contain').attr('data-length') != 0){
				$('.tostore-location-contain').show();
			}
			$('.appointment-time').hide();
		}
	}).on('click','.goods-add-num,.goods-min-num',function(){
      var type = $(this).attr('data-type'),
      		_this = $(this);
      APP.tostorePaymentToShopcart(type,_this);
  }).on('click','.sure-apply',function(){
  	if( $('#tostorePayment .goods-content textarea').val().length > 30){
  		alertTip('备注字数超过30');
  		return;
  	}
      APP.tostoreAddCartOrder();
  }).on('click', '.orderDetail-check-box', function() {
      $('.orderDetail-check-box.checked').removeClass('checked');
      $(this).addClass('checked');
  }).on('change','.preferential-way',function(){
  	$('#tostorePayment .tostore_benefit').text($('.preferential-way option:checked').text());
  	APP.preferentialWay();
  }).on('change', 'preview-goods-switch-input', function(){
		_tostorePayment = APP.OfficialPages['tostore-payment'];

    if($(this).prop('checked')){
      _tostorePayment.is_balance = 1;
      $('#tostorePayment .preview-balance-deduction-section').show();
    } else {
      _tostorePayment.is_balance = 0;
      $('#tostorePayment .preview-balance-deduction-section').hide();
    }
    _tostorePayment.GetCartCanUseBenefit();
	})
})();

function inputWord(evt){
	$('.limit-word span').text(evt.target.value.length);
	if(evt.target.value.length > 30){
		$('.limit-word').css('color','red');
	}else{
		$('.limit-word').css('color','');
	}
}

</script>
    <style type="text/css">
	#tostoreComplete {
		height: 100%;
  	background: #efeff5;
	}
	/* 默认区域 */
	#tostoreComplete .normal-area {
		display: none;
		text-align: center;
		border: 1px solid #fff;
    text-align: center;
    background: #fff;
	}
	#tostoreComplete .normal-area .compelet-img {
		background: #008000;
    width: 100px;
    height: 100px;
    line-height: 100px;
    border-radius: 50%;
    margin: 0 auto;
    text-align: center;
    margin-top: 100px;
	}
	#tostoreComplete .normal-area .compelet-img img {
		vertical-align: middle;
	}
	#tostoreComplete .normal-area .paySuccess-queue-num {
		font-size: 16px;
		color: red;
	}
	#tostoreComplete .normal-area .paySuccess-tip {
		margin-top: 15px;
	}
	#tostoreComplete .normal-area .paySuccess-detail {
		margin-top: 10px;
    margin-bottom: 20px;
    text-align: center;
    color: #818181;
	}
	#tostoreComplete .normal-area .paySuccess-detail>div {
		line-height: 30px;
	}
	/* 有集集乐的页面 */
	#tostoreComplete .has-collect-benefit {
		display: none;
	}
	#tostoreComplete .has-collect-benefit .pay-success-item {
		margin-bottom: 15px;
    height: 50px;
    background-color: #fff;
	}
	#tostoreComplete .has-collect-benefit .pay-success-item .icon {
		display: inline-block;
    margin: 10px;
    width: 30px;
    height: 30px;
    line-height: 30px;
    text-align: center;
    vertical-align: top;
    background: #55b737;
    border-radius: 50%;
	}
	#tostoreComplete .has-collect-benefit .pay-success-item .icon img {
		width: 18px;
    height: 15px;
    margin-top: 8px;
	}
	#tostoreComplete .has-collect-benefit .pay-success-item .text {
		display: inline-block;
		margin-top: 16px;
		vertical-align: top;
		color: #55b737;
	}
	#tostoreComplete .has-collect-benefit .to-store-area {
		margin-bottom: 15px;
		border-top: 1px solid #efeff5;
		color:#818181;
	}
	#tostoreComplete .has-collect-benefit .info-item {
		position: relative;
    height: 42px;
    line-height: 42px;
    background-color: #fff;
    border-bottom: 1px solid #efeff5;
	}
	#tostoreComplete .has-collect-benefit .info-item .item-name {
		position: absolute;
    top: 0;
    left: 0;
    display: inline-block;
    margin-left: 20px;
    text-align: left;
	}
	#tostoreComplete .has-collect-benefit .info-item .item-content {
		position: absolute;
    top: 0;
    right: 0;
    display: inline-block;
    margin-right: 20px;
    text-align: right;
    color: #000;
	}
	#tostoreComplete .has-collect-benefit .info-item .item-content.queue-num {
		color: #c72b22;
	}
	/* 集集乐区域 */
	#tostoreComplete .collect-benefit-area {
		background: #fff;
		color:#818181;
	}
	#tostoreComplete .collect-item {
		position: relative;
		width: 100%;
		border-bottom: 1px solid #ddd;
		overflow:hidden;
	}
	#tostoreComplete .collect-item .star-num {
		margin: 10px 20px 15px;
	}
	#tostoreComplete .collect-item .star-list {
		margin: 0 auto 10px;
    width: 195px;
    text-align: left;
    font-size: 0;
	}
	#tostoreComplete .collect-item .star-list .star-item {
		display: inline-block;
    width: 30px;
    height: 30px;
    margin-right: 15px;
    margin-bottom: 10px;
	}
	#tostoreComplete .collect-item .star-list .star-item:nth-of-type(4n-3) {
		margin-left: 15px;
	}
	#tostoreComplete .collect-item .star-full {
		position: absolute;
    top: -12px;
    right: -12px;
    transform: rotate(-25deg);
    padding: 4px;
    border: 1px solid #fd888a;
    border-radius: 50%;
	}
	#tostoreComplete .collect-item .star-full-text {
		width: 40px;
    height: 40px;
    line-height: 40px;
    font-size: 23px;
    text-align: center;
    color: #fd888a;
    border: 1px solid #fd888a;
    border-radius: 50%;
	}
	#tostoreComplete .collect-benefit-area .tip-item {
		line-height: 20px;
    padding: 10px 20px;
	}
	/* 按钮区域 */
	#tostoreComplete .btn-area {
		display: none;
	}
	#tostoreComplete .btn-area .finish-btn {
		display: block;
    margin: 15px 15px 0;
    height: 38px;
    line-height: 38px;
    background-color: #ffc504;
    text-align: center;
    color: #000;
    border-radius: 5px;
	}
	#tostoreComplete .btn-area .check-order-btn {
		display: block;
    margin: 10px 15px 0;
    height: 38px;
    line-height: 38px;
    border: 1px solid #e5e6ea;
    background-color: #fff;
    text-align: center;
    color: #000;
    border-radius: 5px;
	}
</style>
<div class="page" id="tostoreComplete">
	<div class="normal-area">
		<div class="compelet-img">
			<img src="app_data/checked.png">
		</div>
		<div class="paySuccess-tip">支付成功</div>
		<div class="paySuccess-detail">
      <div>您的取餐号为: <span class="queue-num"></span></div>
      <div>大约<span class="duration-time"></span>分钟后至取餐处取餐</div>
      <div>请在预约取餐时间<span class="appointment-time"></span>至取餐处取餐</div>
    </div>
	</div>
	<div class="has-collect-benefit">
		<div class="pay-success-item">
      <div class="icon">
				<img src="app_data/checked.png">
			</div>
      <div class="text">支付成功</div>
    </div>
		<div class="to-store-area">
			<div class="info-item">
        <div class="item-name">取餐号码：</div>
        <div class="item-content queue-num"></div>
      </div>
      <div class="info-item">
        <div class="item-name">取餐时间：</div>
        <div class="item-content">大约<span class="duration-time"></span>分钟后取餐</div>
        <div class="item-content">请在预约取餐时间<span class="appointment-time"></span>取餐</div>
      </div>
      <div class="info-item">
        <div class="item-name">就餐方式：</div>
        <div class="item-content dine-way-1">点餐</div>
        <div class="item-content dine-way-2">预约</div>
      </div>
		</div>
		<div class="collect-benefit-area">
      <div class="collect-item">
        <div class="star-num">集集乐个数: <span class="star-number"></span></div>
        <div class="star-list"></div>
        <div class="star-full">
          <div class="star-full-text">满</div>
        </div>
      </div>
      <div class="tip-item">
        <div class="full-tip">获得一张<span class="collect-reward"></span></div>
        <div class="no-full-tip">消费每满<span class="collect-value"></span>元，累计一颗星，集满可获得<span class="collect-reward"></span>一张</div>
      </div>
    </div>
	</div>
	<div class="btn-area">
		<div class="finish-btn">完成</div>
		<div class="check-order-btn">查看订单</div>
	</div>
</div>
<script type="text/javascript">
	(function(){
		$('#tostoreComplete').on('click','.finish-btn',function(){
			APP.turnToPage({
					router: APP.getHomepageRouter()
			});
		}).on('click','.check-order-btn',function(){
			var _this = $(this);
			APP.turnToPage({
					router: 'tostoreOrderDetail',
					detail: _this.attr('data-order-id')
			});
		})
})();
</script>
    <style rel="stylesheet">
#tostoreOrderDetail {
    font-size: 12px;
    background-color: #eee;
}
#tostoreOrderDetail .page-top-nav {
    position: static;
    margin: 0;
}

#tostoreOrderDetail .orderDetail-section {
    background-color: #fff;
    padding: 12px 15px;
}

#tostoreOrderDetail .orderDetail-section:last-child {
    margin-bottom: 0;
}

#tostoreOrderDetail .right-arrow-bar {
    line-height: 18px;
}

.orderDetail-pay-count {
    color: #d20e10;
}

.orderDetail-btn-status > span {
    display: inline-block;
    margin-top: 10px;
    margin-left: 10px;
}

.orderDetail-payment {
    margin: 5px 15px 0;
}

.orderDetail-payment > img {
    width: 80px;
}

#tostoreOrderDetail .check-box {
    margin-top: 3px;
}

#tostoreOrderDetail .list-goods-cover {
    position: absolute;
    left: 0;
    width: 60px;
    height: 60px;
}

#tostoreOrderDetail .list-goods-title {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}
#tostoreOrderDetail .list-goods-content .list-goods-model {
    color: #aaa;
}

.payPage-wrap {
    background-color: #eee;
}


/*-----------------------陈飞 2016-11-02---------------------*/

#tostoreOrderDetail .pay-way {
    background-color: white;
    margin: 5px 0px;
}

#tostoreOrderDetail .check-box.checked {
    background-color: #ff7100;
}

#tostoreOrderDetail .list-goods-content {
    position: absolute;
    left: 70px;
    top: 8px;
    text-overflow: ellipsis;
    width: 224px;
}

#tostoreOrderDetail .list-goods-right {
    position: absolute;
    top: 51px;
    left: 70px;
    width: 224px;
}

#tostoreOrderDetail .list-goods-right p:first-child {
    float: left;
}

#tostoreOrderDetail .list-goods-right .quantity {
    float: right;
}

.orderDetail-order-list .dialog-block-item {
    height: 71px;
}

.orderDetail-order-list .quantity .plus:after,
.orderDetail-order-list .quantity .minus:before,
.orderDetail-order-list .quantity .plus:before,
.orderDetail-order-list .quantity .minus.disabled:before,
.orderDetail-order-list .quantity .plus.disabled:after,
.orderDetail-order-list .quantity .plus.disabled:before {
    background-color: #C7091B;
}


.leavemsg-wrap div {
    margin: 0 auto;
    position: relative;
    margin-top: 10px;
    margin-bottom: 10px;
}

.leavemsg-wrap input[type="text"] {
    max-width: 100%;
    height: 40px;
    border: 1px solid #DDD;
    text-indent: 10px;
    width: 100%;
}

.leavemsg-wrap .leavePicForSeller {
    height: 100px;
}

.btn_addPic {
    display: block;
    position: relative;
    width: 80px;
    height: 80px;
    overflow: hidden;
    border: 1px solid #EBEBEB;
    background: none repeat scroll 0 0 #F3F3F3;
    color: #999999;
    cursor: pointer;
    text-align: center;
    text-decoration: none;
    float: left;
    /* top: 50%;
    -webkit-transform: translateY(-50%);
    -moz-transform: translateY(-50%);
    -ms-transform: translateY(-50%);
    transform: translateY(-50%);*/
    top: 16px;
}

.filePrew {
    display: block;
    position: absolute;
    top: 0;
    left: 0;
    width: 140px;
    height: 39px;
    font-size: 100px;
    /* 增大不同浏览器的可点击区域 */
    opacity: 0;
    /* 实现的关键点 */
    filter: alpha(opacity=0);
    /* 兼容IE */
}

.btn_addPic img {
    position: absolute;
    width: 50px;
    height: 50px;
    left: 50%;
    top: 50%;
    -webkit-transform: translate(-50%, -50%);
    -moz-transform: translate(-50%, -50%);
    -ms-transform: translate(-50%, -50%);
    transform: translate(-50%, -50%);
}

.imgList {
    float: right;
    height: 100px;
    width: 200px;
    overflow: auto;
    top: 5px;
}

.imgList a {
    display: block;
    float: left;
    height: 90px;
    width: 90px;
    background: #EEE;
    margin-left: 10px;
    margin-top: 5px;
    position: relative;
}

.imgList a img {
    width: 70px;
    height: 70px;
    padding: 10px;
}

.imgList a span{
    position: absolute;
    right: -5px;
    display: block;
    top: -1px;
    border-radius: 50%;
    height: 20px;
    width: 20px;
    text-align: center;
    line-height: 20px;
    color: #fff;
    font-size: 23px;
    background-color: #d9534f;
    cursor: pointer;
    display: none;
}

.broadcast-img-dele {
    display: none;
    position: absolute;
    top: 0;
    right: 0;
    width: 24px;
    height: 24px;
    border-radius: 50%;
    color: #fff;
    font-size: 23px;
    line-height: 24px;
    background-color: #d9534f;
}
.appointmentInfo {
    display:none;
}
#discountDialog .discount-list{
    max-height: 300px;
    overflow: auto;
}
#discountDialog .discount-list ul li {
    list-style: none;
    text-align: center;
    font-size: 15px;
    padding-top: 10px;
    padding-bottom: 10px;
    border-bottom: 1px solid #EEE;
}
#tostoreOrderDetail .select-discount .icon-rightarrow{
    float: right;
    height: 24px;
    line-height: 24px;
}
#tostoreOrderDetail .orderDetail-balance {
    display: inline-block;
}
#tostoreOrderDetail .freight-loation label{
    margin-right: 10px;
}
#tostoreOrderDetail .radio-box {
    display: inline-block;
    width: 20px;
    height: 20px;
    padding: 4px 3px;
    margin-right: 6px;
    box-sizing: border-box;
    border-radius: 50%;
    line-height: 13px;
    background-color: #c7c4c4;
}
#tostoreOrderDetail .radio-box img {
    width: 100%;
}
#tostoreOrderDetail .radio-box.checked {
    background-color: #C40B1D;
}
#tostoreOrderDetail .freight-since{
    display: none;
}
#tostoreOrderDetail .icon-location,#tostoreOrderDetail .icon-phone {
    display: inline-block;
}
#tostoreOrderDetail .freight-loation-phone {
    margin: 10px 0;
    display: inline-block;
}
#tostoreOrderDetail .freight-loation-name {
    text-decoration: underline;
    white-space: nowrap;
    text-overflow: ellipsis;
    display: inline-block;
    width: 90%;
    overflow: hidden;
}
.tostoreOrange {
    color: #ff8927;
}
.btn-yellow {
    background: #ffcc01;
}
#tostoreOrderDetail .tostoreBenefit {
  margin-bottom: 2px;
}
</style>
<div class="orderDetail-wrap page" id="tostoreOrderDetail">
    <div class="orderDetail-section">
        <div style="margin-bottom:4px;">订单状态：<span class="orderDetail-status tostoreOrange"></span></div>
        <div>订单号：<span class="orderDetail-order-id"></span></div>
    </div>

    <div class="dialog-block-item pay-way">
        <div class="orderDetail-payment"><img src="app_data/weixin.jpg"><span class="pull-right orderDetail-check-box check-box checked" payment="0"><img src="app_data/checked.png"></span></div>
        <div class="orderDetail-payment" payment="zfb"><img src="app_data/zhifubao.jpg"><span class="pull-right orderDetail-check-box check-box" payment="1"><img src="app_data/checked.png"></span></div>
    </div>

    <div class="orderDetail-section">
        <div style="display: none;">取餐号：<span class="tostoreNum"></span></div>
        <div>取餐时间：<span class="tostoreAppointmentTime"></span></div>
    </div>
    <div class="orderDetail-section">
        <div>就餐方式：<span class="tostoreType"></span><span class="appointmentInfo orderDetail-appo-time"></span></div>
        <div>位置信息：<span class="tostoreLocation"></span></div>
    </div>
    <div class="orderDetail-section">
        <div>手机号码：<span class="tostoreBuyerPhone"></span></div>
        <div>备注信息：<span class="tostoreRemark"></span></div>
    </div>
    <div class="orderDetail-section" style="margin-bottom: 0;">
        <ul class="orderDetail-order-list">

        </ul>
    </div>
    <div class="dialog-block-item tostoreBenefit orderDetail-section">
        <div class="select-discount">店铺优惠<span class="pull-right discount-type">暂无优惠</span></div>
        <div>优惠抵扣<span class="pull-right">￥<span class="orderDetail-benefit-deduction"></span></span></div>
        <div>储值抵扣<span class="pull-right">￥<span class="orderDetail-balance-deduction"></span></span></div>
    </div>
    <div class="orderDetail-section" style="padding-bottom: 0;margin-bottom: 0;">
        <div style="border-bottom: 1px solid #dedede;padding-bottom: 8px;">商品金额<span class="pull-right">￥<span class="orderDetail-total-price"></span></span></div>
    </div>
    <div class="orderDetail-section" style="padding-bottom: 0;margin-bottom: 0;">
        <div>下单时间<span class="pull-right addtime"></span></div>
        <div style="border-bottom: 1px solid #dedede;padding-bottom: 8px;">实付价格<span class="pull-right realTotalPrice tostoreOrange"></span></div>
    </div>
    <div class="orderDetail-section">
       <div class="txt-c orderDetail-btn-status"></div>
    </div>
</div>
<script>
(function() {
    $("#tostoreOrderDetail #tostoreisUseBalancePay").click(function(){
        tostoreisUseBalance(Number($(this).is(':checked')));
    });

    var appId = GetQueryString('_app_id');

    // function getTotalMoney(){
    //     var totalMoney=0;
    //     $.each($(".list-goods-right p:first-child"),function(index,ele){
    //         totalMoney+=Number($(ele).attr('data-price'));
    //     });
    //     return totalMoney;
    // }
    $('#tostoreOrderDetail').on("keyup",".pay-buy-count",function(){
        var $input=Number($(this).val());
        var $price=Number($(this).attr("data-price"));
        var stock=Number($(".response-area-plus").attr("data-stock"));
        if(typeof $input=="number" && !isNaN($input)){
            if($input>stock){
                $(this).val(stock);
                $input=stock;
                $(".response-area-plus").siblings('.plus').addClass('disabled');
            }else if($input<1){
                $(this).val(1);
                $input=1;
                $('.response-area-minus').siblings('.minus').addClass('disabled');
            }
            var totalPrice = $input*$price;
            $(this).closest(".list-goods-right").find("p:first-child").text("￥" + totalPrice);
            $(".orderDetail-total-price").text(getTotalMoney().toFixed(2));
            $(".orderDetail-cancel-order").text("应付金额:￥" + getTotalMoney().toFixed(2));
        }else{
            alertTip("请输入正确的数量!");
            $(this).val(1);
            totalPrice=1*$price;
            $(this).closest(".list-goods-right").find("p:first-child").text("￥" + totalPrice);
            $(".orderDetail-total-price").text(getTotalMoney().toFixed(2));
            $(".orderDetail-cancel-order").text("应付金额:￥" + getTotalMoney().toFixed(2));
        }
    }).on("click", ".response-area-plus", function() {
        var $input = $(this).siblings('input'),
            num = Number($input.val()),
            $minusBtn = $(this).siblings('.minus'),
            $plusBtn = $(this).siblings('.plus'),
            stock = Number($(this).attr("data-stock"));
        if ($plusBtn.hasClass('disabled') && num>=stock) {
            $input.val(stock);
            return;
        }
        $minusBtn.removeClass('disabled');
        $input.val(num + 1);
        if (num + 1 == stock) {
            $plusBtn.addClass('disabled');
        }
        var totalPrice = Number($input.val()) * Number($(this).attr("data-price"));
        $(this).closest(".list-goods-right").find("p:first-child").attr('data-price', totalPrice);
        $(".orderDetail-total-price").text(getTotalMoney().toFixed(2));
        $(".orderDetail-cancel-order").text("应付金额:￥" + getTotalMoney().toFixed(2));
    }).on('click', '.response-area-minus', function() {
        var $input = $(this).siblings('input'),
            num = Number($input.val()) || 1,
            $minusBtn = $(this).siblings('.minus'),
            $plusBtn = $(this).siblings('.plus');

        if ($minusBtn.hasClass('disabled') && num ==1) {
            return;
        }
        $plusBtn.removeClass('disabled');
        if (num - 1 < 1) {
            $input.val(1);
            $minusBtn.addClass('disabled');
        }else{
             $input.val(num - 1);
        }
        var totalPrice = Number($input.val()) * Number($(this).attr("data-price"));
        $(this).closest(".list-goods-right").find("p:first-child").attr('data-price', totalPrice);
        $(".orderDetail-total-price").text(getTotalMoney().toFixed(2));
        $(".orderDetail-cancel-order").text("应付金额:￥" + getTotalMoney().toFixed(2));
    }).on('click', '.orderDetail-address-detail', function() {
        // APP.showAddressDialog();

    }).on('click', '.orderDetail-check-box', function() {
        $('.orderDetail-check-box.checked').removeClass('checked');
        $(this).addClass('checked');

    }).on('click', '.orderDetail-radio-box', function() {
        // 运费单选框
        $('.orderDetail-radio-box.checked').removeClass('checked');
        $(this).addClass('checked');
        if($(this).attr('locaionRadio') == 2){
            freightWay(1);
            $('#tostoreOrderDetail .freight-since').show();
            $('#tostoreOrderDetail .orderDetail-address-detail').hide();
        }else{
            freightWay(0)
            $('#tostoreOrderDetail .freight-since').hide();
            $('#tostoreOrderDetail .orderDetail-address-detail').show();
        }

    }).on('click', '.orderDetail-pay-directly', function() {
        //看是否在出售时间
        var cartId = [];
        $.each($('#tostoreOrderDetail .orderDetail-order-list li'),function(index,item){
          cartId[index] = {'goods_id':$(item).attr('data-goodsid')}
        })
        // 支付
        var id = $('.orderDetail-order-id').text().trim(),
            payment = $('.orderDetail-payment').find('.orderDetail-check-box.checked').attr('payment');

        if (!id) {
            alertTip('order id undefined');
            return;
        }
        var additional_info={};
        $("#tostoreOrderDetail .leavemsg-wrap").each(function(index,element){
            var tempgoodsId=$(element).attr("data-goodsId");
            additional_info[tempgoodsId]=[];
            $(element).find("div").not(".imgList").each(function(index,ele){
                var obj={};
                obj.title=$(ele).attr("data-value");
                if($(ele).hasClass("leavePicForSeller")){
                    var temp=[];
                    $(ele).find(".imgList img").each(function(index,e){
                        temp.push($(e).attr("src"));
                    });
                    obj.value=temp;
                    obj.type="picture";
                }else{
                    obj.value=$(ele).find("input").val();
                    obj.type="text";
                }
                additional_info[tempgoodsId].push(obj);
            });
        });
        if(!$.isEmptyObject(additional_info)){
          saveLeaveMessage(id,additional_info);
        }
        console.log("添加用户留言信息");
        //执行一个请求函数保存用户给卖家的留言
        function saveLeaveMessage(order_id,info){
          $.ajax({
              url:"/index.php?r=AppShop/SetAdditional",
              type:"POST",
              data:{
                  order_id:order_id,
                  additional_info:info
              },
              dataType:"JSON",
              success:function(data){
                  console.log(data);
              },
              error:function(data){
                  alertTip(data.data)
              }
          });
        }
        // 支付成功回调
        function paySuccessCallback(){
            if(!GetQueryString('franchisee')){
                $.ajax({
                url: '/index.php?r=AppMarketing/CheckAppCollectmeStatus',
                type: 'get',
                data: {
                    'app_id': appId,
                    'order_id': id
                },
                dataType: 'json',
                success: function(res){
                    var collectBenefit = '';
                    if(res.valid == 0){
                        collectBenefit = 1;
                    }
                    APP.turnToPage({
                        router: 'tostoreComplete',
                        detail: id,
                        franchisee: GetQueryString('franchisee'),
                        collectBenefit: collectBenefit,
                        redirect: true
                    });
                }
                });
            } else {
                APP.turnToPage({
                router: 'tostoreComplete',
                detail: id,
                franchisee: GetQueryString('franchisee'),
                redirect: true
                });
            }
        }
        if ($('.realTotalPrice').text().trim() == 0) {
            $.ajax({
                url: '/index.php?r=AppShop/paygoods',
                type: 'get',
                dataType: 'json',
                data: {
                    app_id: appId,
                    order_id: id,
                    total_price: 0
                },
                success: function(res){
                    if(res.status!=0){
                        alertTip(res.data);
                        return;
                    }
                    alertTip('支付成功', function(){
                        paySuccessCallback();
                    });
                }
            });
            return;
        }

        $.ajax({
          url:"/index.php?r=AppShop/payTostoreOrder",
          type:"POST",
          data:{
            app_id:appId,
            parent_shop_app_id: GetQueryString('franchisee') ? appId:'',
            sub_app_ip: GetQueryString('franchisee') || '',
            cart_arr:cartId
          },
          dataType:"JSON",
          success:function(data){
            if(data.status != 0){
              alertTip(data.data);
              return;
            }


            if (payment == 1) {
            // 支付宝支付
            window.open('/index.php?r=AppShop/getUniPay&order_id=' + id + '&payment_id=1');
            } else {
                // if(navigator.userAgent.toLowerCase().match(/MicroMessenger/i) == 'micromessenger'){
                //   // 用微信打开应用时 调用微信支付
                //   $.ajax({
                //     url: '/index.php?r=AppShop/GetWxWebappPaymentCode',
                //     data: {
                //       order_id: id,
                //       app_id: appId,
                //     },
                //     dataType: 'json',
                //     success: function (res) {
                //       if (res.status !== 0) {
                //         alertTip(res.data);
                //         return;
                //       }
                //       var param = res.data;

                //       wx.chooseWXPay({
                //         'timeStamp': param.timeStamp,
                //         'nonceStr': param.nonceStr,
                //         'package': param.package,
                //         'signType': 'MD5',
                //         'paySign': param.paySign,
                //         success: function(res){
                //           APP.turnToPage({
                //             router: 'orderDetail',
                //             detail: id,
                //             franchisee: GetQueryString('franchisee')
                //           })
                //         },
                //         fail: function(res){
                //           alert('fail ---- '+JSON.stringify(res));
                //         },

                //       })
                //     }
                //   })
                // } else {
                  APP.turnToPage({
                      router: 'payPage'
                  });
                // }
            }

          },
          error:function(data){
            alertTip(data.data)
            return;
          }
        });

    }).on('click', '.orderDetail-make-comment', function() {
        APP.turnToPage({
            router: 'makeComment',
            detail: $('.orderDetail-order-id').text().trim(),
            franchisee: GetQueryString('franchisee')
        });

    }).on('click', '.orderDetail-check-logistics', function() {
        APP.turnToPage({
            router: 'logisticsPage',
            detail: $('.orderDetail-order-id').text().trim(),
            franchisee: GetQueryString('franchisee')
        });

    }).on('click', '.orderDetail-sure-receipt,.orderDetail-apply-drawback, .orderDetail-receive-drawback', function() {
        // 确认收货、取消订单、申请退款
        var id = $('.orderDetail-order-id').text().trim(),
            text, url;

        if ($(this).hasClass('orderDetail-sure-receipt')) {
            text = '确认已收到货物？';
            url = 'AppShop/comfirmOrder';
        } else if ($(this).hasClass('orderDetail-cancel-order')) {
            text = '确认取消订单？';
            url = 'AppShop/cancelOrder';
        } else if ($(this).hasClass('orderDetail-apply-drawback')) {
            text = '确认要申请退款？';
            url = 'AppShop/applyRefund';
        } else if ($(this).hasClass('orderDetail-receive-drawback')) {
            text = '确认已收到退款？';
            url = 'AppShop/comfirmRefund';
        }

        confirmTip({
            content: text
        }, function() {
            updateOrder(id, url);
        });

    }).on('click', '.orderDetail-verification-code', function(){
        APP.turnToPage({
            router: 'verificationCodePage',
            detail: $('.orderDetail-order-id').text().trim(),
            sub_shop_app_id: GetQueryString('franchisee')
        });
    });
    // 更新订单状态
    function updateOrder(orderId, url) {
        if (!url) {
            alertTip('controller/action undefined');
            return;
        }
        if (!orderId) {
            alertTip('order id undefined');
            return;
        }

        $.ajax({
            url: '/index.php?r=' + url,
            type: 'get',
            data: {
                app_id:appId,
                order_id: orderId,
                sub_shop_app_id: GetQueryString('franchisee')
            },
            dataType: 'json',
            success: function(data) {
                if (data.status !== 0) {
                    alertTip(data.data);
                    return;
                }
                APP.turnToPage({
                    router: 'tostoreOrderDetail',
                    detail: GetQueryString('detail'),
                    franchisee: GetQueryString('franchisee')
                }, 'refresh');
            }
        });
    }



})();
</script>

    <style rel="stylesheet">
    .verificationCodePage-wrap {
        position: relative;
        background-color: #fff;
        text-align: center;
    }
    .verification-code-area {
        position: absolute;
        top: 50%;
        left: 50%;
        margin-top: -100px;
        margin-left: -75px;
        width: 150px;
    }
    .verification-code-img {
        width: 150px;
        height: 150px;
    }
    .verification-code-text {
        font-size: 16px;
    }
    .verification-code-finished {
        display: none;
        position: absolute;
        top: -5px;
        right: -5px;
        border: 2px solid #ff0000;
        border-radius: 50%;
        width: 50px;
        height: 50px;
        transform: rotate(30deg);
    }
    .verification-code-finished>span{
        display: inline-block;
        border: 1px solid #ff0000;
        color: #ff0000;
        border-radius: 50%;
        font-size: 12px;
        width: 40px;
        height: 40px;
        line-height: 40px;
        margin-top: 4px;
        text-align: center;
    }
    .verification-code-area.finished .verification-code-img,
    .verification-code-area.finished .verification-code-text {
        opacity: 0.3;
    }
    .verification-code-area.finished .verification-code-finished {
        display: block;
    }
</style>
<div class="page verificationCodePage-wrap" id="verificationCodePage">
    <div class="verification-code-area">
        <img class="verification-code-img">
        <div class="verification-code-text">
            <span>核销码:</span>
            <span class="num"></span>
        </div>
        <div class="verification-code-finished">
            <span>已完成</span>
        </div>
    </div>
</div>
    <style rel="stylesheet">
#transferPay {
  padding: 0 0 15px;
  background-color: #ebebeb;
}
#transferPay .transfer-top-section {
  padding: 15px;
  text-align: center;
  /*background-color: #f5f5f5;*/
}
#transferPay .transfer-store-icon {
  display: inline-block;
  margin-right: 12px;
  width: 34px;
  height: 34px;
  line-height: 37px;
  border-radius: 50%;
  font-size: 24px;
  vertical-align: middle;
  color: #fff;
  background-color: #09ba07;
}
#transferPay .transfer-pay-section {
  padding: 16px;
  line-height: 25px;
  border-bottom: 1px solid #eee;
  color: #b2b2b2;
  background-color: #fff;
}
#transferPay .transfer-pay-section.transfer-consume-section {
  padding-top: 18px;
  padding-bottom: 18px;
  color: #000;
  font-size: 16px;
  line-height: 1.4;
  color: #666;
}
/*#transferPay .transfer-pay-section.transfer-discount-section {
  color: #818181;
}*/
#transferPay .transfer-pay-section.transfer-remark-section {
  height: 42px;
  padding-top: 8px;
  padding-bottom: 8px;
  line-height: 1.4;
}
#transferPay .transfer-pay-section.transfer-remark-section textarea {
  width: 100%;
  height: 46px;
  border: none;
  resize: none;
  outline: none;
}
#transferPay .transfer-pay-section.transfer-remark-section ::-webkit-input-placeholder {
  color: #6b7fa2;
}
#transferPay .transfer-pay-section.transfer-consume-section .transfer-count-input {
  display: inline-block;
  width: 60px;
  font-size: 20px;
  vertical-align:middle;
  border: none;
  outline: none;
  text-align:right;
}
#transferPay .transfer-pay-section .transfer-discount-cut {
  font-size: 14px;
  color: #f53530;
  margin-left: 10px;
}
#transferPay .transfer-discount-wrap {
  position: relative;
  display: inline-block;
  width: calc(100% - 4.3em);
  text-align: right;
}
#transferPay .transfer-nodiscount-wrap {
  display: inline-block;
}
#transferPay .transfer-discount-select {
  /*display: none;*/
  position: absolute;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  opacity: 0;
}
/*#transferPay .transfer-selected-discount {
  display: none;
}*/
#transferPay .support-tip {
  margin: 20px auto 40px;
  font-size: 12px;
  color: #ccc;
  text-align: center;
}
#transferPay .transfer-balance-section {
  display: none;
  margin-top: 15px;
  line-height: 16px;
}
#transferPay .switch-btn input:checked+.switch-btn-inner:before {
  background-color: #1aad19;
  border-color: #1aad19;
}
#transferPay .transfer-pay-btn {
  margin: 0 15px;
}
</style>
<div class="transfer-pay-wrap page" id="transferPay">
  <div class="transfer-top-section">
    <div class="transfer-store-icon"><span class="ico-moon icon-store"></span></div><span class="transfer-store-name">母婴小程序（拼团）</span>
  </div>
  <div class="transfer-pay-section transfer-consume-section">消费金额<span class="pull-right">¥ <input focus="" class="transfer-count-input" type="number"></span></div>
  <div class="transfer-pay-section transfer-discount-section">
    优惠信息
    <div class="transfer-discount-wrap">
      <span class="transfer-selected-discount"></span>
      <span class="transfer-discount-cut">- ¥ <span class="transfer-discount-cut-count"></span></span>
      <select class="transfer-discount-select"></select>
    </div>
    <div class="transfer-nodiscount-wrap pull-right">无</div>
  </div>
  <div class="transfer-pay-section transfer-balance-switch">
    <div>储值抵扣
      <div class="switch-btn pull-right" style="margin-top: 7px;">
        <input class="transfer-switch-input" type="checkbox">
        <label class="switch-btn-inner"></label>
      </div>
    </div>
    <div class="transfer-balance-section">抵扣金额<span class="pull-right transfer-discount-cut">- ¥ <span class="transfer-balance-deduction"></span></span></div>
  </div>
  <div class="transfer-pay-section transfer-remark-section"><textarea class="transfer-remark" placeholder="给对方留言"></textarea></div>
  <div class="support-tip">即速应用提供技术支持</div>
  <div class="btn btn-green btn-block transfer-pay-btn">支付 ¥ <span class="transfer-payment">0.00</span></div>
</div>
<script>
(function() {
  var inputPrice = 0,
      inputTimeout = '',
      selected_benefit = {},
      benefits = [],
      useBalance = 0,
      requesting = false,
      remark, payment;

  $('#transferPay').on('click', '.transfer-pay-btn', function(){
    if(isNaN(payment) || (+inputPrice).toFixed(2) <= 0){
      alertTip('请输入正确的金额');
      return;
    }
    if(payment < 0 || isNaN(payment)){
      alertTip('error payment amount');
      return;
    }
    sureTransfer();

  }).on('input', '.transfer-count-input', function(){
    payment = inputPrice = $(this).val();
    useBalance = $('#transferPay .transfer-switch-input').is(':checked') ? 1 : 0;
    inputTimeout && clearTimeout(inputTimeout);
    // if(Number(inputPrice) == 0){
    //   return;
    // }
    inputTimeout = setTimeout(function(){
      getBenefit();
    }, 600);

  }).on('change', '.transfer-discount-select', function(){
    var value = $(this).val();
    selected_benefit = benefits[value];
    calculatePayment();
    $('.transfer-selected-discount').text(selected_benefit.name);

  }).on('change', '.transfer-switch-input', function(){
    // 是否使用储值金
    useBalance = $(this).is(':checked') ? 1 : 0;
    calculatePayment();

  }).on('input', '.transfer-remark', function(){
    remark = $(this).val();

  });

  function getBenefit(){
    $.ajax({
      url: '/index.php?r=AppShop/GetTransferCanUseBenefit',
      data: {
        app_id: GetQueryString('_app_id'),
        total_price: inputPrice
      },
      dataType: 'json',
      success: function(res){
        if(res.status !== 0) {
          alertTip(data.data);
          return;
        }
        var discountOptionStr = '';

        selected_benefit = res.data.selected_benefit;
        benefits = res.data.benefit_result.data;
        if(benefits.length){
          benefits.unshift({
            title: '不使用优惠',
            name: '无',
            no_use_benefit: 1
          });
        }
        for (var i = 0; i <= benefits.length - 1; i++) {
          var select_discount_type = selected_benefit.discount_type;
          discountOptionStr += '<option value="'+i+'"';
          if(select_discount_type === benefits[i].discount_type){
            if(select_discount_type === 'coupon'){
              if(benefits[i].coupon_id == selected_benefit.coupon_id){
                discountOptionStr += ' selected="selected"';
              }
            } else {
              discountOptionStr += ' selected="selected"';
            }
          }
          discountOptionStr += '>'+benefits[i].title+'</option>';
        }
        $('.transfer-discount-select').html(discountOptionStr);

        if(selected_benefit && selected_benefit.discount_type){
          $('.transfer-selected-discount').text(selected_benefit.name);
          $('.transfer-discount-wrap').show();
          $('.transfer-nodiscount-wrap').css('display', 'none');
          $('.transfer-discount-section').css('display', 'block');
        } else {
          $('.transfer-discount-wrap').css('display', 'none');
          $('.transfer-nodiscount-wrap').css('display', 'block');
        }
        calculatePayment();
      }
    })
  }

  function calculatePayment(){
    $.ajax({
      url: '/index.php?r=AppShop/calculationPrice',
      data: {
        app_id: GetQueryString('_app_id'),
        price: inputPrice,
        selected_benefit: selected_benefit,
        is_balance: useBalance
      },
      dataType: 'json',
      success: function(res){
        if(res.status !== 0) {
          alertTip(res.data);
          return;
        }
        payment = +res.data.price;
        $('.transfer-payment').text(Math.round(payment*100)/100);
        if(res.data.discount_cut_price == 0){
          $('.transfer-discount-wrap .transfer-discount-cut').hide();
        } else {
          $('.transfer-discount-wrap .transfer-discount-cut').show().find('.transfer-discount-cut-count').text(res.data.discount_cut_price);
        }
        if(useBalance){
          $('.transfer-balance-deduction').text(res.data.use_balance);
          $('.transfer-balance-section').css('display', 'block');
        } else {
          $('.transfer-balance-section').css('display', 'none');
        }
      }
    })
  }

  function sureTransfer(){
    if(requesting){
      return;
    }
    requesting = true;

    if(selected_benefit.no_use_benefit == 1){
      selected_benefit = '';
    }

    $.ajax({
      url: '/index.php?r=AppShop/createTransferOrder',
      data: {
        app_id: GetQueryString('_app_id'),
        price: inputPrice,
        is_balance: useBalance,
        message: remark,
        selected_benefit: selected_benefit
      },
      dataType: 'json',
      success: function(res){
        if(res.status !== 0) {
          alertTip(res.data);
          requesting = false;
          return;
        }
        // clearInputContent();
        var orderId = res.data;
        payOrder(orderId);
      },
      fail: function(){
        requesting = false;
      }
    })
  }

  function payOrder(orderId){
    if(payment == 0){
      $.ajax({
        url: '/index.php?r=AppShop/paygoods',
        type: 'get',
        dataType: 'json',
        data: {
          app_id: GetQueryString('_app_id'),
          order_id: orderId,
          total_price: 0
        },
        success: function(res){
          if(res.status != 0){
            alertTip(res.data);
            return;
          }
          // clearInputContent();
          APP.turnToPage({
            router: 'transferDetail',
            detail: orderId,
            redirect: true
          });
        },
        complete: function(){
          requesting = false;
        }
      });
    } else {
      // clearInputContent();
      APP.turnToPage({
        router: 'payPage',
        detail: orderId,
        redirect: true
      }, 'refresh');
      requesting = false;
    }
  }

  // function clearInputContent(){
  //   var $transferPay = $('#transferPay');
  //   $transferPay.find('.transfer-count-input').text('');
  //   $transferPay.find('.transfer-remark').val('');
  //   $transferPay.find('.transfer-discount-select').html('');
  // }

})();
</script>

    <style rel="stylesheet">
#transferDetail {
  background-color: #ebebeb;
}
#transferDetail .transfer-goto-homepage .icon-rightarrow {
  position: absolute;
  right: 10px;
  display: block;
  font-size: 18px;
}
#transferDetail .transfer-top-section {
  padding: 18px 0;
  text-align: center;
  color: #818181;
  background-color: #fff;
}
#transferDetail .transfer-order-paytext {
  color: red;
}
#transferDetail .transfer-top-section .transfer-order-paytext {
  display: inline-block;
  margin-top: 8px;
  font-size: 24px;
}
#transferDetail .transfer-order-section {
  padding: 0 15px;
  line-height: 38px;
  overflow: hidden;
  border-top: 1px solid #e6e6e6;
  word-break: break-all;
  background-color: #fff;
}
#transferDetail .transfer-order-section .transfer-order-discount {
  margin-right: 10px;
  color: #818181;
}
#transferDetail .transfer-order-section .transfer-order-remark {
  line-height: 20px;
  padding-bottom: 7px;
  color: #818181;
}
#transferDetail .transfer-order-section.transfer-order-choose-payway {
  display: none;
  line-height: 20px;
  padding-top: 10px;
  padding-bottom: 10px;
  color: #818181;
}
#transferDetail .transfer-order-section.transfer-order-deduction-section {
  display: none;
}
#transferDetail .transfer-order-section > span:first-child {
  color: #818181;
}
#transferDetail .transfer-order-section > span:last-child {
  float: right;
}
#transferDetail .transfer-bottom-operation {
  padding: 10px 15px;
  border-top: 1px solid #e6e6e6;
  text-align: right;
  background-color: #fff;
}
#transferDetail .transfer-bottom-operation .btn {
  margin-left: 10px;
}
#transferDetail .transfer-order-payment {
  padding: 10px 0 0;
  line-height: 1;
}
#transferDetail .transfer-order-payment > img {
  width: 80px;
}
#transferDetail .check-box.checked {
  background-color: #C40B1D;
}
</style>
<div class="transfer-order-wrap page" id="transferDetail">
  <div class="transfer-top-section">
    <div>实付金额</div>
    <div class="transfer-order-paytext"><span style="font-size:16px;">¥ </span><span class="transfer-order-totalpay"></span></div>
  </div>
  <div class="transfer-order-section"><span>订单号</span><span class="transfer-order-id"></span></div>
  <div class="transfer-order-section"><span>付款时间</span><span class="transfer-order-addtime"></span></div>
  <div class="transfer-order-section transfer-order-payway-section"><span>支付方式</span><span><span class="transfer-order-payway"></span></span></div>
  <div class="transfer-order-section"><span>应付</span><span>¥ <span class="transfer-order-original-price"></span></span></div>
  <div class="transfer-order-section transfer-order-discount-section"><span>优惠</span><span><span class="transfer-order-discount"></span>- ¥<span class="transfer-discount-cut"></span></span></div>
  <div class="transfer-order-section transfer-order-deduction-section"><span>储值抵扣</span><span>- ¥<span class="transfer-order-deduction"></span></span></div>
  <div class="transfer-order-section"><span>实付</span><span class="transfer-order-paytext">¥ <span class="transfer-order-totalpay"></span></span></div>
  <div class="transfer-order-section"><span>备注信息</span><div class="transfer-order-remark"></div></div>
  <div class="transfer-order-section transfer-order-choose-payway">
    <div>选择支付方式</div>
    <div class="transfer-order-payment"><img src="app_data/weixin.jpg"><span class="pull-right transfer-order-checkbox check-box checked" payment="0"><img src="app_data/checked.png"></span></div>
    <div class="transfer-order-payment" payment="zfb"><img src="app_data/zhifubao.jpg"><span class="pull-right transfer-order-checkbox check-box" payment="1"><img src="app_data/checked.png"></span></div>
  </div>
  <div class="transfer-bottom-operation"></div>
</div>
<script>
(function() {
  var appId = GetQueryString('_app_id'),
      franchisee = GetQueryString('franchisee');

  $('#transferDetail').on('click', '.transfer-order-payment', function(){
    $('.transfer-order-checkbox.checked').removeClass('checked');
    $(this).find('.transfer-order-checkbox').addClass('checked');

  }).on('click', '.transfer-order-cancel', function(){
    // 取消支付
    var orderId = $('.transfer-order-id').text().trim();

    confirmTip({
      content: '确认取消订单？'
    }, function() {
      $.ajax({
        url: '/index.php?r=AppShop/cancelOrder',
        type: 'get',
        data: {
          app_id: appId,
          order_id: orderId,
          sub_shop_app_id: franchisee
        },
        dataType: 'json',
        success: function(data) {
          if (data.status !== 0) {
            alertTip(data.data);
            return;
          }
          APP.turnToPage({
            router: 'transferDetail',
            detail: GetQueryString('detail'),
            franchisee: franchisee
          }, 'refresh');
        }
      });
    });

  }).on('click', '.transfer-order-pay', function(){
    // 确认支付
    var orderId = $('.transfer-order-id').text().trim(),
        payment = $('.transfer-order-checkbox.checked').attr('payment');

    if ($('.transfer-order-totalpay').text().trim() == 0) {
      $.ajax({
          url: '/index.php?r=AppShop/paygoods',
          type: 'get',
          dataType: 'json',
          data: {
            app_id: appId,
            order_id: orderId,
            total_price: 0
          },
          success: function(res){
            if(res.status!=0){
              alertTip(res.data);
              return;
            }
            APP.turnToPage({
              router: 'transferDetail',
              detail: orderId,
              franchisee: franchisee
            }, 'refresh');
          }
      });
      return;
    }

    if (payment == 1) {
      // 支付宝支付
      window.open('/index.php?r=AppShop/getUniPay&order_id=' + orderId + '&payment_id=1');
    } else {
      APP.turnToPage({
        router: 'payPage'
      });
    }
  })
})();
</script>

    <style type="text/css">
#goodsAdditionalInfo {
  background: #f4f4f4;
}
#goodsAdditionalInfo .uploadImg{
  width: 50px;
  height: 50px;
  position: relative;
  border: 1px solid #ccc;
  display: inline-block;
}
#goodsAdditionalInfo .uploadImg:before {
  content: '';
  width: 70%;
  height: 1px;
  background: #ccc;
  position: absolute;
  top: 50%;
  left: 15%;
}
#goodsAdditionalInfo .uploadImg:after {
  content: '';
  width: 1px;
  height: 70%;
  background: #ccc;
  position: absolute;
  left: 50%;
  top: 15%;
}
#goodsAdditionalInfo .hasUploadImg {
  width: 100%;
  height: 100%;
}
#goodsAdditionalInfo .showUploadImg {
    position: relative;
    display: inline-block;
    width: 52px;
    height: 52px;
    vertical-align: top;
    margin-left: 15px;
}
#goodsAdditionalInfo .showUploadImg .deleteUploadImg {
    position: absolute;
    top: -9px;
    right: -9px;
    background-color: red;
    color: #fff;
    width: 18px;
    height: 18px;
    border-radius: 50%;
    text-align: center;
    line-height: 14px;
    font-size: 24px;
    font-weight: bolder;
    display: block;
}
#goodsAdditionalInfo .goodsAdditionalInfo-list li {
  margin-bottom: 10px;
  background: #fff;
}
#goodsAdditionalInfo .goodsAdditionalInfo-list li > div {
  padding: 10px 20px;
  border-bottom: 1px solid #ccc;
}
#goodsAdditionalInfo .goods-header-title {
  display: inline-block;
  vertical-align: top;
  overflow: hidden;
  text-overflow: ellipsis;
  width: 150px;
}
#goodsAdditionalInfo .goods-header img {
  width: 90px;
}
#goodsAdditionalInfo input {
  outline: none;
  border: none;
}
#goodsAdditionalInfo .goodsAdditionalInfo-list textarea {
  resize: none;
  height: 40px;
  width: 170px;
  outline: none;
  border: none;
}
#goodsAdditionalInfo .goodsAdditionalInfo-list .title {
  width: 80px;
  vertical-align: top;
  display: inline-block;
}
#goodsAdditionalInfo .submit {
    display: inline-block;
    width: 100%;
    text-align: center;
    background: #1AAD19;
    line-height: 40px;
    color: #fff;
    font-size: 16px;
}
#goodsAdditionalInfo .previewOrder,#goodsAdditionalInfo .goodsOrder {
  display: none;
}
</style>
<div class="page" id="goodsAdditionalInfo">
  <div class="previewOrder">
    <ul class="goodsAdditionalInfo-list">
      <!-- <li>
        <div class="goods-header">
          <img src="">
          <p class="goods-header-title">测试</p>
        </div>
        <div><span class="title">给卖家留言</span><input type="" name=""></div>
        <div><span class="title">单文本</span><input type="" name=""></div>
        <div><span class="title">多文本</span><textarea></textarea></div>
        <div><span class="title">图片</span>
            <div class="uploadImg"><input type="file" class="img-upload-input" accept="image/jpg,image/jpeg, image/gif, image/bmp, image/jp2, image/x-ms-bmp, image/x-png"></div>
        </div>
      </li> -->
    </ul>
    <div style="padding: 0 20px 10px;">
      <span class="submit">提交</span>
    </div>
  </div>
	<div class="goodsOrder">
    <ul class="goodsAdditionalInfo-list">
      <!-- <li>
        <div class="goods-header">
          <img src="">
          <p class="goods-header-title">测试</p>
        </div>
        <div><span class="title">给卖家留言</span><input type="" name=""></div>
        <div><span class="title">单文本</span><input type="" name=""></div>
        <div><span class="title">多文本</span><textarea></textarea></div>
        <div><span class="title">图片</span>
            <div class="uploadImg"><input type="file" class="img-upload-input" accept="image/jpg,image/jpeg, image/gif, image/bmp, image/jp2, image/x-ms-bmp, image/x-png"></div>
        </div>
      </li> -->
    </ul>
  </div>
</div>
<script type="text/javascript">
  $('#goodsAdditionalInfo').on('click','.submit',function(){
    var goodsInfoArr = {},
        valueNull = false;
    $.each($('#goodsAdditionalInfo .previewOrder .goodsAdditionalInfo-list li'),function(index,ele){
      goodsInfoArr[$(ele).attr('data-id')] = [];
      $.each($(ele).children('div').not('.goods-header'),function(i,el){
        var goodsInfo = {};
        goodsInfo['type'] = $(el).attr('data-type');
        goodsInfo['title'] = $(el).find('.title').text();
        goodsInfo['is_hidden'] = 1;

        switch($(el).attr('data-type')){
          case 'text':
            goodsInfo['value'] = $(el).find('input').val();
            if(!goodsInfo['value']){
              valueNull = true;
            }
          break;
          case 'mul-text':
            goodsInfo['value'] = $(el).find('textarea').val();
            if(!goodsInfo['value']){
              valueNull = true;
            }
          break;
          case 'picture':
            goodsInfo['value'] = [];
            $.each($(el).find('img'),function(j,element){
              goodsInfo['value'].push($(element).attr('src'));
            })
            if(!goodsInfo['value'].length){
              valueNull = true;
            }
          break;
        }
        goodsInfoArr[$(ele).attr('data-id')].push(goodsInfo);
      })

    })
    if(valueNull){
      alertTip('请完善补充信息');
      return;
    }
    goodsInfoArr = JSON.stringify(goodsInfoArr)
    $('#previewGoodsOrder .writeAdditionalInfo').attr('data-goodsInfo',goodsInfoArr);
    window.history.back();
  })
</script>
    <style rel="stylesheet">
#goodsOrderDetail {
    background-color: #eee;
}

#goodsOrderDetail .page-top-nav {
    position: static;
    margin: 0;
}

#goodsOrderDetail .goodsOrderDetail-section {
    background-color: #fff;
    margin-bottom: 6px;
}
#goodsOrderDetail .container {
  padding: 12px 15px;
  border-bottom: 1px solid #f2f2f2;
}
#goodsOrderDetail .goodsOrderDetail-section:last-child {
    margin-bottom: 0;
}

#goodsOrderDetail .right-arrow-bar {
    line-height: 18px;
}

.goodsOrderDetail-pay-count {
    color: #d20e10;
}

.goodsOrderDetail-btn-status > span {
    display: inline-block;
}

.goodsOrderDetail-payment {
    margin: 5px 15px 0;
}

.goodsOrderDetail-payment > img {
    width: 80px;
}

#goodsOrderDetail .check-box {
    margin-top: 3px;
}

#goodsOrderDetail .list-goods-cover {
    position: absolute;
    left: 0;
    width: 60px;
    height: 60px;
}

#goodsOrderDetail .list-goods-title {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
#goodsOrderDetail .list-goods-content .list-goods-model {
    color: #aaa;
}
#goodsOrderDetail .goodsPrice {
  text-align: right;
}
.payPage-wrap {
  background-color: #eee;
}


/*-----------------------陈飞 2016-11-02---------------------*/

#goodsOrderDetail .pay-way {
    background-color: white;
    margin: 6px 0px;
}

#goodsOrderDetail .check-box.checked {
    background-color: #ff7710;
}

#goodsOrderDetail .list-goods-content {
    position: absolute;
    left: 70px;
    top: 8px;
    text-overflow: ellipsis;
    width: 150px;
}

#goodsOrderDetail .list-goods-right {
    float: right;
    width: 74px;
}

#goodsOrderDetail .list-goods-right .quantity {
    float: right;
}

.goodsOrderDetail-order-list .dialog-block-item {
    height: 71px;
}

.goodsOrderDetail-order-list .quantity .plus:after,
.goodsOrderDetail-order-list .quantity .minus:before,
.goodsOrderDetail-order-list .quantity .plus:before,
.goodsOrderDetail-order-list .quantity .minus.disabled:before,
.goodsOrderDetail-order-list .quantity .plus.disabled:after,
.goodsOrderDetail-order-list .quantity .plus.disabled:before {
    background-color: #C7091B;
}


.leavemsg-wrap div {
    margin: 0 auto;
    position: relative;
    margin-top: 10px;
    margin-bottom: 10px;
}

.leavemsg-wrap input[type="text"] {
    max-width: 100%;
    height: 40px;
    border: 1px solid #DDD;
    text-indent: 10px;
    width: 100%;
}

.leavemsg-wrap .leavePicForSeller {
    height: 100px;
}

.btn_addPic {
    display: block;
    position: relative;
    width: 80px;
    height: 80px;
    overflow: hidden;
    border: 1px solid #EBEBEB;
    background: none repeat scroll 0 0 #F3F3F3;
    color: #999999;
    cursor: pointer;
    text-align: center;
    text-decoration: none;
    float: left;
    /* top: 50%;
    -webkit-transform: translateY(-50%);
    -moz-transform: translateY(-50%);
    -ms-transform: translateY(-50%);
    transform: translateY(-50%);*/
    top: 16px;
}

.filePrew {
    display: block;
    position: absolute;
    top: 0;
    left: 0;
    width: 140px;
    height: 39px;
    font-size: 100px;
    /* 增大不同浏览器的可点击区域 */
    opacity: 0;
    /* 实现的关键点 */
    filter: alpha(opacity=0);
    /* 兼容IE */
}

.btn_addPic img {
    position: absolute;
    width: 50px;
    height: 50px;
    left: 50%;
    top: 50%;
    -webkit-transform: translate(-50%, -50%);
    -moz-transform: translate(-50%, -50%);
    -ms-transform: translate(-50%, -50%);
    transform: translate(-50%, -50%);
}

.imgList {
    float: right;
    height: 100px;
    width: 200px;
    overflow: auto;
    top: 5px;
}

.imgList a {
    display: block;
    float: left;
    height: 90px;
    width: 90px;
    background: #EEE;
    margin-left: 10px;
    margin-top: 5px;
    position: relative;
}

.imgList a img {
    width: 70px;
    height: 70px;
    padding: 10px;
}

.imgList a span{
    position: absolute;
    right: -5px;
    display: block;
    top: -1px;
    border-radius: 50%;
    height: 20px;
    width: 20px;
    text-align: center;
    line-height: 20px;
    color: #fff;
    font-size: 23px;
    background-color: #d9534f;
    cursor: pointer;
    display: none;
}

.broadcast-img-dele {
    display: none;
    position: absolute;
    top: 0;
    right: 0;
    width: 24px;
    height: 24px;
    border-radius: 50%;
    color: #fff;
    font-size: 23px;
    line-height: 24px;
    background-color: #d9534f;
}
.appointmentInfo {
    display:none;
}
#discountDialog .discount-list{
    max-height: 300px;
    overflow: auto;
}
#discountDialog .discount-list ul li {
    list-style: none;
    text-align: center;
    font-size: 15px;
    padding-top: 10px;
    padding-bottom: 10px;
    border-bottom: 1px solid #EEE;
}
#goodsOrderDetail .select-discount .icon-rightarrow{
    float: right;
    height: 24px;
    line-height: 24px;
}
#goodsOrderDetail .goodsOrderDetail-balance {
    display: inline-block;
}
#goodsOrderDetail .dialog-block-item .balance-area {
    margin: 5px 0;
}
#goodsOrderDetail .freight-loation label{
    margin-right: 10px;
}
#goodsOrderDetail .radio-box {
    display: inline-block;
    width: 20px;
    height: 20px;
    padding: 4px 3px;
    margin-right: 6px;
    box-sizing: border-box;
    border-radius: 50%;
    line-height: 13px;
    background-color: #c7c4c4;
}
#goodsOrderDetail .radio-box img {
    width: 100%;
}
#goodsOrderDetail .radio-box.checked {
    background-color: #C40B1D;
}
#goodsOrderDetail .freight-since{
    display: none;
}
#goodsOrderDetail .icon-location,#goodsOrderDetail .icon-phone {
    display: inline-block;
}
#goodsOrderDetail .freight-loation-phone {
    margin: 10px 0;
    display: inline-block;
}
#goodsOrderDetail .freight-loation-name {
    text-decoration: underline;
    white-space: nowrap;
    text-overflow: ellipsis;
    display: inline-block;
    width: 90%;
    overflow: hidden;
}
#goodsOrderDetail .remark-word {
    margin-left: 10px;
    display: inline-block;
    width: 200px;
    word-wrap: break-word;
    float: right;
}
#goodsOrderDetail .clear {
  clear: both;
}
#goodsOrderDetail .btn.btn-orange {
  color: #ff7710;
  border-color: #ff7710;
  background-color: #fff;
}
#goodsOrderDetail .goodsOrderDetail-order-list li{
  padding: 12px 15px 0 12px;
  background: #f9f9f9;
}
.goodsOrderDetail-seckill{
  display: none;
}
.goods-seckill-price{
  font-size: 14px;
}
.goods-original-price{
  font-size: 10px;
  text-decoration: line-through;
  margin-left: 5px;
}
.goodsOrderDetail-seckill-sign{
  font-size: 13px;
  color: #ff7100;
  text-align: right;
}
</style>
<div class="goodsOrderDetail-wrap page" id="goodsOrderDetail">
    <div class="goodsOrderDetail-section" style="color:#fff;background-color:#535961;padding: 12px 15px;">
        <div style="margin-bottom:4px;">订单状态：<span class="goodsOrderDetail-status"></span></div>
        <div>订单号：<span class="goodsOrderDetail-order-id"></span></div>
    </div>
    <div class="goodsOrderDetail-section freight-loation">
        <div class="container">下单时间<span class="pull-right"><span class="goods-add-time"></span></span></div>
    </div>
    <!-- 运费 -->
    <div class="goodsOrderDetail-section freight-loation">
        <div class="container" style="padding-bottom: 10px;">配送方式<span class="pull-right"><span class="goods-shipping-method"></span></span></div>
        <!-- 地址 -->
        <div class="no-self-delivery-loaction container">
            <div class="name-number"></div>
            <div class="address"></div>
        </div>
        <div class="freight-since container">
          <div>
              <p class="icon-location"></p>
              <span class="freight-loation-name"></span>
          </div>
          <div>
              <p class="ico-moon icon-phone"></p>
              <a class="freight-loation-phone" href=""></a>
          </div>
          <div>
              亲，勾选上门自提，需要自己去门店取货哦!
          </div>
      </div>
    </div>
    <div class="dialog-block-item pay-way">
        <div class="goodsOrderDetail-payment"><img src="app_data/weixin.jpg"><span class="pull-right goodsOrderDetail-check-box check-box checked" payment="0"><img src="app_data/checked.png"></span></div>
        <div class="goodsOrderDetail-payment" payment="zfb"><img src="app_data/zhifubao.jpg"><span class="pull-right goodsOrderDetail-check-box check-box" payment="1"><img src="app_data/checked.png"></span></div>
    </div>
    <div class="goodsOrderDetail-section">
        <ul class="goodsOrderDetail-order-list">

        </ul>
    </div>
    <div class="goodsOrderDetail-section">
        <!-- <div>备注<span class="pull-right tostoreRemark"></span></div> -->
        <div class="container">商品金额<span class="pull-right">￥<span class="goodsOrderDetail-original-price"></span></span></div>
        <div class="container goodsOrderDetail-seckill">活动优惠
            <span class="pull-right">秒杀  - ¥ <span class="seckill-cut-price"></span></span>
        </div>
        <div class="tostoreBenefit">
            <div class="select-discount container">优惠方式<span class="pull-right discount-type">暂无优惠</span></div>
            <div class="container">优惠抵扣<span class="pull-right">- ￥<span class="goodsOrderDetail-benefit-deduction"></span></span></div>
        </div>
    </div>
    <div class="goodsOrderDetail-section">
        <div class="container">运费<span class="pull-right">￥<span class="goodsOrderDetail-express-fee"></span></span></div>
        <div class="container">订单总价<span class="pull-right">￥<span class="goodsOrderDetail-order-total-price"></span></span></div>
    </div>
    <div class="goodsOrderDetail-section">
        <div class="balance-deduction container">储值抵扣<span class="pull-right">- ￥<span class="goodsOrderDetail-balance-deduction"></span></span></div>
        <div class="container">需付款<span class="pull-right" style="color: #ff7100;">￥<span class="goodsOrderDetail-total-price"></span></span></div>
    </div>
    <div class="goodsOrderDetail-section additional-info">
        <div class="container">补充信息<span class="pull-right"><span class="icon-rightarrow"></span></span></div>
    </div>
    <div class="goodsOrderDetail-section remark">
        <div class="container"><span style="display: inline-block;vertical-align: top;">留言信息</span><span class="remark-word"></span><div class="clear"></div></div>
    </div>
    <div class="goodsOrderDetail-section" style="padding: 12px 15px;">
      <div class="txt-r goodsOrderDetail-btn-status"></div>
    </div>
</div>
<div class="payPage-wrap page txt-c" id="payPage">
    <div style="margin-top:30%; margin-bottom:30px;">
        <img class="goodsOrderDetail-pay-qrcode" style="width:150px;">
    </div>
    <div style="font-size:16px;">长按二维码扫描支付</div>
</div>
<div id="discountDialog" class="page-dialog-wrap" style="display: none;">
    <div class="page-bottom-dialog">
        <div class="page-bottom-content">
            <div class="sure-local-area">
                <span>取消</span>
                <span>确定</span>
            </div>
            <div class="discount-list">
                <ul>
                </ul>
            </div>
        </div>
    </div>
</div>
<script>
(function() {
    var appId = GetQueryString('_app_id');

    function getTotalMoney(){
        var totalMoney=0;
        $.each($(".list-goods-right p:first-child"),function(index,ele){
            totalMoney+=Number($(ele).attr('data-price'));
        });
        return totalMoney;
    }
    $('#goodsOrderDetail').on('click','.additional-info',function(){
      var additionArr = $('#goodsOrderDetail .additional-info').data('additionalArr'),
          arr = [];
        for(var i = 0;i < additionArr.length;i++){
          arr.push(additionArr[i].delivery_id);
        }
      APP.turnToPage({
        router: 'goodsAdditionalInfo',
        additionalArr: arr,
        from: 'goodsOrderDetail'
      })
    }).on('click', '.goodsOrderDetail-check-box', function() {
        $('.goodsOrderDetail-check-box.checked').removeClass('checked');
        $(this).addClass('checked');

    }).on('click', '.goodsOrderDetail-pay-directly', function() {
        // 支付
        var id = $('.goodsOrderDetail-order-id').text().trim(),
            payment = $('.goodsOrderDetail-payment').find('.goodsOrderDetail-check-box.checked').attr('payment');

        if (!id) {
            alertTip('order id undefined');
            return;
        }
        // 支付成功回调
        function paySuccessCallback(){
            if(!GetQueryString('franchisee')){
                $.ajax({
                    url: '/index.php?r=AppMarketing/CheckAppCollectmeStatus',
                    type: 'get',
                    data: {
                        'app_id': appId,
                        'order_id': id
                    },
                    dataType: 'json',
                    success: function(res){
                        var collectBenefit = '';
                        if(res.valid == 0){
                            collectBenefit = 1;
                        }
                        APP.turnToPage({
                            router: 'goodsOrderPaySuccess',
                            detail: id,
                            franchisee: GetQueryString('franchisee'),
                            collectBenefit: collectBenefit,
                            redirect: true
                        });
                    }
                });
            } else {
                APP.turnToPage({
                    router: 'goodsOrderPaySuccess',
                    detail: id,
                    franchisee: GetQueryString('franchisee'),
                    redirect: true
                });
            }
        }
        if ($('.goodsOrderDetail-total-price').text().trim() == 0) {
            $.ajax({
                url: '/index.php?r=AppShop/paygoods',
                type: 'get',
                dataType: 'json',
                data: {
                    app_id: appId,
                    order_id: id,
                    total_price: 0
                },
                success: function(res){
                    if(res.status!=0){
                        alertTip(res.data);
                        return;
                    }
                    alertTip('支付成功', function(){
                        paySuccessCallback();
                    });
                }
            });
            return;
        }
        if (payment == 1) {
            // 支付宝支付
            window.open('/index.php?r=AppShop/getUniPay&order_id=' + id + '&payment_id=1');
        } else {
            // if(navigator.userAgent.toLowerCase().match(/MicroMessenger/i) == 'micromessenger'){
            //   // 用微信打开应用时 调用微信支付
            //   $.ajax({
            //     url: '/index.php?r=AppShop/GetWxWebappPaymentCode',
            //     data: {
            //       order_id: id,
            //       app_id: appId,
            //     },
            //     dataType: 'json',
            //     success: function (res) {
            //       if (res.status !== 0) {
            //         alertTip(res.data);
            //         return;
            //       }
            //       var param = res.data;

            //       wx.chooseWXPay({
            //         'timeStamp': param.timeStamp,
            //         'nonceStr': param.nonceStr,
            //         'package': param.package,
            //         'signType': 'MD5',
            //         'paySign': param.paySign,
            //         success: function(res){
            //           APP.turnToPage({
            //             router: 'orderDetail',
            //             detail: id,
            //             franchisee: GetQueryString('franchisee')
            //           })
            //         },
            //         fail: function(res){
            //           alert('fail ---- '+JSON.stringify(res));
            //         },

            //       })
            //     }
            //   })
            // } else {
              APP.turnToPage({
                  router: 'payPage'
              });
            // }
        }
    }).on('click', '.goodsOrderDetail-make-comment', function() {
        APP.turnToPage({
            router: 'makeComment',
            detail: $('.goodsOrderDetail-order-id').text().trim(),
            franchisee: GetQueryString('franchisee')
        });

    }).on('click', '.goodsOrderDetail-check-logistics', function() {
        APP.turnToPage({
            router: 'logisticsPage',
            detail: $('.goodsOrderDetail-order-id').text().trim(),
            franchisee: GetQueryString('franchisee')
        });

    }).on('click', '.goodsOrderDetail-sure-receipt,.goodsOrderDetail-apply-drawback, .goodsOrderDetail-receive-drawback', function() {
        // 确认收货、取消订单、申请退款
        var id = $('.goodsOrderDetail-order-id').text().trim(),
            text, url;

        if ($(this).hasClass('goodsOrderDetail-sure-receipt')) {
            text = '确认已收到货物？';
            url = 'AppShop/comfirmOrder';
        } else if ($(this).hasClass('goodsOrderDetail-cancel-order')) {
            text = '确认取消订单？';
            url = 'AppShop/cancelOrder';
        } else if ($(this).hasClass('goodsOrderDetail-apply-drawback')) {
            text = '确认要申请退款？';
            url = 'AppShop/applyRefund';
        } else if ($(this).hasClass('goodsOrderDetail-receive-drawback')) {
            text = '确认已收到退款？';
            url = 'AppShop/comfirmRefund';
        }

        confirmTip({
            content: text
        }, function() {
            updateOrder(id, url);
        });

    }).on('click', '.goodsOrderDetail-verification-code', function(){
        APP.turnToPage({
            router: 'verificationCodePage',
            detail: $('.goodsOrderDetail-order-id').text().trim(),
            sub_shop_app_id: GetQueryString('franchisee')
        });
    });
    // 更新订单状态
    function updateOrder(orderId, url) {
        if (!url) {
            alertTip('controller/action undefined');
            return;
        }
        if (!orderId) {
            alertTip('order id undefined');
            return;
        }

        $.ajax({
            url: '/index.php?r=' + url,
            type: 'get',
            data: {
                app_id:appId,
                order_id: orderId,
                sub_shop_app_id: GetQueryString('franchisee')
            },
            dataType: 'json',
            success: function(data) {
                if (data.status !== 0) {
                    alertTip(data.data);
                    return;
                }
                APP.turnToPage({
                    router: 'goodsOrderDetail',
                    detail: GetQueryString('detail'),
                    franchisee: GetQueryString('franchisee')
                }, 'refresh');
            }
        });
    }

})();
</script>

    <style rel="stylesheet">
  #myGroup {
    height: 100%;
    background: #e9e9e9;
  }

  #myGroup .group-btn {
    height: 30px;
    border-radius: 30px;
    width: 100px;
    text-align: center;
    line-height: 30px;
    display: inline-block;
    font-size: 15px;
    margin-left: 5px;
  }

  #myGroup .white {
    color: #777;
    background: #fff;
    border: 1px solid #c2c2c2;
  }

  #myGroup .red {
    background: #d0021b;
    color: #fff;
  }

  #myGroup .yellow {
    color: #fff;
    background: #f5a623;
  }

  #myGroup .wrap {
    height: 100%;
  }

  #myGroup .tabs {
    height: 40px;
  }

  #myGroup .content {
    height: 40px;
    line-height: 40px;
    width: 49%;
    display: inline-block;
    text-align: center;
  }

  #myGroup .active-tab {
    background: #fff !important;
  }

  #myGroup .sub-tabs {
    height: 40px;
    background: #fff;
    margin-top: 2px;
    white-space: nowrap;
    overflow-y:hidden;
  }
  #myGroup .sub-tabs::-webkit-scrollbar{
    display:none;
  }
  #myGroup .status {
    height: 38px;
    width: 80px;
    text-align: center;
    line-height: 38px;
    display: inline-block;
    font-size: 15px;
  }

  #myGroup .active-sub-tab {
    border-bottom: 2px solid #d0021b;
  }

  #myGroup .list {
    height: calc(100% - 84px);
  }

  #myGroup .orders {
    min-height: 150px;
    background: #fff;
    margin-top: 5px;
    padding: 10px 20px;
  }

  #myGroup .head {
    height: 25px;
    line-height: 25px;
    font-size: 13px;
  }

  #myGroup .order-time {
    float: left;
  }

  #myGroup .order-status {
    float: right;
    color: #d0021b;
  }

  #myGroup .goods-detail {
    border-bottom: 1px solid #eeeeee;
  }

  #myGroup .goods-wrap {
    height: 70px;
    background: #f7f7f7;
    padding: 10px;
    overflow: hidden;
  }

  #myGroup .goods-wrap img {
    height: 70px;
    width: 70px;
    float: left;
  }

  #myGroup .middle {
    float: left;
    margin-left: 10px;
    padding-top: 10px;
    font-size: 14px;
  }

  .goods-name {
    margin-bottom: 10px;
  }

  #myGroup .goods-spec {
    color: #c2c2c2;
    font-size: 13px;
  }

  #myGroup .price {
    float: right;
    padding-top: 10px;
    text-align: right;
  }

  #myGroup .origin-price {
    text-decoration: line-through;
    color: #c2c2c2;
  }

  #myGroup .num {
    text-align: right;
    color: #c2c2c2;
  }

  #myGroup .group-info {
    padding: 5px;
    font-size: 13px;
  }

  #myGroup .group-info div {
    margin-bottom: 5px;
  }
  #myGroup .order-info{
    border-bottom: 1px solid #eeeeee;
    padding: 10px 0;
    text-align: right;
    font-size: 12px;
  }
  #myGroup .order-btn{
    text-align: right;
    margin-top: 12px;
  }
  #myGroup .no-more{
    height: 50px;
    color: #c2c2c2;
    text-align: center;
    line-height: 50px;
  }
</style>
<div class="my-group-wrap page" id="myGroup">
  <div class="wrap">
    <div class="tabs">
      <div class="content active-tab" data-type="1">我发起的团</div>
      <div class="content" data-type="0">我参与的团</div>
    </div>
    <div class="sub-tabs">
      <div class="status active-sub-tab" data-status="0">全部</div>
      <div class="status leader" data-status="1">未开团</div>
      <div class="status" data-status="2">拼团中</div>
      <div class="status" data-status="3">拼团成功</div>
      <div class="status" data-status="4">拼团失败</div>
      <div class="status" data-status="5">已关闭</div>
    </div>
    <div class="list">

    </div>
    <div class="no-more">没有更多数据了~</div>
  </div>
</div>
<script>
(function(){
  //console.log("我的拼团页面");
})();
</script>

    <style rel="stylesheet">
  #groupCenter{
    height: 100%;
    background: #e9e9e9;
  }

 #groupCenter .list {
    height: 100%;
  }

 #groupCenter .goods {
   height: 70px;
   background: #fff;
   margin-bottom: 5px;
   overflow: hidden;
   padding: 10px;
  }

 #groupCenter .goods-img {
   height: 70px;
   width: 70px;
  }

 #groupCenter .info {
   display: inline-block;
   font-size: 13px;
   vertical-align: top;
   padding-left: 5px;
   width: 210px;
  }

 #groupCenter .grouping image {
    height: 20px;
    width: 20px;
    margin-left: 5px;
    border-radius: 100%;
    vertical-align: middle;
  }

 #groupCenter .title {
   height: 16px;
   line-height: 16px;
   font-size: 13px;
  }

 #groupCenter .group-price {
   height: 20px;
   line-height: 20px;
   color: #ff0e1b;
   font-size: 12px;
  }
 #groupCenter .single-price{
   font-size: 12px;
 }
 #groupCenter .group-price text {
    font-size: 18px;
  }

 #groupCenter .discount-tag {
    display: inline-block;
    position: relative;
    padding: 0 7px;
    height: 12px;
    line-height: 12px;
    color: #fff;
    text-align: center;
    font-size: 8px;
    vertical-align: middle;
    margin-top: -7px;
    margin-left: 5px;
    background-image: -webkit-gradient(linear, 0 0, right 0, from(#ff00ea), to(#ff0e18));
  }

 #groupCenter .discount-tag::before {
    content: '';
    position: absolute;
    left: 0;
    top: 0;
    border-top: 6px solid transparent;
    border-bottom: 6px solid transparent;
    border-left: 3px solid #fff;
  }

 #groupCenter .discount-tag::after {
    content: '';
    position: absolute;
    right: 0;
    top: 0;
    border-top: 6px solid transparent;
    border-bottom: 6px solid transparent;
    border-right: 3px solid #fff;
  }

 #groupCenter .grouping {
   color: #999;
   height: 20px;
   line-height: 20px;
   font-size: 12px;
  }

 #groupCenter .grouping text {
    vertical-align: middle;
  }

  #groupCenter .grouping img {
    height: 20px;
    width: 20px;
    border-radius: 100%;
    vertical-align: middle;
    margin-left: 5px;
  }

 #groupCenter .no-more{
    height: 50px;
    color: #999;
    text-align: center;
    line-height: 50px;
  }
  #groupCenter .hide{
    display:none!important;
  }
</style>
<div class="group-center-wrap page" id="groupCenter">
  <div class="list">

  </div>
  <div class="goods" style="display: none;" data-id="item.goods_id">
    <img class="goods-img" src="app.htm">
    <div class="info">
      <div class="title">item.goods_title</div>
      <div class="group-price">拼团价：￥<span>item.normal_min_price</span>~￥<span>item.normal_max_price</span>
        <div class="discount-tag">减价</div>
      </div>
      <div class="single-price">单买价：￥item.goods_price</div>
      <div class="grouping">
        <span>item.group_buy_team_count个进行中的团：</span>
        <img src="app.htm">
      </div>
      <div class="grouping">
        <span>暂无进行中的团</span>
      </div>
    </div>
  </div>
  <div class="no-more">没有更多了~</div>
</div>
<script>
function turnToGoodsDetail(detail){
  APP.turnToPage({
    router: 'goodsDetail',
    detail: detail
  });
}
</script>

    <style rel="stylesheet">
  .group-rules-wrap .wrap{
    padding: 20px;
  }
  .group-rules-wrap .title{
    font-weight: bold;
    margin: 20px 0;
  }
  .group-rules-wrap .content{
    margin: 20px 0;
    font-size: 14px;
    color: #666;
    line-height: 20px;
  }
</style>
<div class="group-rules-wrap page" id="groupRules">
  <div class="wrap">
    <div class="title">参与条件</div>
    <div class="content">参与用户（包括开团用户和参团用户）需在小程序内允许授权，并绑定有效手机号码，才能参加拼团活动。（若进入时未允许授权，请点击右上角，选择关于，在设置里打开授权。）</div>
    <div class="title">玩法介绍</div>
    <div class="content">1.	活动期间，用户可以在拼团商品详情下单发起拼团。</div>
    <div class="content">2.	用户只有付款成功，才算成功开团或者成功参团，创建订单未付款不算有效参与拼团玩法。</div>
    <div class="content">3.	拼团列表中显示N人团，为N人成团（例：3人团含义为3人成团，先付款的成员先加入团，人数满3人即为拼团成功）。每位用户在同一个团内只占1个拼团人数。</div>
    <div class="content">4.	用户在规定时间内达到拼团人数，则拼团成功，商家分别发货；如果未能在规定时间内达到拼团人数，则拼团失败，系统自动触发退款。</div>
    <div class="content">5.	为保证拼团成功，开团时请根据实际情况选择合适的拼团人数。</div>
    <div class="title">注意事项</div>
    <div class="content">1.	用户需在开团后规定的拼团时限内完成拼团，如果在拼团时限内商品拼团活动结束，拼团仍未成功，则默认用户拼团失败。</div>
    <div class="content">2.	商品开团期间，用户进行中的团（包括自行开团与参团）数量不得超过商家限制的数量（拼团成功与拼团失败的团不计入进行中的团），在每个团中购买的商品数量不得超过商家限制的数量。</div>
    <div class="content">3.	用户付款成功后，在拼团进行时不可申请退款。</div>
    <div class="content">4.	拼团活动与优惠券和会员卡不冲突，当满足优惠条件后，系统会在拼团价的基础上计算优惠后的价格。</div>
  </div>
</div>
<script>
(function(){

})();

</script>

    <style rel="stylesheet">
  #groupOrderDetail{
    background: #e9e9e9;
  }

  #groupOrderDetail .container {
    background: #fff;
    margin-top: 5px;
  }

  #groupOrderDetail .order-status {
    padding: 20px;
    height: 40px;
    background: -webkit-gradient(linear, 0 0, right 0, from(#ffbe00), to(#ff3f00));
    color: #fff;
  }

  #groupOrderDetail .contact-info {
    padding: 15px;
    color: #b2b2b2;
  }

  #groupOrderDetail .contact-info .ico-moon {
    font-size: 26px;
    margin-right: 5px;
    vertical-align: middle;
    display: inline-block;
  }

  #groupOrderDetail .detail-info {
    display: inline-block;
    vertical-align: middle;
    font-size: 13px;
    line-height: 22px;
    max-width: 250px;
    overflow: hidden;
  }

  #groupOrderDetail .order-detail {
    padding: 10px;
  }

  #groupOrderDetail .order-id {
    font-size: 14px;
    padding: 0 0 10px 10px;
  }

  #groupOrderDetail .goods-wrap {
    height: 70px;
    background: #f7f7f7;
    padding: 10px;
    overflow: hidden;
  }

  #groupOrderDetail .goods-wrap img {
    height: 70px;
    width: 70px;
    float: left;
  }

  #groupOrderDetail .middle {
    float: left;
    margin-left: 10px;
    padding-top: 10px;
    font-size: 14px;
  }

  #groupOrderDetail .goods-name {
    margin-bottom: 10px;
  }

  #groupOrderDetail .goods-spec {
    color: #c2c2c2;
    font-size: 13px;
  }

  #groupOrderDetail .price {
    float: right;
    padding-top: 10px;
    text-align: right;
  }

  #groupOrderDetail .origin-price {
    color: #ff3f00;
    font-size: 13px;
  }

  #groupOrderDetail .num {
    text-align: right;
    color: #c2c2c2;
  }

  #groupOrderDetail .group-info {
    padding: 5px;
    font-size: 13px;
  }

  #groupOrderDetail .group-info  div {
    margin-bottom: 5px;
  }

  #groupOrderDetail .order-info {
    border-bottom: 1px solid #f9f9f9;
    padding: 10px 0;
    text-align: right;
    font-size: 12px;
  }

  #groupOrderDetail .red-price {
    font-size: 15px;
    color: #ff3f00;
  }

  #groupOrderDetail .discount {
    border-bottom: 1px solid #f9f9f9;
    padding: 5px;
    font-size: 14px;
    line-height: 25px;
  }

  #groupOrderDetail .discount .content .ico-moon {
    font-size: 20px;
    vertical-align: middle;
    margin-right: 5px;
    color: #d0021b;
    display: inline-block;
  }

  #groupOrderDetail .group-btn {
    padding: 25px;
    text-align: center;
  }

  #groupOrderDetail .btn {
    width: 100px;
    border-radius: 5px;
    margin-left: 10px;
  }

  #groupOrderDetail .white {
    border: 1px solid #c2c2c2;
    color: #b2b2b2;
  }

  #groupOrderDetail .red {
    color: #fff;
    background: #d0021b;
  }

  #groupOrderDetail .yellow {
    color: #fff;
    background: #f5a623;
  }

  #groupOrderDetail .progress {
    border-bottom: 1px solid #f9f9f9;
  }

  #groupOrderDetail .title {
    padding: 10px;
    font-size: 14px;
  }

  #groupOrderDetail .head-logo {
    text-align: center;
    height: 60px;
    line-height: 60px;
  }

  #groupOrderDetail .group-leader {
    position: relative;
    display: inline-block;
    margin-right: 5px;
  }

  #groupOrderDetail .group-leader img {
    height: 40px;
    width: 40px;
    border-radius: 100%;
    border: 1px solid #ff3f00;
  }

  #groupOrderDetail .tag {
    font-size: 8px;
    background: #d0021b;
    width: 28px;
    color: #fff;
    position: absolute;
    text-align: center;
    height: 12px;
    line-height: 12px;
    bottom: 20px;
    left: 7px;
  }
  #groupOrderDetail .tag::before {
    content: '';
    position: absolute;
    left: 0;
    top: 0;
    border-top: 6px solid transparent;
    border-bottom: 6px solid transparent;
    border-left: 3px solid #fff;
  }
  #groupOrderDetail .tag::after {
    content: '';
    position: absolute;
    right: 0;
    top: 0;
    border-top: 6px solid transparent;
    border-bottom: 6px solid transparent;
    border-right: 3px solid #fff;
  }
  #groupOrderDetail .members{
    height: 40px;
    width: 40px;
    border-radius: 100%;
    margin-right: 5px;
    border: 1px solid #e9e9e9;
  }
  #groupOrderDetail .omit{
    height: 40px;
    width: 30px;
    line-height: 40px;
    text-align: center;
    margin-right: 5x;
    display: inline-block;
    vertical-align: top;
  }
  #groupOrderDetail .more-members{
    height: 40px;
    width: 40px;
    line-height: 40px;
    text-align: center;
    border: 1px dashed #e9e9e9;
    color: #e9e9e9;
    border-radius: 100%;
    display: inline-block;
    vertical-align: top;
  }
  #groupOrderDetail .total-mumber{
    text-align: center;
    padding-bottom: 10px;
    font-size: 13px;
  }
</style>
<div class="group-order-wrap page" id="groupOrderDetail">
  <div class="order-status">
    <div style="margin-bottom:10px;">待付款</div>
    <div style="font-size:13px;">团号：<span class="team-token"></span></div>
  </div>
  <div class="contact-info container">
    <div class="ico-moon icon-location"></div>
    <div class="detail-info">
      <div class="address">配送地址：<span class="mail-address"></span></div>
      <div class="address">收货人：<span class="mail-man"></span></div>
      <div class="address">联系电话：<span class="mail-phone"></span></div>
    </div>
  </div>
  <div class="contact-info container">
    <div class="ico-moon icon-comment"></div>
    <div class="detail-info">
      <div class="address">买家留言</div>
      <div class="address massage"></div>
    </div>
  </div>
  <div class="container order-detail">
    <div class="order-id">订单号：<span></span></div>
    <div class="goods-wrap">
      <img src="app.htm">
      <div class="middle">
        <div class="goods-name"></div>
        <div class="goods-spec"></div>
      </div>
      <div class="price">
        <div class="pay-price">￥<span></span></div>
        <div class="origin-price">拼团(-￥<span></span>)</div>
        <div class="num">x<span></span></div>
      </div>
    </div>
    <div class="discount">
      <div class="content">
        <div class="ico-moon icon-group-pay"></div>储值金：<span></span>
      </div>
      <div class="content">
        <div class="ico-moon icon-coupon"></div>优惠方式：<span></span>
      </div>
    </div>
    <div class="order-info">共<span></span>件商品 实付：
      <text class="red-price">￥<span></span></text> (含运费￥<span></span>)</div>

    <div class="progress">
      <div class="title">拼团进度：</div>
      <div class="head-logo">


      </div>
      <div class="total-mumber">已拼
        <text class="red-price">1</text>人，还差
        <text class="red-price">2</text>人成团</div>
    </div>


    <div class="group-info">
      <div class="centent">下单时间：<span></span></div>
      <div class="centent">拼团人数：<span></span>人团</div>
      <div class="centent">拼团时限：<span></span>小时<span></span>分钟</div>
      <div class="centent">结束时间：<span></span></div>
      <div class="centent">成功时间：<span></span></div>
    </div>
  </div>

  <div class="group-btn" "="">
    <div class="btn white">取消拼团</div>
    <div class="btn red">立即支付</div>
  </div>
</div>
<script>
(function(){

})();
</script>

    <script src="app_data/awardRotate.js"></script>
<style type="text/css">
#luckyWheelDetail{
	position: relative;
	padding-bottom: 20px;
}

#luckyWheelDetail .structurePrize{
      width: 100%;
      margin: 0 auto;
      height: 30px;
      margin-top: 25px;
      text-align: center;
    }
#luckyWheelDetail .structurePrize .lookPrize{
      display: inline-block;
      height: 30px;
      width: 106px;
      text-align: center;
      background: #fed932;
      line-height: 30px;
      border-radius: 4px;
      font-size: 14px;
      font-weight: bold;
      color: rgb(104,51,0);
      box-shadow:0px 2px 2px rgba(38,38,38,.2)
    }
#luckyWheelDetail .structurePrize .exchangePrize{
      display: inline-block;
      width: 106px;
      height: 30px;
      text-align: center;
      background: #fed932;
      line-height: 30px;
      border-radius: 4px;
      font-size: 14px;
      font-weight: bold;
      color: rgb(104,51,0);
      margin-left: 10px;
      box-shadow:0px 2px 2px rgba(38,38,38,.2);
      display: none;
    }
#luckyWheelDetail .pageMusic{
	  width: 30px;
    height: 30px;
    position: absolute;
    top: 8px;
    right: 5%;
    line-height: 30px;
    text-align: center;
    border-radius: 50%;
    background: rgba(0,0,0,.4);
    color: #fff;
}
 #luckyWheelDetail .pageMusic.active{
 	animation: animaze 2s infinite linear;
 }
	@keyframes animaze{
		0%{
			transform: rotate(0deg);
		}
		100%{
			transform: rotate(360deg);
		}
	}
 #luckyWheelDetail .lucky-wheel-content{
 	width: 100%;
 	height: 100%
 }
 #luckyWheelDetail .lucky-cantaniner{
  height: 100%;
  width: 100%;
  position: absolute;
  left: 0;
  top: 0;
  z-index: -20;
 }
 #luckyWheelDetail .lucky-wheel-content .motive{
    width: 300px;
    margin: 0 auto;
    height: 75px;
    margin-top: 40px;
 }
 #luckyWheelDetail .lucky-wheel-content .motive img{
  width: 100%;
  height: 100%;
  background-size: 100% 100%;
  background-repeat: no-repeat;
 }
 #luckyWheelDetail .lucky-wheel-content .phoneCx{
  text-align: center;
	font-size: 12px;
	width: 270px;
	line-height: 25px;
  height: 25px;
	margin: 0 auto;
	border-radius: 14px;
	background:rgba(243,190,30,.3);
  margin-top: 20px;
 }
 #luckyWheelDetail .lucky-wheel-content .todayChance{
 	display: inline-block;
 	color: #6b3600;
 }
 #luckyWheelDetail .lucky-wheel-content .todayChance span{
 	color: #ff090f;
 }
 #luckyWheelDetail .lucky-wheel-content .personNum{
 	color: #6b3600;
 	text-align: center;
 }
  #luckyWheelDetail .lucky-wheel-content .personNum span{
  	color: #ff090f;
  }
  .outDiv{
  	width: 285px;
    height: 285px;
    margin: 0 auto;
    position: relative;
    margin-top: 22px;
  }
  #luckyWheelDetail .outer-cont{
  	width: 285px;
    height: 285px;
    position: absolute;
    left: 0;
    top: 0;
  }
   #luckyWheelDetail #tip{
     position: absolute;
    left: 109px;
    top: 90px;
    width: 66px;
    height: 88px;
    z-index: 10;
   }
  #luckyWheelDetail .outer-cont #img{
  	width: 100%;
  	height: 100%;
  }

  #luckyWheelDetail .outer-cont .zp{
      position: absolute;
      width: 50px;
      height: 50px;
      width: 60px;
      height: 50px;
     }
  #luckyWheelDetail .outer-cont .zp span{
      color: #ca1518;
      font-family: "Microsoft YaHei";
      font-size: 14px;
      display: block;
      height: 40px;
      text-align: center;
      word-break: break-all;
     }
  #luckyWheelDetail .outer-cont .zp img{
       width: 20px;
       margin: 0 auto;
       margin-top: 5px;
      height: 20px;
      display: block;
     }
  #luckyWheelDetail .outer-cont .zp1{
    top: 120px;
    left: 99px;
    transform: rotate(33deg) translateY(-100px);
     }
  #luckyWheelDetail .outer-cont .zp2{
    top: 125px;
    left: 107px;
    transform: rotate(68deg) translateY(-100px);
     }
  #luckyWheelDetail .outer-cont .zp3{
    top: 123px;
    left: 101px;
    transform: rotate(105deg) translateY(-100px);
     }
   #luckyWheelDetail .outer-cont .zp4{
    top: 113px;
    left: 104px;
    transform: rotate(155deg) translateY(-100px);
     }
   #luckyWheelDetail .outer-cont .zp5{
    top: 115px;
    left: 112px;
    transform: rotate(199deg) translateY(-90px);
     }
   #luckyWheelDetail .outer-cont .zp6{
    top: 107px;
    left: 123px;
    transform: rotate(243deg) translateY(-100px);
     }
   #luckyWheelDetail .outer-cont .zp7{
    top: 133px;
    left: 119px;
    transform: rotate(301deg) translateY(-100px);
     }
   #luckyWheelDetail .outer-cont .zp8{
    top: 129px;
    left: 116px;
    transform: rotate(340deg) translateY(-100px);
     }
  #luckyWheelDetail .winList{
  	width: 260px;
    height: 140px;
    margin: 0 auto;
    margin-top: 30px;
  }
  #luckyWheelDetail .winList .wintitle{
  	color: #fff;
    height: 40px;
    line-height: 40px;
    text-align: center;
    font-weight: bold;
  }
  #luckyWheelDetail .winList .winCon{
  	width: 100%;
    border-radius: 5px;
    height: 80px;
    background: #AE2C53;
    text-align: center;
    padding: 10px 0;
    overflow: hidden;
  }
  #luckyWheelDetail .winList .winCon ul{
    height: 78px;
    animation: marque-animation 10s linear infinite;
    -webkit-animation: marque-animation 10s linear infinite;
   }
  #luckyWheelDetail .winList .winCon ul li{
   color: #fff;
   height: 19px;
   font-size: 12px;

    }
    @keyframes marque-animation{ 0% { transform: translateY(100%); } 100% { transform: translateY(-100%); } }
   @-webkit-keyframes marque-animation{ 0% { -webkit-transform: translateY(100%); } 100% { -webkit-transform: translateY(-100%); } }
  #luckyWheelDetail .active-rule{
    width: 260px;
    margin: 0 auto;
    height: auto;
    margin-top: 10px;
    }
  #luckyWheelDetail .active-rule .active-rule-title{
    color: #fff;
    height: 40px;
    line-height: 40px;
    text-align: center;
    font-weight: bold;
    }
  #luckyWheelDetail .active-rule .strip-content{
    background: #AE2C53;
    padding: 10px;
    border-radius:5px;
  }
  #luckyWheelDetail .active-rule .strip-content .strip-time{
  	padding: 5px 0;
  }
  #luckyWheelDetail .active-rule .strip-content .sharesTimes{
  	padding-bottom: 5px;
  }
  #luckyWheelDetail .active-rule .strip-content div{
  	color: #fff;
    font-size: 12px;
    line-height: 25px;

  }
  #luckyWheelDetail .strip-content ul{
      color: #fff;
      font-size: 12px;
      margin-left: 16px;
      list-style:inherit;
  }
  #luckyWheelDetail .strip-content ul li{
      list-style: inherit;
      line-height: 25px;
  }
  #luckyWheelDetail .strip-content ul .exchangeTimes,
  #luckyWheelDetail .strip-content ul .sharesTimes{
      display: none;
  }
  /*抽奖机会用尽弹窗*/
 #luckyWheelDetail .duraMaxDiv{
 	width: 100%;
 	height: 100%;
 	position: fixed;
 	left: 0;
 	top: 0;
 	background: rgba(0,0,0,.4);
 	z-index: 1200;
 	display: none;
 }
 #luckyWheelDetail .degreeDiv{
 	width: 100%;
 	height: 100%;
 	position: absolute;
 	left: 0;
 	top: 0;
 	background: rgba(0,0,0,.4);
 	z-index: 1200;
 	display: none;
 }
 #luckyWheelDetail .duraMaxDiv .duraMaxDiv-wrap,
 #luckyWheelDetail .degreeDiv .degreeDiv-wrap{
 	width: 230px;
 	height: 148px;
 	background: #fff;
 	border-radius: 4px;
 	margin: 0 auto;
 	margin-top: 190px;
 }
 #luckyWheelDetail .duraMaxDiv .duraMaxDiv-wrap .duraMaxDiv-con{
 	height: 98px;
 	text-align: center;
 	box-sizing: border-box;
  padding-top: 23px;
  -moz-box-sizing:border-box; /* Firefox */
  -webkit-box-sizing:border-box; /* Safari */
 }
 #luckyWheelDetail .degreeDiv .degreeDiv-wrap .degreeDiv-con{
  height: 98px;
 	text-align: center;
 	box-sizing: border-box;
  line-height: 98px;
  -moz-box-sizing:border-box; /* Firefox */
  -webkit-box-sizing:border-box; /* Safari */
 }
 #luckyWheelDetail .duraMaxDiv .duraMaxDiv-wrap .duraMaxDiv-con .balance,
 #luckyWheelDetail .degreeDiv .degreeDiv-wrap .degreeDiv-con .balance{
 	color: #ff7100;
 }
 #luckyWheelDetail .duraMaxDiv .duraMaxDiv-wrap .duraMaxDiv-btns,
 #luckyWheelDetail .degreeDiv .degreeDiv-wrap .degreeDiv-btns{
 	height: 49px;
 	width: 100%;
  border-top: 1px solid #e6e6e6;
 }
 #luckyWheelDetail .duraMaxDiv .duraMaxDiv-wrap .duraMaxDiv-btns .duraMaxDiv-confirm,
 #luckyWheelDetail .degreeDiv .degreeDiv-wrap .degreeDiv-btns .degreeDiv-confirm{
 	width: 114px;
 	float: left;
 	text-align: center;
 	line-height: 49px;
 	color: #ff7100;
 	border-right: 1px solid #e6e6e6;
 }
 #luckyWheelDetail .duraMaxDiv .duraMaxDiv-wrap .duraMaxDiv-btns .duraMaxDiv-cancel,
 #luckyWheelDetail .degreeDiv .degreeDiv-wrap .degreeDiv-btns .degreeDiv-cancel{
 	width: 114px;
 	float: left;
 	text-align: center;
 	line-height: 49px;
 	color: #333333;
 }
 /*兑换次数弹窗*/
 #luckyWheelDetail .exchange{
 	width: 100%;
 	height: 100%;
 	position: fixed;
 	left: 0;
 	top: 0;
 	background: rgba(0,0,0,.4);
 	z-index: 1200;
 	display: none;
 }
 #luckyWheelDetail .exchange .exchange-wrap{
 	width: 230px;
 	background: #fff;
 	border-radius: 4px;
 	margin: 0 auto;
 	margin-top: 150px;
 }
 #luckyWheelDetail .exchange .exchange-wrap .exchange-con{
 	padding-top: 25px;
 	margin-bottom: 16px;
  font-size: 14px;
  color: #999;
 }
 #luckyWheelDetail .exchange-con .exchangeCan{
  width: 188px;
  margin: 0 auto;
  text-align: center;
  margin-bottom: 15px;
  color: #000;
 }
 #luckyWheelDetail .exchange-con .exchangeCan span{
 	color: #ff7100;
 }
 #luckyWheelDetail .exchange-con .exchangeLimit{
 width: 188px;
 color: #999;
 padding: 5px 0;
 margin: 0 auto;
 border-bottom: 1px solid #D2D3D5;
 }
 #luckyWheelDetail .exchange-con .exchangeLimit input{
 	border: none;
 	outline: none;
 	width: 90px;
 	color: #000;
 }
 #luckyWheelDetail .exchange-con .exchangeLimit span{
 	color: #ff7100;
 	font-size: 12px;
 	cursor: pointer;
 }
 #luckyWheelDetail .exchange-con .exchangeRule{
 width: 188px;
 padding: 8px 0;
 margin: 0 auto;
 }
 #luckyWheelDetail .exchange-con .exchangeBalance{
 width: 188px;
 padding: 5px 0;
 margin: 0 auto;
 }
 #luckyWheelDetail .exchange .exchange-wrap .exchange-btns{
 	height: 49px;
 	width: 100%;
 	font-size: 15px;
  border-top: 1px solid #e6e6e6;
 }
 #luckyWheelDetail .exchange .exchange-wrap .exchange-btns .exchange-confirm{
 	width: 114px;
 	float: left;
 	text-align: center;
 	line-height: 49px;
 	color: #ff7100;
 	border-right: 1px solid #e6e6e6;
 }
 #luckyWheelDetail .exchange .exchange-wrap .exchange-btns .exchange-cancel{
 	width: 114px;
 	float: left;
 	text-align: center;
 	line-height: 49px;
 	color: #333333;
 }
/*中奖弹窗*/
#luckyWheelDetail .Congratulations_sick{
	width: 100%;
 	height: 100%;
 	position: fixed;
 	left: 0;
 	top: 0;
 	background: rgba(0,0,0,.8);
 	z-index: 1200;
 	display: none;
}
#luckyWheelDetail .Congratulations_sick .Congratulations_wrap{
	width: 286px;
 	height: 280px;
 	margin: 0 auto;
 	margin-top: 90px;
}
#luckyWheelDetail .Congratulations_sick .Congratulations_wrap .Congratulations-con{
	width: 100%;
	height: 244px;
	position: relative;
}
#luckyWheelDetail .Congratulations_sick .Congratulations_wrap .Congratulations-con img{
	width: 100%;
	height: 100%;
}
#luckyWheelDetail .Congratulations_sick .Congratulations_wrap .Congratulations-con span{
	  position: absolute;
    display: block;
    left: 60px;
    top: 145px;
    width: 180px;
    color: #fff;
    font-size: 20px;
    font-weight: bold;
    text-align: center;
    word-break: break-all;
}
#luckyWheelDetail .Congratulations_sick .Congratulations_wrap .Congratulations-btns{
	height: 26px;
	width: 100%;
	margin-top: 20px;
}
#luckyWheelDetail .Congratulations_sick .Congratulations_wrap .Congratulations-btns .btns{
	width: 80px;
	float: left;
	height: 30px;
	line-height: 30px;
	background: #FFE71D;
	text-align: center;
	margin-left: 20px;
	color: #bf1e2e;
	font-size: 12px;
	border-radius: 2px;
}
/*我的中奖记录弹窗*/
#luckyWheelDetail .record_sick{
	width: 100%;
 	height: 100%;
 	position: fixed;
 	left: 0;
 	top: 0;
 	background: rgba(0,0,0,.8);
 	z-index: 1200;
 	display: none;
}
#luckyWheelDetail .record_sick .record_wrap{
	width: 300px;
	height: auto;
	margin: auto;
	margin-top: 50px;
  position: relative;
}
#luckyWheelDetail .record_sick .record_wrap .img_con{
	width: 300px;
  height: 280px;
  position: absolute;
  left: -25px;
  top: -40px;
}
#luckyWheelDetail .record_sick .record_wrap .record_header{
	width: 270px;
	height: 55px;
	margin: 0 auto;
	background-image: url(http://cdn.jisuapp.cn/zhichi_frontend/static/webapp/images/prize_header.png);
	background-size: 100% 100%;
  background-repeat: no-repeat;
}
#luckyWheelDetail .record_sick .record_wrap .record_content{
  width: 255px;
  background: #f8f0d1;
  margin: 0 auto;
  position: relative;
  height: 350px;
  margin-top: -10px;
  overflow: hidden;
}
#luckyWheelDetail .record_sick .record_wrap .record_content .content_title{
	width: 100%;
	height: 40px;
	border-bottom: 1px dashed #e3dcb1;
	position: relative;
}
#luckyWheelDetail .record_sick .record_wrap .record_content .content_title span{
	width: 50%;
	display: inline-block;
	height: 100%;
	font-weight: bold;
	color: #890200;
	text-align: center;
	line-height: 40px;
	float: left;
}
#luckyWheelDetail .record_sick .record_wrap .record_content .content_title .record_line{
	  width: 0px;
    height: 25px;
    border-left: 1px dashed #e3dcb1;
    position: absolute;
    left: 126px;
    top: 10px;
}
#luckyWheelDetail .record_sick .record_wrap .record_content .prizeList{
	height: 300px;
  overflow: auto;
  position: absolute;
  left: 0;
  width: 100%;
  top: 41px;
}
#luckyWheelDetail .record_sick .record_wrap .record_content .prizeList li{
	height: 30px;
	line-height: 30px;
}
#luckyWheelDetail .record_sick .record_wrap .record_content .prizeList li span{
	text-align: center;
	width: 50%;
	height: 100%;
	color: #666666;
	display: inline-block;
}
#luckyWheelDetail .record_sick .record_wrap .record_content .record_fail{
  text-align: center;
  margin-top: 90px;
  margin-bottom: 60px;
}
#luckyWheelDetail .record_sick .record_wrap .record_content .record_fail img{
	width: 80px;
	height: 35px;
}
#luckyWheelDetail .record_sick .record_wrap .record_content .record_fail p{
	color: #cdc48d;
	margin-top: 30px;
}
#luckyWheelDetail .consolation_sick{
	width: 100%;
 	height: 100%;
 	position: fixed;
 	left: 0;
 	top: 0;
 	background: rgba(0,0,0,.8);
 	z-index: 1200;
 	display: none;
}
#luckyWheelDetail .notwinning_sick{
	width: 100%;
 	height: 100%;
 	position: fixed;
 	left: 0;
 	top: 0;
 	background: rgba(0,0,0,.8);
 	z-index: 1200;
 	display: none;
}
#luckyWheelDetail .consolation_sick .consolation_wrap,
#luckyWheelDetail .notwinning_sick .notwinning_wrap{
	margin: 0 auto;
	margin-top: 112px;
	width: 230px;
	height: 250px;
	background: #FDFFDA;
	border-bottom-left-radius: 5px;
	border-bottom-right-radius: 5px;

}
#luckyWheelDetail .consolation_sick .consolation_wrap .consolation_title,
#luckyWheelDetail .notwinning_sick .notwinning_wrap .notwinning_title{
	height: 42px;
	line-height: 42px;
	text-align: center;
	background: #FEE94E;
	color: #7a2716;
	font-weight: bold;
	border-bottom: 1px dashed #e3dcb1;
	position: relative;
}
#luckyWheelDetail .consolation_sick .consolation_wrap .consolation_title:before,
#luckyWheelDetail .notwinning_sick .notwinning_wrap .notwinning_title:before{
	  content: '';
    position: absolute;
    top: 5px;
    bottom: 0;
    left: 0px;
    right: 0px;
    z-index: -1;
    background:#FEE94E;
}
#luckyWheelDetail .consolation_sick .consolation_wrap .consolation_title .conBefore,
#luckyWheelDetail .notwinning_sick .notwinning_wrap .notwinning_title .conBefore{
    width: 10px;
    height: 10px;
    border-radius: 50%;
    background: rgba(0,0,0,.8);
    position: absolute;
    left: -5px;
    top: 37px;
}
#luckyWheelDetail .consolation_sick .consolation_wrap .consolation_title .conAfter,
#luckyWheelDetail .notwinning_sick .notwinning_wrap .notwinning_title .conAfter{
    width: 10px;
    height: 10px;
    border-radius: 50%;
    background: rgba(0,0,0,.8);
    position: absolute;
    right: -5px;
    top: 37px;
}
#luckyWheelDetail .consolation_sick .consolation_wrap .consolation_con,
#luckyWheelDetail .notwinning_sick .notwinning_wrap .notwinning_con{
   text-align: center;

}
#luckyWheelDetail .consolation_sick .consolation_wrap .consolation_con img,
#luckyWheelDetail .notwinning_sick .notwinning_wrap .notwinning_con img{
	width: 65px;
	height: 35px;
	margin-top: 25px;
  margin-bottom: 20px;
}
#luckyWheelDetail .consolation_sick .consolation_wrap .consolation_con div,
#luckyWheelDetail .notwinning_sick .notwinning_wrap .notwinning_con div{
	color: #954d29;
	padding: 5px 0;
	font-weight: bold;
}
#luckyWheelDetail .consolation_sick .consolation_wrap .consolation_btns,
#luckyWheelDetail .notwinning_sick .notwinning_wrap .notwinning_btns{
	width: 100%;
	margin-top: 18px;
}
#luckyWheelDetail .consolation_sick .consolation_wrap .consolation_btns .push,
#luckyWheelDetail .notwinning_sick .notwinning_wrap .notwinning_btns .push{
	width: 80px;
	height: 30px;
	font-size: 12px;
	line-height: 30px;
	border-radius: 2px;
	text-align: center;
	background: #FEE94E;
	color: #954d29;
	float: left;
}
#plateDiv{
	width: 265px;
	height: 281px;
	margin: 0 auto;
  position: relative;
  margin-top: 25px;
  display: none;
}
#plateDiv #plate_img{
	width: 58px;
	height: 60px;
	position: absolute;
	left: 111px;
	top: 110px;
	cursor: pointer;
}
#plateDiv .plate-cont{
	width: 100%;
	height: 100%;

}
#plateDiv .plate-cont img{
	width: 100%;
	height: 100%;
}
#plateDiv .plate-cont .zf{
 width: 65px;
 height: 65px;
 border-radius: 5px;
 background: #FE7F3A;
 position: absolute;
 text-align: center;
 font-size: 10px;
 color: #fff;
}
#plateDiv .plate-cont .zf p{
  word-break: break-all;
}
#plateDiv .plate-cont .zf.active{
	background: rgba(255,113,0,.5);
}
#plateDiv .plate-cont .zf img{
	width: 30px;
  height: 30px;
  margin-top: 4px;
}
#plateDiv .plate-cont .zf0{
	left: 39px;
	top: 38px;
}
#plateDiv .plate-cont .zf1{
	left: 109px;
  top: 38px;
}
#plateDiv .plate-cont .zf2{
	left: 178px;
  top: 38px;
}
#plateDiv .plate-cont .zf3{
	left: 178px;
  top: 106px;
}
#plateDiv .plate-cont .zf4{
	left: 178px;
  top: 174px;
}
#plateDiv .plate-cont .zf5{
	left: 109px;
  top: 174px;
}
#plateDiv .plate-cont .zf6{
	left: 38px;
  top: 174px;
}
#plateDiv .plate-cont .zf7{
	 left: 38px;
   top: 106px;
}
</style>
<div class="luckyWheel page" id="luckyWheelDetail">
    <audio id="luckyAudio" src="app.htm" loop=""></audio>
    <img class="lucky-cantaniner" src="app_data/phone-container.png">


        <div class="pageMusic">
         <span class="icon icon-luckyMusic"></span>
        </div>

	<div class="lucky-wheel-content">

		<div class="motive">
			<img src="app_data/phone-motive.png">
		</div>
	<div class="phoneCx">
		<div class="todayChance">
			你今日还剩<span></span>次抽奖机会
		</div>
		<div class="personNum">
			,共有<span></span>人参加活动
		</div>
	</div>
		<div class="outDiv">

		<img id="tip" src="app_data/phone-start.png">
		<div class="outer-cont">
			<img id="img" src="app_data/phone-wheel.gif">

			<div class="zp1 zp">
          <span>谢谢参与</span>

           <img src="app_data/phone-free.png">
         </div>
         <div class="zp2 zp">
           <span>谢谢参与</span>

           <img src="app_data/phone-free.png">
         </div>
         <div class="zp3 zp">
           <span>谢谢参与</span>

           <img src="app_data/phone-free.png">
         </div>
         <div class="zp4 zp">
           <span>谢谢参与</span>

           <img src="app_data/phone-free.png">
         </div>
         <div class="zp5 zp">
           <span>谢谢参与</span>

           <img src="app_data/phone-free.png">
         </div>
         <div class="zp6 zp">
           <span>谢谢参与</span>

           <img src="app_data/phone-free.png">
         </div>
         <div class="zp7 zp">
          <span>谢谢参与</span>

           <img src="app_data/phone-free.png">
         </div>
         <div class="zp8 zp">
           <span>谢谢参与</span>

           <img src="app_data/phone-free.png">
         </div>
		</div>
		</div>
		<div id="plateDiv">
			<img id="plate_img" src="app_data/startSquare.png">
			<div class="plate-cont">
				<img src="app_data/phone-square.gif">
				<div class="zf zf0">
					<img src="app_data/phone-fail.png">
					<p>谢谢参与</p>
				</div>
				<div class="zf zf1">
					<img src="app_data/phone-fail.png">
					<p>谢谢参与</p>
				</div>
				<div class="zf zf2">
					<img src="app_data/phone-fail.png">
					<p>谢谢参与</p>
				</div>
				<div class="zf zf3">
					<img src="app_data/phone-fail.png">
					<p>谢谢参与</p>
				</div>
				<div class="zf zf4">
					<img src="app_data/phone-fail.png">
					<p>谢谢参与</p>
				</div>
				<div class="zf zf5">
					<img src="app_data/phone-fail.png">
					<p>谢谢参与</p>
				</div>
				<div class="zf zf6">
					<img src="app_data/phone-fail.png">
					<p>谢谢参与</p>
				</div>
				<div class="zf zf7">
					<img src="app_data/phone-fail.png">
					<p>谢谢参与</p>
				</div>
			</div>
		</div>
		<div class="structurePrize">
      <div class="lookPrize">查看奖品</div>
      <div class="exchangePrize">积分兑换</div>
    </div>
		<div class="winList">
			<div class="wintitle">中奖名单</div>
			<div class="winCon">
				<ul>
					<!-- <li>白果 抽中 10元优惠券</li> -->

				</ul>
			</div>
		</div>
        <div class="active-rule">
        	<div class="active-rule-title">活动规则</div>
        		<div class="strip-content">
        			<div class="strip-time"><span>活动时间：</span><span class="specific-time"></span></div>
        			<div class="textValue" style="word-break:break-all;">获奖后优惠券直接发放，可在个人中心的优惠券直接查看:</div>
        			<!-- <div class="prizedTotalBox">1.用户每日首次登录可获取<span>0</span>次抽奖机会</div>
        			<div class="drawTotalTimes">2.每日抽奖机会最多为<span>0</span>次</div>
        			<div class="exchangeTimes">3.每<span>0</span>积分可兑换一次抽奖机会</div>
        			<div class="sharesTimes">4.每成功分享1个好友可增加<span>0</span>次抽奖机会，最多可增加<span>0</span>次机会</div> -->
              <ul>
                <li class="prizedTotalBox">用户每日首次登录可获取<span>0</span>次抽奖机会</li>
                <li class="drawTotalTimes">每日抽奖机会最多为<span>0</span>次</li>
                <li class="exchangeTimes">每<span>0</span>积分可兑换一次抽奖机会</li>
                <li class="sharesTimes">每成功分享1个好友可增加<span>0</span>次抽奖机会，最多可增加<span>0</span>次机会</li>
              </ul>
        		</div>
        </div>
	</div>
	<!-- 抽奖次数已用完弹窗 -->
	<div class="duraMaxDiv">
		<div class="duraMaxDiv-wrap">
			<div class="duraMaxDiv-con">
					<p>对不起,您的抽奖<span class="balance">次数不足</span>,</p>
				    <p>分享给好友或者群聊,</p>
				    <p>将额外获得抽奖机会哦~</p>
			</div>
			<div class="duraMaxDiv-btns">
				<div class="duraMaxDiv-cancel">取消</div>
				<div class="duraMaxDiv-confirm">确定</div>
			</div>
		</div>
	</div>
	<!-- 抽奖次数已用完不可分享给好友弹窗 -->
	<div class="degreeDiv">
		<div class="degreeDiv-wrap">
			<div class="degreeDiv-con">
					<p>对不起,您的抽奖<span class="balance">次数不足</span></p>
			</div>
			<div class="degreeDiv-btns">
				<div class="degreeDiv-cancel">取消</div>
				<div class="degreeDiv-confirm">确定</div>
			</div>
		</div>
	</div>
	 <!-- 抽中奖品弹窗 -->
 <div class="Congratulations_sick">
 	<div class="Congratulations_wrap">
 		<div class="Congratulations-con">
 			<img src="app_data/Congratulations.png">
 			<span></span>
 		</div>
 		<div class="Congratulations-btns">
 			<div class="btns Congratulations-confirm" style="margin-left: 54px;">确定</div>
 			<div class="btns Congratulations-share" style="margin-left: 25px;">分享给好友</div>
 		</div>
 	</div>
 </div>
  <!-- 我的中奖记录弹窗 -->
  <div class="record_sick">
  	<div class="record_wrap">

  		<div class="record_header"></div>
  		<div class="record_content">
      <img class="img_con" src="app_data/prize_con.png">
  			<div class="content_title">
  			    <div class="record_line"></div>
  				<span>中奖时间</span>
  				<span>获得奖品</span>
  			</div>
  			<ul class="prizeList">
  				<!-- <li><span>2017-06-21</span><span>20元优惠券</span></li> -->
  			</ul>
  			<div class="record_fail">
  				<img src="app_data/prize_fail.png">
  				<p>暂未获得任何奖品哦~</p>
  			</div>
  		</div>
  	</div>
  </div>
  <!-- 安慰奖弹窗 -->
  <div class="consolation_sick" id="consolation_sick">
  	<div class="consolation_wrap">
  		<div class="consolation_title">安慰奖
          <div class="conBefore"></div>
          <div class="conAfter"></div>
  		</div>
  		<div class="consolation_con">
  			<img src="app_data/consolation.png">
  			<div>又没中奖，送你个小礼品</div>
  			<div>在优惠券卡包进行查收哦~</div>
  		</div>
  		<div class="consolation_btns">
  			<div class="push consolation_confirm" style="margin-left: 25px;">确定</div>
  			<div class="push consolation_share" style="margin-left: 18px;">分享给好友</div>
  		</div>
  	</div>
  </div>
  <!-- 未中奖弹窗 -->
  <div class="notwinning_sick" id="notwinning_sick">
  	<div class="notwinning_wrap">
  		<div class="notwinning_title">未中奖
          <div class="conBefore"></div>
          <div class="conAfter"></div>
  		</div>
  		<div class="notwinning_con">
  			<img src="app_data/notWinning.png">
  			<div>很遗憾！</div>
  			<div>您什么都没抽中哦~</div>
  		</div>
  		<div class="notwinning_btns">
  			<div class="push notwinning_confirm" style="margin-left: 25px;">确定</div>
  			<div class="push notwinning_share" style="margin-left: 18px;">分享给好友</div>
  		</div>
  	</div>
  </div>
  <!-- 兑换次数弹窗 -->
  <div class="exchange">
		<div class="exchange-wrap">
			<div class="exchange-con">
				<div class="exchangeCan">可兑换次数:<span></span><span>次</span></div>
				<div class="exchangeLimit">兑换:<input onkeyup="value=value.replace(/[^\d]/g,'')" type="text"><span class="exchangeAll allSale">全部兑换</span></div>
				<div class="exchangeRule">兑换规则:<span></span>分/次</div>
				<div class="exchangeBalance">积分余额:<span></span>分</div>
			</div>
			<div class="exchange-btns">
				<div class="exchange-cancel">取消</div>
				<div class="exchange-confirm">确定</div>
			</div>
		</div>
	</div>
</div>


    <style type="text/css">
	#winningRecord{
	 background-color: #eee;
     height: 100%;
	}
	#winningRecord .record-tab-list {
	  position: fixed;
	  top: 0;
	  left: 0;
	  right: 0;
	  z-index: 1;
	  line-height: 38px;
	  background: #fff;
	  text-align: center;
    }
    #winningRecord .record-content-container{
	  margin-top: 47px;
	  overflow-x: hidden;
	  overflow-y: auto;
    }
    #winningRecord .record-content-container .record-none{
		text-align:center;

	  height:50px;
	  line-height:50px;
	  color:#c2c2c2;

    }
    #winningRecord .record-tab-list > li {
      border-bottom: 1px solid transparent;
      width: 100%;
      float: left;
    }
    #winningRecord .record-tab-list > li.active {
	  color: #ff7100;
	  /*border-color: #ff7100;*/
    }
    #winningRecord .luckyWheel-list{

    }
    #winningRecord .luckyWheel-list li{
    	padding: 20px 15px 20px 15px;
    	background: #fff;
    	margin-bottom: 5px;
    }
    #winningRecord .luckyWheel-list li .record-start{
    	height: 30px;
    	line-height: 30px;
    	margin-top: 5px;
    }
    #winningRecord .luckyWheel-list li .record-start p{
    	display: inline-block;
    	float: left;

    }
    #winningRecord .luckyWheel-list li .record-start span{
    	float: right;
    	display: inline-block;
    }
    #winningRecord .luckyWheel-list li .record-name{
    	color: #333333;
    	font-size: 16px;
    }
    #winningRecord .luckyWheel-list li .record-start,.luckyWheel-list li .record-end{
    	color: #666666;
    	font-size: 13px;
    }

</style>
<div class="winningRecord page" id="winningRecord">
	<div class="winningRecord-wrap">
		<ul class="record-tab-list">
			<li class="active" data-category="1">大转盘</li>
			<!-- <li class="" data-category="2">砸金蛋</li>
			<li data-category="3">刮刮乐</li> -->
		</ul>
		<div class="record-luckyWheel record-content-container">
			<ul class="luckyWheel-list">

			</ul>
			<div class="record-none">暂无任何中奖记录</div>
		</div>
		<!-- <div class="record-golden record-content-container">

		</div> -->
	</div>
</div>
<script>
	$(function(){
		// $('#winningRecord').on('click','.record-tab-list>li',function(){
		// 	$(this).addClass('active').siblings().removeClass('active');
  //          // var name=$(this).attr('data-href');
  //          // $('.record-'+name).show().siblings('.record-content-container').hide();
		// })
	})
</script>
  <div id="page10000" class="page zShow" data-router="page10000" style="padding-bottom: 52px;"><div class="ele-container"><div class="element search" style="margin-top: 0px; height: 50px; width: 320px; background-color: rgb(239, 239, 244);"><div class="search-input"><i class="icon-search"></i><span>请输入搜索内容</span></div></div></div><div class="ele-container"><div class="carousel" style="height: 162px; margin-left: 0px; margin-right: auto; margin-top: 0px; opacity: 1;"><div class="slick-carousel slick-initialized slick-slider" data-auto-play="true" data-interval="2000" role="toolbar"><div aria-live="polite" class="slick-list draggable"><div class="slick-track" style="opacity: 1; width: 1600px; transform: translate3d(-320px, 0px, 0px);" role="listbox"><div class="slick-slide slick-cloned" data-slick-index="-1" aria-hidden="true" style="width: 320px;" tabindex="-1"><img class="carousel-img router" src="app_data/file_599a9abf42e89.png" data-router="page10006"></div><div class="slick-slide slick-current slick-active" data-slick-index="0" aria-hidden="false" style="width: 320px;" tabindex="0" role="option" aria-describedby="slick-slide00"><img class="carousel-img router" src="app_data/file_599a9abf47666.png" data-router="page10004"></div><div class="slick-slide" data-slick-index="1" aria-hidden="true" style="width: 320px;" tabindex="-1" role="option" aria-describedby="slick-slide01"><img class="carousel-img router" src="app_data/file_599a9abf2ee9b.png" data-router="page10006"></div><div class="slick-slide" data-slick-index="2" aria-hidden="true" style="width: 320px;" tabindex="-1" role="option" aria-describedby="slick-slide02"><img class="carousel-img router" src="app_data/file_599a9abf42e89.png" data-router="page10006"></div><div class="slick-slide slick-cloned" data-slick-index="3" aria-hidden="true" style="width: 320px;" tabindex="-1"><img class="carousel-img router" src="app_data/file_599a9abf47666.png" data-router="page10004"></div></div></div><ul class="slick-dots" style="display: block;" role="tablist"><li class="slick-active" aria-hidden="false" role="presentation" aria-selected="true" aria-controls="navigation00" id="slick-slide00"><button type="button" data-role="none" role="button" aria-required="false" tabindex="0">1</button></li><li aria-hidden="true" role="presentation" aria-selected="false" aria-controls="navigation01" id="slick-slide01" class=""><button type="button" data-role="none" role="button" aria-required="false" tabindex="0">2</button></li><li aria-hidden="true" role="presentation" aria-selected="false" aria-controls="navigation02" id="slick-slide02" class=""><button type="button" data-role="none" role="button" aria-required="false" tabindex="0">3</button></li></ul></div></div></div><div class="ele-container"><div class="element free-vessel router" data-router="page10018" style="width: 320px; height: 40px; margin: 5px auto auto 0px; opacity: 1;"><div class="element picture" style="opacity: 1; background-color: transparent; border-color: rgb(34, 34, 34); border-radius: 0px; border-style: none; border-width: 0px; height: 40px; width: 320px; margin-left: 0px; margin-right: 0px; margin-top: 0px; position: absolute; left: 0px; top: 0px; right: auto;"><img src="app_data/file_599e79cc73e3b.png"></div></div></div><div class="ele-container"><div class="element free-vessel" style="width: 320px; height: 40px; background-color: rgb(246, 246, 246); margin: 5px auto auto 0px; opacity: 1;"><div class="element picture router" data-router="page10017" style="opacity: 1; background-color: transparent; border-color: rgb(34, 34, 34); border-radius: 0px; border-style: none; border-width: 0px; height: 40px; width: 320px; margin-left: 0px; margin-right: 0px; margin-top: 0px; position: absolute; left: 0px; top: 0px;"><img src="app_data/file_599ab096810bb.png"></div></div></div><div class="ele-container"><div class="element seckill list-vessel-wrap scroll-ele js-scroll-loading-ele" data-id="list-372415084625" data-form="goods" data-type="goods-list" style="background-color: rgb(243, 243, 243); margin-top: 0px; opacity: 1; color: rgb(102, 102, 102); font-size: 14px; height: auto;"><ul class="js-list-container third-goods-list js-no-more" data-list-index="0"><li class="goods-list-item background-ele router js-to-detail " data-id="1262877" data-router="seckillDetail" style="margin-bottom: 0px; background-color: rgb(255, 255, 255); height: 250px;"><div class="inner-content"><img class="list-img" src="app_data/file_599d4810ee2b5.jpg" style="width: 150px; height: 150px;"><div class="title-container" style="width: 150px;"><p class="title">四轴迷你无人机航拍飞行器高清专业飞机玩具摇遥控飞机直升机航模</p><div class="seckill-list-bottom seckill-during" style="width: 150px;"><div><span class="price">￥1.00</span><span class="oldprice">￥198.00</span></div><div><div class="seckill-progress-wrap"><span>已售100%</span><div class="seckill-progress"><span style="width: 100%;"></span></div></div><div class="countdown"><label>距结束</label><span class="hours">6763</span>:<span class="minutes">23</span>:<span class="seconds">01</span></div></div></div></div></div></li><li class="goods-list-item background-ele router js-to-detail " data-id="1262865" data-router="seckillDetail" style="margin-bottom: 0px; background-color: rgb(255, 255, 255); height: 250px;"><div class="inner-content"><img class="list-img" src="app_data/file_599d47bda436f.jpg" style="width: 150px; height: 150px;"><div class="title-container" style="width: 150px;"><p class="title">美嘉欣合金耐摔遥控飞机超大儿童成人充电动玩具直升机航拍无人机</p><div class="seckill-list-bottom seckill-during" style="width: 150px;"><div><span class="price">￥1.00</span><span class="oldprice">￥198.00</span></div><div><div class="seckill-progress-wrap"><span>已售1%</span><div class="seckill-progress"><span style="width: 1%;"></span></div></div><div class="countdown"><label>距结束</label><span class="hours">7267</span>:<span class="minutes">23</span>:<span class="seconds">01</span></div></div></div></div></div></li><li class="goods-list-item background-ele router js-to-detail " data-id="1262796" data-router="seckillDetail" style="margin-bottom: 0px; background-color: rgb(255, 255, 255); height: 250px;"><div class="inner-content"><img class="list-img" src="app_data/file_599d45e18f252.jpg" style="width: 150px; height: 150px;"><div class="title-container" style="width: 150px;"><p class="title">贝因美 金装爱+ 较大婴儿配方奶粉2段1000g*2罐</p><div class="seckill-list-bottom seckill-during" style="width: 150px;"><div><span class="price">￥1.00</span><span class="oldprice">￥498.00</span></div><div><div class="seckill-progress-wrap"><span>已售10%</span><div class="seckill-progress"><span style="width: 10%;"></span></div></div><div class="countdown"><label>距结束</label><span class="hours">7099</span>:<span class="minutes">23</span>:<span class="seconds">01</span></div></div></div></div></div></li><li class="goods-list-item background-ele router js-to-detail " data-id="1259237" data-router="seckillDetail" style="margin-bottom: 0px; background-color: rgb(255, 255, 255); height: 250px;"><div class="inner-content"><img class="list-img" src="app_data/file_599ba5b544714.jpg" style="width: 150px; height: 150px;"><div class="title-container" style="width: 150px;"><p class="title">MUJI 滑翔伞梭织布分装袋</p><div class="seckill-list-bottom seckill-during" style="width: 150px;"><div><span class="price">￥100.00</span><span class="oldprice">￥120.00</span></div><div><div class="seckill-progress-wrap"><span>已售0%</span><div class="seckill-progress"><span style="width: 0%;"></span></div></div><div class="countdown"><label>距结束</label><span class="hours">7099</span>:<span class="minutes">23</span>:<span class="seconds">01</span></div></div></div></div></div></li><li class="goods-list-item background-ele router js-to-detail " data-id="1258552" data-router="seckillDetail" style="margin-bottom: 0px; background-color: rgb(255, 255, 255); height: 250px;"><div class="inner-content"><img class="list-img" src="app_data/t_1503386456599bdb5829df3.jpg" style="width: 150px; height: 150px;"><div class="title-container" style="width: 150px;"><p class="title">Clarks童英伦小黑鞋校园皮鞋百搭舒适中童秋冬新品Obie Play Inf_copy_copy_copy</p><div class="seckill-list-bottom seckill-during" style="width: 150px;"><div><span class="price">￥100.00</span><span class="oldprice">￥198.00</span></div><div><div class="seckill-progress-wrap"><span>已售0%</span><div class="seckill-progress"><span style="width: 0%;"></span></div></div><div class="countdown"><label>距结束</label><span class="hours">7123</span>:<span class="minutes">23</span>:<span class="seconds">01</span></div></div></div></div></div></li><li class="goods-list-item background-ele router js-to-detail " data-id="1257886" data-router="seckillDetail" style="margin-bottom: 0px; background-color: rgb(255, 255, 255); height: 250px;"><div class="inner-content"><img class="list-img" src="app_data/file_599bcc9dcf390.jpg" style="width: 150px; height: 150px;"><div class="title-container" style="width: 150px;"><p class="title">recaro超级大黄蜂进口车载 儿童安全座椅9个月-12岁 简易安装</p><div class="seckill-list-bottom seckill-during" style="width: 150px;"><div><span class="price">￥1880.00</span><span class="oldprice">￥3880.00</span></div><div><div class="seckill-progress-wrap"><span>已售0%</span><div class="seckill-progress"><span style="width: 0%;"></span></div></div><div class="countdown"><label>距结束</label><span class="hours">7127</span>:<span class="minutes">25</span>:<span class="seconds">36</span></div></div></div></div></div></li><li class="goods-list-item background-ele router js-to-detail " data-id="1257876" data-router="seckillDetail" style="margin-bottom: 0px; background-color: rgb(255, 255, 255); height: 250px;"><div class="inner-content"><img class="list-img" src="app_data/file_599bcbfe6e385.jpg" style="width: 150px; height: 150px;"><div class="title-container" style="width: 150px;"><p class="title">belecoo贝丽可高景观婴儿推车可坐躺折叠双向四轮避震宝宝手推车</p><div class="seckill-list-bottom seckill-during" style="width: 150px;"><div><span class="price">￥1800.00</span><span class="oldprice">￥2800.00</span></div><div><div class="seckill-progress-wrap"><span>已售0%</span><div class="seckill-progress"><span style="width: 0%;"></span></div></div><div class="countdown"><label>距结束</label><span class="hours">7103</span>:<span class="minutes">25</span>:<span class="seconds">36</span></div></div></div></div></div></li><li class="goods-list-item background-ele router js-to-detail " data-id="1257648" data-router="seckillDetail" style="margin-bottom: 0px; background-color: rgb(255, 255, 255); height: 250px;"><div class="inner-content"><img class="list-img" src="app_data/file_599bc95d64623.jpg" style="width: 150px; height: 150px;"><div class="title-container" style="width: 150px;"><p class="title">棉法兰绒格子束腰长上衣</p><div class="seckill-list-bottom seckill-during" style="width: 150px;"><div><span class="price">￥100.00</span><span class="oldprice">￥178.00</span></div><div><div class="seckill-progress-wrap"><span>已售0%</span><div class="seckill-progress"><span style="width: 0%;"></span></div></div><div class="countdown"><label>距结束</label><span class="hours">5111</span>:<span class="minutes">12</span>:<span class="seconds">22</span></div></div></div></div></div></li></ul></div></div><div class="ele-container"><div class="element free-vessel" style="width: 320px; height: 54px; margin: 4px auto auto 0px; opacity: 1;"><div class="element picture" style="opacity: 1; background-color: transparent; border-color: rgb(34, 34, 34); border-radius: 0px; border-style: none; border-width: 0px; height: 54px; width: 320px; margin-left: 0px; margin-right: 0px; margin-top: 0px; position: absolute; left: 0px; top: 0px; right: auto;"><img src="app_data/file_599d39f5de295.png"></div></div></div><div class="ele-container"><div class="element free-vessel" style="width: 320px; height: 320px; background-color: rgb(255, 255, 255); margin: 0px auto auto 0px; opacity: 1;"><div class="element picture router" data-router="groupCenter" style="opacity: 1; background-color: transparent; border-color: rgb(34, 34, 34); border-radius: 0px; border-style: none; border-width: 0px; height: 198px; width: 198px; margin-left: 0px; margin-right: 0px; margin-top: 0px; position: absolute; left: 10px; top: 10px;"><img src="app_data/t_1503554741599e6cb55081e.jpg"></div><div class="element picture router" data-router="page10004" style="opacity: 1; background-color: transparent; border-color: rgb(34, 34, 34); border-radius: 0px; border-style: none; border-width: 0px; height: 96px; width: 96px; margin-left: 0px; margin-right: 0px; margin-top: 0px; position: absolute; left: 214px; top: 10px;"><img src="app_data/file_599b9f0fa3f12.png"></div><div class="element picture router" data-router="page10004" style="opacity: 1; background-color: transparent; border-color: rgb(34, 34, 34); border-radius: 0px; border-style: none; border-width: 0px; height: 96px; width: 96px; margin-left: 0px; margin-right: 0px; margin-top: 0px; position: absolute; left: 215px; top: 112px;"><img src="app_data/file_599b9f18a9792.png"></div><div class="element picture" style="opacity: 1; background-color: transparent; border-color: rgb(34, 34, 34); border-radius: 0px; border-style: none; border-width: 0px; height: 96px; width: 96px; margin-left: 0px; margin-right: 0px; margin-top: 0px; position: absolute; left: 215px; top: 216px;"><img src="app_data/file_599ba00a1d575.png"></div><div class="element picture router" data-router="page10017" style="opacity: 1; background-color: transparent; border-color: rgb(34, 34, 34); border-radius: 0px; border-style: none; border-width: 0px; height: 96px; width: 198px; margin-left: 0px; margin-right: 0px; margin-top: 0px; position: absolute; left: 10px; top: 215px;"><img src="app_data/file_599b9f207b826.png"></div></div></div><div class="ele-container"><div class="element free-vessel" style="width: 320px; height: 54px; margin: 4px auto auto 0px; opacity: 1;"><div class="element picture" style="opacity: 1; background-color: transparent; border-color: rgb(34, 34, 34); border-radius: 0px; border-style: none; border-width: 0px; height: 54px; width: 320px; margin-left: 0px; margin-right: 0px; margin-top: 0px; position: absolute; left: 0px; top: 0.5px; right: auto;"><img src="app_data/file_599d3907d96cf.png"></div></div></div><div class="ele-container"><div class="element free-vessel" style="width: 320px; height: 310px; margin: 0px auto auto 0px; opacity: 1;"><div class="element picture router js-to-detail" data-router="goodsDetail" data-id="1258386" style="opacity: 1; background-color: transparent; border-color: rgb(34, 34, 34); border-radius: 0px; border-style: none; border-width: 0px; height: 155px; width: 320px; margin-left: 0px; margin-right: 0px; margin-top: 0px; position: absolute; left: 0px; top: 1px;"><img src="app_data/file_599aa8dd2ee0e.png"></div><div class="element picture router js-to-detail" data-router="goodsDetail" data-id="1258366" style="opacity: 1; background-color: transparent; border-color: rgb(34, 34, 34); border-radius: 0px; border-style: none; border-width: 0px; height: 155px; width: 320px; margin-left: 0px; margin-right: 0px; margin-top: 0px; position: absolute; left: 0px; top: 155px;"><img src="app_data/file_599aab03e13fd.png"></div></div></div><div class="ele-container"><div class="element free-vessel" style="width: 320px; height: 54px; margin: 4px auto auto 0px; opacity: 1;"><div class="element picture" style="opacity: 1; background-color: transparent; border-color: rgb(34, 34, 34); border-radius: 0px; border-style: none; border-width: 0px; height: 54px; width: 320px; margin-left: 0px; margin-right: 0px; margin-top: 0px; position: absolute; left: 0px; top: -0.5px;"><img src="app_data/file_599d3880675f5.png"></div></div></div><div class="ele-container"><div class="element free-vessel" style="width: 320px; height: 270px; background-color: rgb(255, 255, 255); margin: -1px auto auto 0px; opacity: 1;"><div class="element picture router js-to-detail" data-router="goodsDetail" data-id="1259215" style="opacity: 1; background-color: transparent; border-color: rgb(34, 34, 34); border-radius: 0px; border-style: none; border-width: 0px; height: 90px; width: 90px; margin-left: 0px; margin-right: 0px; margin-top: 0px; position: absolute; left: 15px; top: 70px;"><img src="app_data/file_599ba415d093c.jpg"></div><div class="element picture router js-to-detail" data-router="goodsDetail" data-id="1259212" style="opacity: 1; background-color: transparent; border-color: rgb(34, 34, 34); border-radius: 0px; border-style: none; border-width: 0px; height: 90px; width: 90px; margin-left: 0px; margin-right: 0px; margin-top: 0px; position: absolute; left: 115px; top: 70px;"><img src="app_data/file_599ba47d3c321.jpg"></div><div class="element picture router js-to-detail" data-router="goodsDetail" data-id="1259222" style="opacity: 1; background-color: transparent; border-color: rgb(34, 34, 34); border-radius: 0px; border-style: none; border-width: 0px; height: 90px; width: 90px; margin-left: 0px; margin-right: 0px; margin-top: 0px; position: absolute; left: 215px; top: 70px;"><img src="app_data/file_599ba4ae95dab.jpg"></div><div class="element text" style="background-color: rgba(0, 0, 0, 0); border-color: rgb(34, 34, 34); border-style: none; border-width: 2px; color: rgb(102, 102, 102); font-size: 16px; font-weight: bold; height: 19px; line-height: 19px; margin-left: 0px; margin-top: 0px; opacity: 1; text-align: left; position: absolute; left: 80px; top: 15px; margin-right: 0px; right: auto;">告别卧室脏乱收纳神器</div><div class="element text" style="background-color: rgba(0, 0, 0, 0); border-color: rgb(34, 34, 34); border-style: none; border-width: 2px; color: rgb(153, 153, 153); font-size: 14px; height: 19px; line-height: 19px; margin-left: 0px; margin-top: 0px; opacity: 1; text-align: left; position: absolute; left: 104.5px; top: 35px; margin-right: 0px; right: auto;">6款入选-口碑之选</div><div class="element picture router js-to-detail" data-router="goodsDetail" data-id="1259225" style="opacity: 1; background-color: transparent; border-color: rgb(34, 34, 34); border-radius: 0px; border-style: none; border-width: 0px; height: 90px; width: 90px; margin-left: 0px; margin-right: 0px; margin-top: 0px; position: absolute; left: 15px; top: 170px;"><img src="app_data/file_599ba4e3e4536.jpg"></div><div class="element picture router js-to-detail" data-router="goodsDetail" data-id="1259229" style="opacity: 1; background-color: transparent; border-color: rgb(34, 34, 34); border-radius: 0px; border-style: none; border-width: 0px; height: 90px; width: 90px; margin-left: 0px; margin-right: 0px; margin-top: 0px; position: absolute; left: 115px; top: 170px;"><img src="app_data/t_1503372662599ba576abb2d.jpg"></div><div class="element picture router js-to-detail" data-router="goodsDetail" data-id="1259237" style="opacity: 1; background-color: transparent; border-color: rgb(34, 34, 34); border-radius: 0px; border-style: none; border-width: 0px; height: 90px; width: 90px; margin-left: 0px; margin-right: 0px; margin-top: 0px; position: absolute; left: 215px; top: 170px;"><img src="app_data/file_599ba5b544714.jpg"></div></div></div><div class="ele-container"><div class="element free-vessel" style="width: 320px; height: 191px; background-color: rgb(255, 255, 255); margin: 0px auto auto 0px; opacity: 1;"><div class="element picture router js-to-detail" data-router="goodsDetail" data-id="1259261" style="opacity: 1; background-color: transparent; border-color: rgb(34, 34, 34); border-radius: 0px; border-style: none; border-width: 0px; height: 90px; width: 90px; margin-left: 0px; margin-right: 0px; margin-top: 0px; position: absolute; left: 15px; top: 70px;"><img src="app_data/t_1503373159599ba7677a23a.jpg"></div><div class="element picture router js-to-detail" data-router="goodsDetail" data-id="1259265" style="opacity: 1; background-color: transparent; border-color: rgb(34, 34, 34); border-radius: 0px; border-style: none; border-width: 0px; height: 90px; width: 90px; margin-left: 0px; margin-right: 0px; margin-top: 0px; position: absolute; left: 115px; top: 70px;"><img src="app_data/t_1503381362599bc7727fcca.jpg"></div><div class="element picture router js-to-detail" data-router="goodsDetail" data-id="1259270" style="opacity: 1; background-color: transparent; border-color: rgb(34, 34, 34); border-radius: 0px; border-style: none; border-width: 0px; height: 90px; width: 90px; margin-left: 0px; margin-right: 0px; margin-top: 0px; position: absolute; left: 215px; top: 70px;"><img src="app_data/t_1503381524599bc814e22cc.jpg"></div><div class="element text" style="background-color: rgba(0, 0, 0, 0); border-color: rgb(34, 34, 34); border-style: none; border-width: 2px; color: rgb(102, 102, 102); font-size: 16px; font-weight: bold; height: 19px; line-height: 19px; margin-left: 0px; margin-top: 0px; opacity: 1; text-align: left; position: absolute; left: 80px; top: 15px; margin-right: 0px; right: auto;">上班族神器便当盒精选</div><div class="element text" style="background-color: rgba(0, 0, 0, 0); border-color: rgb(34, 34, 34); border-style: none; border-width: 2px; color: rgb(153, 153, 153); font-size: 14px; height: 19px; line-height: 19px; margin-left: 0px; margin-top: 0px; opacity: 1; text-align: left; position: absolute; left: 104.5px; top: 35px; margin-right: 0px; right: auto;">3款入选-口碑之选</div></div></div><div class="ele-container"><div class="element title-ele" mode="0" style="opacity: 1; line-height: 50px; background-color: rgb(239, 239, 239); border-color: rgb(255, 0, 0); border-radius: 0px; border-style: none; border-width: 1px; color: rgb(102, 102, 102); font-size: 16px; font-weight: bold; margin-left: auto; margin-right: auto; margin-top: 0px; text-align: left;"><p><span class="title-text"><span class="mark" style="background-color: rgb(26, 147, 223);"></span><span class="js-text">童装</span></span></p></div></div><div class="ele-container"><div class="element goods-list list-vessel-wrap scroll-ele js-scroll-loading-ele" data-id="list-179050927982" data-form="goods" data-type="goods-list" style="background-color: rgb(243, 243, 243); margin-top: 0px; opacity: 1; color: rgb(102, 102, 102); font-size: 14px; height: auto;"><ul class="js-list-container third-goods-list js-no-more" data-list-index="0"><li class="goods-list-item background-ele router js-to-detail " data-id="1258437" data-router="goodsDetail" data-router-hidestock="" style="margin-bottom: 0px; background-color: rgb(255, 255, 255); height: 200px;"><div class="inner-content"><img class="list-img" src="app_data/t_1503385649599bd831dba4e.jpg" style="width: 140px; height: 140px;"><div class="title-container" style="width: 140px;"><p class="title">妙心坊童装春秋时尚潮流大白三件套_copy</p><p style="width: 140px;"><span class="price">￥59.00</span><span class="sales">销量：0</span></p></div></div></li><li class="goods-list-item background-ele router js-to-detail " data-id="1258434" data-router="goodsDetail" data-router-hidestock="" style="margin-bottom: 0px; background-color: rgb(255, 255, 255); height: 200px;"><div class="inner-content"><img class="list-img" src="app_data/file_599bd5ae803d5.jpg" style="width: 140px; height: 140px;"><div class="title-container" style="width: 140px;"><p class="title">妙心坊童装春秋时尚潮流大白三件套</p><p style="width: 140px;"><span class="price">￥59.00</span><span class="sales">销量：0</span></p></div></div></li><li class="goods-list-item background-ele router js-to-detail " data-id="1258403" data-router="goodsDetail" data-router-hidestock="" style="margin-bottom: 0px; background-color: rgb(255, 255, 255); height: 200px;"><div class="inner-content"><img class="list-img" src="app_data/file_599bd42df021c.jpg" style="width: 140px; height: 140px;"><div class="title-container" style="width: 140px;"><p class="title">妙心坊童装春秋季时尚潮流新款运动套装</p><p style="width: 140px;"><span class="price">￥59.00</span><span class="sales">销量：0</span></p></div></div></li><li class="goods-list-item background-ele router js-to-detail " data-id="1258386" data-router="goodsDetail" data-router-hidestock="" style="margin-bottom: 0px; background-color: rgb(255, 255, 255); height: 200px;"><div class="inner-content"><img class="list-img" src="app_data/file_599bd37fd9ff4.jpg" style="width: 140px; height: 140px;"><div class="title-container" style="width: 140px;"><p class="title">今日特卖 妙心坊童装春秋男女童条纹套装多色可选</p><p style="width: 140px;"><span class="price">￥59.00</span><span class="sales">销量：0</span></p></div></div></li><li class="goods-list-item background-ele router js-to-detail " data-id="1258379" data-router="goodsDetail" data-router-hidestock="" style="margin-bottom: 0px; background-color: rgb(255, 255, 255); height: 200px;"><div class="inner-content"><img class="list-img" src="app_data/file_599bd328ace9d.jpg" style="width: 140px; height: 140px;"><div class="title-container" style="width: 140px;"><p class="title">今日特卖 妙心坊儿童火影短袖套装</p><p style="width: 140px;"><span class="price">￥59.00</span><span class="sales">销量：0</span></p></div></div></li><li class="goods-list-item background-ele router js-to-detail " data-id="1258366" data-router="goodsDetail" data-router-hidestock="" style="margin-bottom: 0px; background-color: rgb(255, 255, 255); height: 200px;"><div class="inner-content"><img class="list-img" src="app_data/file_599bc95d64623.jpg" style="width: 140px; height: 140px;"><div class="title-container" style="width: 140px;"><p class="title">格子衫</p><p style="width: 140px;"><span class="price">￥188.00</span><span class="sales">销量：0</span></p></div></div></li></ul></div></div><div class="ele-container"><div class="element title-ele" mode="0" style="opacity: 1; line-height: 50px; background-color: rgb(239, 239, 239); border-color: rgb(34, 34, 34); border-radius: 0px; border-style: none; border-width: 0px; color: rgb(102, 102, 102); font-size: 16px; font-weight: bold; margin-left: auto; margin-right: auto; margin-top: 0px;"><p><span class="title-text"><span class="mark" style="background-color: rgb(26, 147, 223);"></span><span class="js-text">童鞋</span></span></p></div></div><div class="ele-container"><div class="element goods-list list-vessel-wrap scroll-ele js-scroll-loading-ele" data-id="list-207793355687" data-form="goods" data-type="goods-list" style="background-color: rgb(243, 243, 243); margin-top: 0px; opacity: 1; color: rgb(102, 102, 102); font-size: 14px; height: auto;"><ul class="js-list-container third-goods-list js-no-more" data-list-index="1"><li class="goods-list-item background-ele router js-to-detail " data-id="1258531" data-router="goodsDetail" data-router-hidestock="" style="margin-bottom: 0px; background-color: rgb(255, 255, 255); height: 200px;"><div class="inner-content"><img class="list-img" src="app_data/t_1503386561599bdbc1b8b6d.jpg" style="width: 140px; height: 140px;"><div class="title-container" style="width: 140px;"><p class="title">Clarks童英伦小黑鞋校园皮鞋百搭舒适中童秋冬新品Obie Play Inf_copy_copy</p><p style="width: 140px;"><span class="price">￥198.00</span><span class="sales">销量：0</span></p></div></div></li><li class="goods-list-item background-ele router js-to-detail " data-id="1258526" data-router="goodsDetail" data-router-hidestock="" style="margin-bottom: 0px; background-color: rgb(255, 255, 255); height: 200px;"><div class="inner-content"><img class="list-img" src="app_data/t_1503385947599bd95b85e23.jpg" style="width: 140px; height: 140px;"><div class="title-container" style="width: 140px;"><p class="title">Clarks童英伦小黑鞋校园皮鞋百搭舒适中童秋冬新品Obie Play Inf_copy</p><p style="width: 140px;"><span class="price">￥198.00</span><span class="sales">销量：0</span></p></div></div></li><li class="goods-list-item background-ele router js-to-detail " data-id="1258509" data-router="goodsDetail" data-router-hidestock="" style="margin-bottom: 0px; background-color: rgb(255, 255, 255); height: 200px;"><div class="inner-content"><img class="list-img" src="app_data/t_1503386330599bdada030d9.jpg" style="width: 140px; height: 140px;"><div class="title-container" style="width: 140px;"><p class="title">Clarks童英伦小黑鞋校园皮鞋百搭舒适中童秋冬新品Obie Play Inf</p><p style="width: 140px;"><span class="price">￥198.00</span><span class="sales">销量：0</span></p></div></div></li></ul></div></div><div class="ele-container"><div class="element title-ele" mode="0" style="opacity: 1; line-height: 50px; background-color: rgb(239, 239, 239); border-color: rgb(34, 34, 34); border-radius: 0px; border-style: none; border-width: 0px; color: rgb(102, 102, 102); font-size: 16px; font-weight: bold; margin-left: auto; margin-right: auto; margin-top: 0px;"><p><span class="title-text"><span class="mark" style="background-color: rgb(26, 147, 223);"></span><span class="js-text">收纳</span></span></p></div></div><div class="ele-container"><div class="element goods-list list-vessel-wrap scroll-ele js-scroll-loading-ele" data-id="list-447466347367" data-form="goods" data-type="goods-list" style="background-color: rgb(243, 243, 243); margin-top: 0px; opacity: 1; color: rgb(102, 102, 102); font-size: 12px; height: auto;"><ul class="js-list-container third-goods-list js-no-more" data-list-index="2"><li class="goods-list-item background-ele router js-to-detail " data-id="1259229" data-router="goodsDetail" data-router-hidestock="" style="margin-bottom: 0px; background-color: rgb(255, 255, 255); height: 200px;"><div class="inner-content"><img class="list-img" src="app_data/file_599ba56ea72cc.jpg" style="width: 140px; height: 140px;"><div class="title-container" style="width: 140px;"><p class="title">MUJI 滑翔伞梭织布分装袋</p><p style="width: 140px;"><span class="price">￥120.00</span><span class="sales">销量：0</span></p></div></div></li><li class="goods-list-item background-ele router js-to-detail " data-id="1259225" data-router="goodsDetail" data-router-hidestock="" style="margin-bottom: 0px; background-color: rgb(255, 255, 255); height: 200px;"><div class="inner-content"><img class="list-img" src="app_data/file_599ba4e3e4536.jpg" style="width: 140px; height: 140px;"><div class="title-container" style="width: 140px;"><p class="title">MUJI 硬纸板架/板柜/板盒</p><p style="width: 140px;"><span class="price">￥120.00</span><span class="sales">销量：0</span></p></div></div></li><li class="goods-list-item background-ele router js-to-detail " data-id="1259222" data-router="goodsDetail" data-router-hidestock="" style="margin-bottom: 0px; background-color: rgb(255, 255, 255); height: 200px;"><div class="inner-content"><img class="list-img" src="app_data/file_599ba4ae95dab.jpg" style="width: 140px; height: 140px;"><div class="title-container" style="width: 140px;"><p class="title">MUJI 聚丙烯收纳盒</p><p style="width: 140px;"><span class="price">￥120.00</span><span class="sales">销量：0</span></p></div></div></li><li class="goods-list-item background-ele router js-to-detail " data-id="1259215" data-router="goodsDetail" data-router-hidestock="" style="margin-bottom: 0px; background-color: rgb(255, 255, 255); height: 200px;"><div class="inner-content"><img class="list-img" src="app_data/file_599ba415d093c.jpg" style="width: 140px; height: 140px;"><div class="title-container" style="width: 140px;"><p class="title">MUJI 滑翔伞梭织布可折叠旅行用收纳包</p><p style="width: 140px;"><span class="price">￥120.00</span><span class="sales">销量：0</span></p></div></div></li><li class="goods-list-item background-ele router js-to-detail " data-id="1259212" data-router="goodsDetail" data-router-hidestock="" style="margin-bottom: 0px; background-color: rgb(255, 255, 255); height: 200px;"><div class="inner-content"><img class="list-img" src="app_data/file_599ba47d3c321.jpg" style="width: 140px; height: 140px;"><div class="title-container" style="width: 140px;"><p class="title">MUJI 滑翔伞梭织布可折叠旅行用收纳包</p><p style="width: 140px;"><span class="price">￥100.00</span><span class="sales">销量：0</span></p></div></div></li></ul></div></div><div class="ele-container"><div class="element title-ele" mode="0" style="opacity: 1; line-height: 50px; background-color: rgb(239, 239, 239); border-color: rgb(34, 34, 34); border-radius: 0px; border-style: none; border-width: 0px; color: rgb(102, 102, 102); font-size: 16px; font-weight: bold; margin-left: auto; margin-right: auto; margin-top: 0px;"><p><span class="title-text"><span class="mark" style="background-color: rgb(26, 147, 223);"></span><span class="js-text">餐盒</span></span></p></div></div><div class="ele-container"><div class="element goods-list list-vessel-wrap scroll-ele js-scroll-loading-ele" data-id="list-432808163809" data-form="goods" data-type="goods-list" style="background-color: rgb(243, 243, 243); margin-top: 0px; opacity: 1; color: rgb(102, 102, 102); font-size: 12px; height: auto;"><ul class="js-list-container third-goods-list js-no-more" data-list-index="3"><li class="goods-list-item background-ele router js-to-detail " data-id="1259270" data-router="goodsDetail" data-router-hidestock="" style="margin-bottom: 0px; background-color: rgb(255, 255, 255); height: 200px;"><div class="inner-content"><img class="list-img" src="app_data/file_599bc8069cfe9.jpg" style="width: 140px; height: 140px;"><div class="title-container" style="width: 140px;"><p class="title">神器餐盒</p><p style="width: 140px;"><span class="price">￥59.00</span><span class="sales">销量：6</span></p></div></div></li><li class="goods-list-item background-ele router js-to-detail " data-id="1259265" data-router="goodsDetail" data-router-hidestock="" style="margin-bottom: 0px; background-color: rgb(255, 255, 255); height: 200px;"><div class="inner-content"><img class="list-img" src="app_data/t_1503390668599bebccc1260.jpg" style="width: 140px; height: 140px;"><div class="title-container" style="width: 140px;"><p class="title">上班族神器餐盒</p><p style="width: 140px;"><span class="price">￥59.00</span><span class="sales">销量：12</span></p></div></div></li><li class="goods-list-item background-ele router js-to-detail " data-id="1259261" data-router="goodsDetail" data-router-hidestock="" style="margin-bottom: 0px; background-color: rgb(255, 255, 255); height: 200px;"><div class="inner-content"><img class="list-img" src="app_data/t_1503390622599beb9e0fd26.jpg" style="width: 140px; height: 140px;"><div class="title-container" style="width: 140px;"><p class="title">不锈钢餐盒</p><p style="width: 140px;"><span class="price">￥59.00</span><span class="sales">销量：0</span></p></div></div></li></ul></div></div><div class="bottom-nav background-ele" style="background-color: rgb(246, 246, 246); color: rgb(72, 62, 54); font-size: 12px; padding-bottom: 0px; padding-top: 4px;"><div class="item router" data-router="page10000" style="color: rgb(52, 52, 52); width: 25%;"><a href="javascript:;" class="img-thumb-wrap" style="width:30px;height:30px;"><img class="img-before" src="app_data/file_599e5bde35833.png" style="display: none;"><img class="img-after" src="app_data/file_599e5bead7480.png" style="display: inline-block;"></a><span class="bottom-text">首页</span></div><div class="item router" data-router="page10001" style="width: 25%;"><a href="javascript:;" class="img-thumb-wrap" style="width:30px;height:30px;"><img class="img-before" src="app_data/file_599e5bf67fc71.png"><img class="img-after" src="app_data/file_599e5bfd58d91.png"></a><span class="bottom-text">分类</span></div><div class="item router" data-router="shoppingCart" style="width: 25%;"><a href="javascript:;" class="img-thumb-wrap" style="width:30px;height:30px;"><img class="img-before" src="app_data/file_599e5c0d58b92.png"><img class="img-after" src="app_data/file_599e5c14e9ab9.png"></a><span class="bottom-text">购物车</span></div><div class="item router" data-router="page10002" style="width: 25%;"><a href="javascript:;" class="img-thumb-wrap" style="width:30px;height:30px;"><img class="img-before" src="app_data/file_599e5c21403b6.png"><img class="img-after" src="app_data/file_599e5c28beb03.png"></a><span class="bottom-text">个人</span></div></div></div></div>
  <div id="dialog-page-container" class="page-container" style="display: none;"></div>
  <div id="video-container" class="video-container">
    <div class="full-screen-iframe">
      <iframe src="app.htm" frameborder="0"></iframe>
      <span class="video-close">关闭</span>
    </div>
  </div>
  <div class="map-container" style="display: none;">
    <span class="map-close">×</span>
    <div class="map-container-module"></div>
  </div>
</div>
<div class="homepage-marketing-bar"><img src="app_data/logo.png">即速应用 技术支持<span class="close-bar">×</span></div>
<div class="modal fade" id="confirmModal">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-body"></div>
      <div class="modal-footer">
        <span class="confirm-btn confirmModal-confirm">确定</span>
        <span class="btn confirmModal-cancel">取消</span>
      </div>
    </div>
  </div>
</div>
<style rel="stylesheet">
.orderPay-dialog {
  text-align: center;
}
.orderPay-dialog-detail > div {
  line-height: 34px;
}
.orderPay-payment {
  text-align: left;
  padding: 0 15px;
}
.orderPay-payment > img {
  width: 100px;
}
.orderPay-pay-directly {
  margin: 0 15px;
}
.orderPay-dialog .check-box {
  margin-top: 3px;
}

</style>
<div class="orderPay-dialog page-dialog-wrap" id="orderPayDialog">
  <div class="page-bottom-dialog">
    <div class="page-bottom-content">
      <div class="page-dialog-close orderPay-dialog-close">×</div>
      <div class="dialog-block-item orderPay-dialog-title">请选择支付方式</div>
      <div class="dialog-block-item orderPay-dialog-detail">
        <!-- <div>请在20分钟内完成支付</div> -->
        <div>支付金额 ￥<span class="orderPay-pay-price">0.00</span></div>
        <div class="orderPay-payment"><img src="app_data/weixin.jpg"><span class="pull-right orderPay-check-box check-box checked" payment="0"><img src="app_data/checked.png"></span></div>
        <div class="orderPay-payment" payment="zfb"><img src="app_data/zhifubao.jpg"><span class="pull-right orderPay-check-box check-box" payment="1"><img src="app_data/checked.png"></span></div>
      </div>
      <div class="dialog-block-item">
        <div class="btn btn-red btn-block orderPay-pay-directly">支 付</div>
      </div>
    </div>
  </div>
</div>
<script>
(function(){
var orderPayDialog = $('#orderPayDialog');

orderPayDialog.on('click', '.orderPay-dialog-close', function(){
  orderPayDialog.find('.page-bottom-content').slideUp(400, function(){
    orderPayDialog.css('display', 'none');
  });

}).on('click', '.orderPay-check-box', function(){
  orderPayDialog.find('.orderPay-check-box.checked').removeClass('checked');
  $(this).addClass('checked');

}).on('click', '.orderPay-pay-directly', function(){
  var id = orderPayDialog.attr('order-id'),
      payment = orderPayDialog.find('.orderPay-check-box.checked').attr('payment');

  if(!id) {
    alertTip('order id undefined');
    return;
  }

  window.open('/index.php?r=AppShop/getUniPay&order_id='+id+'&payment_id='+payment);
});


})();


</script>

<style rel="stylesheet">
.page-address-dialog-wrap {
    background-color: #e2e3e0;
}

/*.page-address-dialog-wrap .page-dialog-title {
    margin-bottom: 15px;
    background-color: #F8F8F8;
    font-size: 15px;
    padding: 12px 15px;
    text-align: center;
}

.page-address-dialog-wrap .page-dialog-title span:first-child {
    color: #5C5C5C;
    position: absolute;
    left: 15px;
    top: 10px;
    cursor: pointer;
    padding: 5px;
}

.page-address-dialog-wrap .page-dialog-title span:last-child {
    color: #3B3B3B;
    letter-spacing: 1px;
}*/

.page-address-dialog-wrap .page-dialog-addNewAddress {
    position: relative;
    bottom: 0;
    left: 0;
    right: 0;
    text-align: center;
    padding: 15px;
    background-color: #F5F5F5;
    letter-spacing: 2px;
    font-size: 15px;
    color: black;
    cursor: pointer;
}


/*----------------------------------*/

.ck {
    display: none;
}

.ck+label {
    border: 1px solid #DDD;
    background-color: white;
    border-radius: 50%;
    display: inline-block;
    position: relative;
    width: 25px;
    height: 25px;
}

.ck:checked+label:after {
    content: '\2714';
    position: absolute;
    color: white;
    border-radius: 50%;
    top: 2px;
    left: 6px;
    width: 100%;
    height: 100%;
}

.ck:checked+label {
    background: #C7091D;
}

.page-dialog-addressList .dialog-block-item {
    zoom: 1;
    overflow: hidden;
    background: white;
    height: 80px;
}

.chooseaddressInfo {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    left: 10px;
}

.basicaddressInfo {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    left: 46px;
    width: 220px;
}

.basicaddressInfo p:first-child {
    padding-bottom: 10px;
}

.basicaddressInfo p:first-child span {
    font-weight: bold;
    padding-bottom: 5px;
}

.basicaddressInfo p:last-child span {
    text-overflow: ellipsis;
}

.basicaddressInfo p:first-child span:last-child {
    margin-left: 20px;
}

.editaddressInfo {
    width: 80px;
    position: absolute;
    right: 15px;
    top: 50%;
    transform: translateY(-50%);
}

.editaddressInfo span:first-child {
    float: left;
}

.editaddressInfo span:last-child {
    float: right;
}

.defaultaddress {
    color: #CA081B;
}

.address-check-box {
    display: inline-block;
    width: 20px;
    height: 20px;
    padding: 4px 3px;
    margin-right: 6px;
    box-sizing: border-box;
    border-radius: 50%;
    vertical-align: middle;
    line-height: 13px;
    background-color: white;
    border: 1px solid #989898;
}

.address-check-box img {
    width: 100%;
    height: 100%;
}

.address-checked {
    background-color: #C40B1D !important;
}
</style>
<div class="page-address-dialog-wrap page" id="addressDialog">
<!--     <div class="page-dialog-title">
        <span class="icon-leftarrow"></span><span>选择收货地址</span>
    </div> -->
    <div class="page-dialog-addressList">
    </div>
    <div class="page-dialog-addNewAddress">
        添加新地址
    </div>
</div>
<script>
var EditaddressData;
$("#addressDialog").on("click", ".page-dialog-addNewAddress", function() {
    $('#addressDialog').removeClass("zShow");
    $("#choose-takeDelivery-address").addClass("zShow");
    getAreaProvince();
});
// .on("click", ".page-dialog-title span:first-child", function() {
//     $('#addressDialog').removeClass("zShow");
//     $("#orderDetail").addClass("zShow");
// });
(function() {
    $(".page-dialog-addressList .chooseaddressInfo span").each(function(index, ele) {
        $(ele).click(function() {
            $(ele).addClass("address-checked");
            $(".page-dialog-addressList .chooseaddressInfo span").not($(ele)).remove("address-checked");
        });
    });
    $('#addressDialog').on("click", ".addressDialog-edit", function() {
        //编辑地址
        $('#addressDialog').removeClass("zShow");
        $("#editAddresswrap").addClass("zShow");
        getAreaeditProvince();
        var $editAddresswrap = $(".zShow");
        var addressData = EditaddressData = $(this).closest('.addressDialog-address').data("address-data");
        $editAddresswrap.find("#del-address-inedit").attr("address-id", addressData.id);

        var tempreceiver=$editAddresswrap.find('input[data-name="receiver"]');
        var tempphone=$editAddresswrap.find('input[data-name="phone"]');
        var tempdetailaddr=$editAddresswrap.find('input[data-name="detailAddress"]');
        var tempregion=$editAddresswrap.find('.editRegion');
        var tempckbox=$editAddresswrap.find('input[type="checkbox"]');
        if (addressData.address_info) {
            if(addressData.address_info.receiver){
                tempreceiver.val(addressData.address_info.receiver);
                tempphone.val(addressData.address_info.phone);
                tempdetailaddr.val(addressData.address_info.detailAddress);
                tempregion.text(addressData.address_info.region);
                if (addressData.address_info.defaultAddress != 0) {
                    tempckbox.prop("checked", true);
                } else {
                    tempckbox.prop("checked", false);
                }
            }else{
                tempreceiver.val(addressData.address_info.name);
                tempphone.val(addressData.address_info.contact);
                tempdetailaddr.val(addressData.address_info.detailAddress);
                tempregion.text(addressData.address_info.province.text+addressData.address_info.city.text+addressData.address_info.district.text);
                if (addressData.is_default != 0) {
                    tempckbox.prop("checked", true);
                } else {
                    tempckbox.prop("checked", false);
                }
            }

        } else {
            if(addressData.receiver){
                tempreceiver.val(addressData.receiver);
                tempphone.val(addressData.phone);
                tempdetailaddr.val(addressData.detailAddress);
                tempregion.text(addressData.region);
                if (addressData.defaultAddress != 0) {
                    tempckbox.prop("checked", true);
                } else {
                    tempckbox.prop("checked", false);
                }
            }else{
                tempreceiver.val(addressData.name);
                tempphone.val(addressData.contact);
                tempdetailaddr.val(addressData.detailAddress);
                tempregion.text(addressData.province.text+addressData.city.text+addressData.district.text);
                if (addressData.defaultAddress != 0) {
                    tempckbox.prop("checked", true);
                } else {
                    tempckbox.prop("checked", false);
                }
            }

        }


    });


})();



/*function getAddressStructor() {
    var html = "",
        fragment = document.createDocumentFragment(),
        comm_header = '<div class="addressDialog-close page-dialog-close">&times;</div><div class="dialog-block-item txt-c">新添地址</div>',
        comm_footer = ' <div class="flex-box dialog-block-item">' +
        '<div class="flex-sub-box-2"><span class="btn btn-block addressDialog-back">返回</span></div>' +
        '<div class="flex-sub-box-2"><span class="btn btn-red btn-block addressDialog-sure-add">添加</span></div>' +
        '</div>';
    $(fragment).append($(comm_header));
    $.ajax({
        url: "/index.php?r=pc/AppShop/GetDelivery",
        type: "GET",
        data: {
            app_id: GetQueryString("_app_id"),
            delivery_id: deliveryID
        },
        dataType: "JSON",
        success: function(data) {
            if (data.status === 0) {
                var deliveryData = data.data.delivery_info
                $.each(deliveryData, function(index, ele) {
                    html += '<div class="dialog-block-item"><span>' + ele.name + '</span>:';
                    switch (ele.type) {
                        case "text":
                            html += '<input type="text" class="input addressDialog-field"/></div>';
                            break;
                        case "mul-text":
                            html += '<input type="text" class="input addressDialog-field" data-name="detailAddress"/></div>';
                            break;
                        case "picture":
                            html += '<input type="file" class="input addressDialog-field"/><div>';

                    }
                    $(fragment).append($(html));
                    html = "";
                    console.log(fragment);
                });
                $(fragment).append($(comm_footer));
                $(".addressDialog-add-section").html("").prepend(fragment);
                $('.addressDialog-back').click(function() {
                    // 返回地址列表
                    $('.addressDialog-add-section').slideUp(400, function() {
                        $('.addressDialog-list-section').slideDown(400);
                    });
                });
            }
        },
        error: function(data) {
            alertTip(data.data);
        }
    });
}
(function() {


    $('#addressDialog').on('click', '.addressDialog-add-address', function() {
        getAddressStructor();
        // 展示添加地址弹框
        var provinceSelect = $('.addressDialog-province-select');

        $('.addressDialog-field').each(function() {
            $(this).val('');
        });

        if (provinceSelect.find('option').length <= 1) {
            getArea('.addressDialog-province-select', 0, function() {
                $('.addressDialog-province-select').prepend('<option value="">选择省</option>');
            });
        }

        $('.addressDialog-list-section').slideUp(400, function() {
            $('.addressDialog-add-section').slideDown(400);
        });

    }).on('click', '.addressDialog-back', function() {
        // 返回地址列表
         $('.addressDialog-add-section').slideUp(400, function() {
             $('.addressDialog-list-section').slideDown(400);
         });
   }).on('click', '.addressDialog-sure-add', function() {
        // 确定添加地址
        var val = info = '',
            para = {},
            name;

        $.each($('.addressDialog-field'), function(index, field) {
            val = $(field).val().trim();
            if (!val) {
                info = '请填写' + $(field).siblings('span').text() + '信息';
                return false;
            } else {
                name = $(field).attr('data-name');
                if (field.tagName.toLowerCase() === 'select') {
                    para[name] = {
                        text: $(field).find('option:selected').text(),
                        id: val
                    };
                } else {
                    para[$(field).attr('data-name')] = val;
                }
            }
        });

        if (info) {
            alertTip(info);
            return;
        }
        addAddress(para);

    }).on('click', '.addressDialog-close', function() {
        // 关闭地址弹框
        APP.closeAddressDialog();

    }).on('click', '.addressDialog-delete', function() {
        // 删除地址
        var id = $(this).closest('.addressDialog-address').attr('data-id');
        confirmTip({
            content: '确认删除该地址？'
        }, function() {
            deleteAddress(id);
        });

    }).on('change', '.addressDialog-province-select', function() {
        if (!$(this).val()) {
            $('.addressDialog-city-select').html('<option value="">选择市</option>');
            $('.addressDialog-district-select').html('<option value="">选择区</option>');
            return;
        }
        getArea('.addressDialog-city-select', $(this).val(), function() {
            $('.addressDialog-city-select').prepend('<option value="">选择市</option>');
            $('.addressDialog-district-select').html('<option value="">选择区</option>');
        });

    }).on('change', '.addressDialog-city-select', function() {
        if (!$(this).val()) {
            $('.addressDialog-district-select').html('<option value="">选择区</option>');
            return;
        }
        getArea('.addressDialog-district-select', $(this).val(), function() {
            $('.addressDialog-district-select').prepend('<option value="">选择区</option>');
        });

    }).on('click', '.addressDialog-check-box', function() {
        // 选择某个地址
        var address = $(this).closest('.addressDialog-address');

        $('.addressDialog-check-box.checked').removeClass('checked');
        $(this).addClass('checked');
        APP.closeAddressDialog();

        $.ajax({
            url: '/index.php?r=AppShop/setAddress',
            type: 'get',
            data: {
                order_id: $('.orderDetail-order-id').text(),
                address_id: $(this).closest('.addressDialog-address').attr('data-id')
            },
            dataType: 'json',
            success: function(data) {
                if (data.status !== 0) {
                    if (data.status === 2) {
                        alertTip('请先登录账号', function() {
                            APP.showLogin();
                        }, 700);
                    } else {
                        alertTip(data.data);
                    }
                    return;
                }
                $('.orderDetail-address-detail').html('<div>收件人：<span class="orderDetail-name">' + address.find('.addressDialog-name').text() + '</span></div><div>联系电话：<span class="orderDetail-contact">' + address.find('.addressDialog-contact').text() + '</span></div><div class="orderDetail-address" style="color:#aaa;">' + address.find('.addressDialog-address').text() + '</div>');

            }
        });
    });

    function getArea(container, pid, fn) {
        $.ajax({
            url: '/index.php?r=Region/getRegionList',
            type: 'get',
            data: {
                pid: pid
            },
            dataType: 'json',
            success: function(data) {
                if (data.status !== 0) {
                    alertTip(data.data);
                    return;
                }
                var list = data.data,
                    listStr = '';
                $(list).each(function(index, item) {
                    listStr += '<option value="' + item.id + '">' + item.name + '</option>';
                });
                $(container).html(listStr);
                $.isFunction(fn) && fn();
            },
            error: function(jqXHR, textStatus) {
                if (textStatus === 'timeout') {
                    alertTip('请求超时 请检查网络状况');
                } else {
                    alertTip('城市列表请求出错');
                }
            }
        });
    }

    function addAddress(para) {
        $.ajax({
            url: '/index.php?r=AppShop/addAddress',
            type: 'get',
            data: {
                address_info: para,
                ck_id: GetCookiePara()
            },
            dataType: 'json',
            success: function(data) {
                if (data.status !== 0) {
                    if (data.status === 2) {
                        alertTip('请先登录账号', function() {
                            APP.showLogin();
                        }, 700);
                    } else {
                        alertTip(data.data);
                    }
                    return;
                }
                para.id = data.data;
                APP.modifyAddressList(para);
                $('.addressDialog-add-section').slideUp(400, function() {
                    $('.addressDialog-list-section').slideDown(400);
                });
            }
        });
    }

    function deleteAddress(id) {
        if (!id) {
            alertTip('地址id为空');
            return;
        }
        $.ajax({
            url: '/index.php?r=AppShop/delAddress',
            type: 'get',
            data: {
                address_id: id
                    // ck_id: GetCookiePara()
            },
            dataType: 'json',
            success: function(data) {
                if (data.status !== 0) {
                    if (data.status === 2) {
                        alertTip('请先登录账号', function() {
                            APP.showLogin();
                        }, 700);
                    } else {
                        alertTip(data.data);
                    }
                    return;
                }
                $('.addressDialog-address').filter('[data-id=' + id + ']').remove();
            }
        });
    }

})();*/
</script>

<style rel="stylesheet">
#payDialog .thumb {
  float: left;
  width: 85px;
  height: 55px;
  margin: 2px 10px 0 10px;
  position: relative;
}
.dialog-goods-info{
  min-height: 55px;
}
#payDialog .thumb .thumb-wrap {
  width: 85px;
  height: 85px;
  position: absolute;
  bottom: 0;
  left: 0;
  border: 1px solid #dedede;
  border-radius: 5px;
  background-color: #fff;
  overflow: hidden;
}
#payDialog .thumb .thumb-wrap img{
  width: 100%;
  height: 100%;
}
#payDialog .goods-base-info {
  margin-left: 55px;
  display: inline-block;
}
#payDialog .pay-goods-title,
#payDialog .pay-goods-price {
  padding-right: 50px;
  line-height: 20px;
}
#payDialog .pay-goods-title{
  color: #353535;
  font-size: 14px;
}
#payDialog .pay-current-price {
  font-size: 12px;
  color: #ff6710
}
#payDialog .pay-current-price {
  vertical-align: bottom;
}
#payDialog .pay-current-price b {
  vertical-align: bottom;
  font-size: 14px;
}
.pay-checked-text{
  font-size: 12px;
}
.page-dialog-close span{
  display: block;
  width: 20px;
  height: 20px;
  border: 1px solid #67666f;
  color: #67666f;
  text-align: center;
  line-height: 20px;
  margin: 9px auto;
  border-radius: 50%;
  font-size: 26px;
}
#payDialog .pay-goods-models {
  margin: -10px 0;
}
#payDialog .pay-goods-models dl {
  border-bottom: 1px solid #eee;
  margin: 0;
  padding: 10px;
}
#payDialog .pay-goods-models dl:last-child {
  border-bottom: none;
}
#payDialog dt, #payDialog dd {
  display: inline-block;
  margin: 0;
  vertical-align: middle;
}
#payDialog dt {
  padding-bottom: 4px;
  font-weight: bold;
  color: #373737;
}
#payDialog .pay-goods-models dt{
  display: block;
}
#payDialog .pay-goods-models ul {
  /*margin: 10px 0;*/
  max-height: 300px;
  overflow: scroll;
}
#payDialog .pay-goods-models li {
  color: #353535;
  margin-top: 3px;
  margin-bottom: 3px;
  border-radius: 8px;
  padding: 5px 10px;
  border: none;
  background-color: #f5f5f5;
  line-height: 18px;
}
#payDialog .pay-goods-models li.select {
  position: relative;
  color:#fff;
  background-color: #ff7100;
}
#payDialog .pay-goods-models li.select:after {
  content: '';
  position: absolute;
  bottom: 0;
  right: 0;
  width: 12px;
  height: 12px;
}
#payDialog .pay-goods-stock {
  display: inline-block;
  margin: 5px 10px 0 0;
}
#payDialog .pay-buy-next,
#payDialog .pay-add-to-shoppingcart {
  margin-top: 10px;
  padding: 10px 0px;
  font-size: 16px;
  line-height: 24px;
  border-radius: 0px;
  flex: 1;
  -moz-box-flex: 1;
  -webkit-box-flex: 1;
  box-flex: 1;
}
#payDialog .minus,
#payDialog .plus {
  position: relative;
  display: inline-block;
  font-size: 16px;
  outline: 0!important;
  text-indent: -9999px;
  overflow: hidden;
  vertical-align: middle;
  width: 20px;
  height: 20px;
  line-height: 20px;
  font-weight: normal;
  background-color: #f1f1f1;
  color: #878787;
  border-radius: 2px;
}
#payDialog .minus.disabled,
#payDialog .plus.disabled {
  background-color: #f9f9f9;
  color: #cacaca;
}
#payDialog .minus:before,
#payDialog .plus:before,
#payDialog .plus:after {
  position:absolute;
  width:8px;
  height:2px;
  top:0;
  left:0;
  right:0;
  margin:auto;
  background-color:#878787;
  bottom:0;
  content:'';
}
#payDialog .plus:after {
  width:2px;
  height:8px;
}
#payDialog .minus.disabled:before,
#payDialog .plus.disabled:before,
#payDialog .plus.disabled:after {
  background-color: #cacaca;
}
#payDialog .pay-buy-count {
  border: none;
  height: 20px;
  background-color: #f1f1f1;
  padding: 0;
  margin: 0 1px;
  border-radius: 0;
}
.payDialog-buy-limit{
  font-size: 10px;
}
#payDialog .dialog-box-item{
  display: flex;
  display: box;
  display: -webkit-box;
  display: -o-box;
  display: -moz-box;
}
</style>
<div id="payDialog" class="page-dialog-wrap" style="display: none;">
  <div class="page-bottom-dialog">
    <div class="page-bottom-content">
      <div class="pay-close-dialog page-dialog-close"><span>×</span></div>
      <div class="dialog-block-item dialog-goods-info">
        <div class="thumb">
          <div class="thumb-wrap">
            <img class="pay-goods-cover" alt="">
          </div>
        </div>
        <div class="pay-goods-baseinfo">
          <p class="pay-goods-title ellipsis"></p>
          <div class="pay-goods-price">
            <div class="pay-current-price">
              <span class="">￥</span><b class="js-goods-price">299.00 - 388.00</b>
            </div>
            <!-- <div class="pay-original-price">淘价：￥953.00</div> -->
          </div>
          <div class="pay-checked-text clearfix">已选：</div>
        </div>
      </div>
      <div class="dialog-block-item">
        <div class="pay-goods-models">
          <!-- <dl>
            <dt>颜色分类：</dt>
            <dd>
              <ul class="pills-list">
                <li class="subModel">红色</li>
                <li class="subModel">黄色</li>
                <li class="subModel">三彩</li>
                <li class="subModel">绿色</li>
              </ul>
            </dd>
          </dl>
          <dl>
            <dt>头枕：</dt>
            <dd><ul class="pills-list">
                <li class="subModel">大</li>
                <li class="subModel">中</li>
                <li class="subModel">小</li>
              </ul></dd>
          </dl> -->
        </div>
      </div>
      <div class="dialog-block-item" style="padding-left:10px;padding-right:10px;">
        <dl class="payDialog-goods-num clearfix"><dt>数量</dt><dd class="pull-right"><span class="pull-left tostoreHide">库存 <span class="pay-goods-stock">6</span></span>
        <div class="quantity pull-left">
          <span class="minus disabled" type="button" disabled="true"></span><input class="pay-buy-count" value="1" type="text"><span class="plus" type="button"></span>
          <div class="response-area response-area-minus"></div>
          <div class="response-area response-area-plus"></div>
        </div></dd></dl>
      </div>
      <div class="dialog-box-item payDialog-normal">
        <div class="btn btn-block btn-yellow pay-add-to-shoppingcart">加入购物车</div>
        <div class="btn btn-block btn-orange pay-buy-next">下一步</div>
      </div>
      <div class="dialog-box-item payDialog-list-shopping">
        <div class="btn btn-block btn-yellow pay-add-to-shoppingcart">加入购物车</div>
        <div class="btn btn-block btn-orange pay-buy-next">立即购买</div>
      </div>
    </div>
  </div>
</div>

<script>
(function(){
var $payDialog = $('#payDialog');

$payDialog.on('click', '.response-area-plus', function(){
  var $input = $(this).siblings('input'),
      num = Number($input.val()),
      $minusBtn = $(this).siblings('.minus'),
      $plusBtn = $(this).siblings('.plus');
      stock = Number($('#payDialog .pay-goods-stock').text()) || 0,
      goodsInfo = $payDialog.data('goods-info');

  if($plusBtn.hasClass('disabled')){
    return;
  }
  $minusBtn.removeClass('disabled');
  if(num >= stock){
    $plusBtn.addClass('disabled');
    alertTip('商品数量不能大于库存');
    return ;
  }
  if(goodsInfo.is_seckill == 1 && num >= goodsInfo.seckill_buy_limit){
    $plusBtn.addClass('disabled');
    alertTip('商品数量不能大于秒杀限购数量');
    return ;
  }
  $input.val(num+1);

}).on('click', '.response-area-minus', function(){
  var $input = $(this).siblings('input'),
      num = Number($input.val()) || 2,
      $minusBtn = $(this).siblings('.minus'),
      $plusBtn = $(this).siblings('.plus');

  if($minusBtn.hasClass('disabled')){
    return;
  }
  $plusBtn.removeClass('disabled');
  if(num <= 1){
    $minusBtn.addClass('disabled');
    return;
  }
  $input.val(num - 1);

}).on('click', '.subModel', function(){
  // 支付框里点击选择型号
  var goodsInfo = $payDialog.data('goods-info'),
      models = goodsInfo.model_items,
      modelLength = $payDialog.find('.pay-goods-models dl').length,
      stock = 0,
      selectSub, subModelArr, length, price,text = '已选：',imgurl = '';

  $(this).addClass('select').siblings('.select').removeClass('select');
  selectSub = $payDialog.find('.subModel.select');
  models.length && $.each(models, function(index, item){
    subModelArr = item.model.split(',');
    length = 0;
    $.each(selectSub, function(i, m){
      if(subModelArr.indexOf($(m).attr('data-id')) >= 0){
        length++;
      }
    });
    // is_seckill 为1 表示秒杀商品，取秒杀的库存与价格
    if(length === selectSub.length){
      stock = goodsInfo.is_seckill == 1 ? Number(item.seckill_stock) : Number(item.stock);
      // if(length === modelLength){
      imgurl = item.img_url || goodsInfo.cover;
        price = goodsInfo.is_seckill == 1 ? item.seckill_price : item.price;
        $payDialog.attr('model-items', item.id);
      // }
    }
  });
  $.each(selectSub, function(i, m){
    text += '“' + $(m).text() + '” ';
  });

  $payDialog.find('.pay-goods-stock').text(stock);
  $payDialog.find('.js-goods-price').text(price);
  $payDialog.find('.pay-goods-cover').attr('src' , imgurl);
  $payDialog.find('.pay-buy-count').val(1);
  $payDialog.find('.minus, .plus').removeClass('disabled');
  $payDialog.find('.pay-checked-text').text(text);

});

})();

</script>

<style rel="stylesheet">
#tostorePayDialog .thumb {
  float: left;
  width: 40px;
  height: 40px;
  margin: 2px 5px 0 10px;
}
#tostorePayDialog .thumb img {
  width: 100%;
  height: 100%;
}
#tostorePayDialog .goods-base-info {
  margin-left: 55px;
  display: inline-block;
}
#tostorePayDialog .pay-goods-title,
#tostorePayDialog .pay-goods-price {
  /*padding-right: 50px;*/
  line-height: 22px;
}
#tostorePayDialog .pay-goods-title {
  text-align: center;
  padding-right: 30px;
}
#tostorePayDialog .pay-current-price {
  color: #f60;
  margin-top: 6px;
  font-size: 14px;
}
#tostorePayDialog .pay-current-price b {
  vertical-align: middle;
}
#tostorePayDialog .pay-goods-models {
  margin: -10px 0;
}
#tostorePayDialog dl {
  margin: 0;
  padding: 2px 5px;
}
#tostorePayDialog dt, #tostorePayDialog dd {
  display: inline-block;
  margin: 0;
  text-align: center;
  vertical-align: middle;
}
#tostorePayDialog dd {
  width: calc(100% - 60px);
}
#tostorePayDialog dt {
  margin-top: 4px;
  color: #999;
  font-size: 12px;
  width: 60px;
  display: inline-block;
  text-align: right;
  vertical-align: top;
}
#tostorePayDialog .pay-goods-models ul {
  /*margin: 10px 0;*/
  max-height: 300px;
  overflow: scroll;
}
#tostorePayDialog .pay-goods-models li {
  color: #707070;
  border-radius: 25px;
  padding: 2px 12px;
  border: 1px solid #dedede;
  font-size: 12px;
  margin: 2px 6px;
  min-width: 42px;
}
#tostorePayDialog .pay-goods-models li.select {
  position: relative;
  color:#707070;
  background-color:#fdeab0;
}
#tostorePayDialog .pay-goods-models li.select:after {
  content: '';
  position: absolute;
  bottom: 0;
  right: 0;
  width: 12px;
  height: 12px;
}
#tostorePayDialog .pay-goods-stock {
  display: inline-block;
  margin: 5px 10px 0 0;
}
#tostorePayDialog .pay-buy-next,
#tostorePayDialog .pay-add-to-shoppingcart {
  margin: 0 10px;
  padding: 11px 10px;
  font-size: 16px;
  line-height: 16px;
  border-radius: 4px;
}
#tostorePayDialog .minus,#tostorePayDialog .plus {
  position:relative;
  display:inline-block;
  font-size:16px;
  color:#666;
  outline:0!important;
  border:1px solid #999;
  text-indent:-9999px;
  overflow:hidden;
  vertical-align:middle;
  width:20px;
  height:20px;
  line-height:20px;
  font-weight:normal;
  background-color:#ffcc01;
  border-color:#ffcc01;
  border-radius:50%;
}
#tostorePayDialog .minus {
  background-color:#fff;
  border-color:#dedede;
}
#tostorePayDialog .minus::before,#tostorePayDialog .plus::after {
  position:absolute;
  width:8px;
  height:2px;
  top:0;
  left:0;
  right:0;
  margin:auto;
  background-color:#dedede;
  bottom:0;
  content:'';
}
#tostorePayDialog .plus::after {
  position:absolute;
  top:0;
  bottom:0;
  left:0;
  right:0;
  margin:auto;
  content:'';
  width:2px;
  height:8px;
  background-color:#6c6c6c;
}
#tostorePayDialog .plus::before {
  position:absolute;
  width:8px;
  height:2px;
  top:0;
  left:0;
  right:0;
  margin:auto;
  background-color:#6c6c6c;
  bottom:0;
  content:'';
}
#tostorePayDialog .plus::before,#tostorePayDialog .plus::after {
  background-color:#fff;
}
#tostorePayDialog .pay-buy-count {
  border: none;
}
#tostorePayDialog .page-bottom-dialog {
  padding-bottom: 45px;
}

#tostorePayDialog .goods-bottom-opt {
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  text-align: center;
  padding: 0;
  border: none;
  background-image: -webkit-linear-gradient(bottom, rgba(226,227,231,0.33) 0%, rgba(248,248,248,0.33) 100%);
  background-image: linear-gradient(to top, rgba(226,227,231,0.33) 0%, rgba(248,248,248,0.33) 100%);
  background-color: #fff;
  -webkit-user-select: none;
  user-select: none;
  font-size: 0;
  background: #696969;
}
.goods-detail-wrap .goods-bottom-opt .btn {
  width: 100%;
  box-sizing: border-box;
}
#tostorePayDialog .pay-add-to-shoppingcart {
  margin: 0 10px;
  padding: 11px 10px;
  font-size: 16px;
  line-height: 16px;
  border-radius: 4px;
}
#tostorePayDialog .goods-bottom-opt .goods-opt-item {
  padding:0;
}
#tostorePayDialog .btn-orange {
  color: #fff;
  border: none;
  background-color: #696969;
  line-height: 34px;
  text-align: left;
}
#tostorePayDialog .add-to-shoppingcart{
  background: #a8a8a8;
  color: #fff;
  border: none;
  line-height:34px;
  width: 100%;
}
#tostorePayDialog .dialog-block-item {
  border: none;
}
#tostorePayDialog .add-to-shoppingcart.router {
  background: #ffcc01;
  color: #fff;
  border-radius: 0;
}
.goods-detail-wrap .goods-bottom-opt .btn {
  width: 100%;
  box-sizing: border-box;
}
.goods-detail-wrap .right-arrow-bar {
  padding-right: 33px;
}
.goods-detail-wrap .right-arrow-bar:before {
  font-size: 16px;
}
.goods-detail-wrap .icon-notebook {
  position: relative;
  margin-right: 8px;
  font-size: 26px;
  line-height: 37px;
  width: 45px;
  color: #999;
}
#tostorePayDialog .icon-shoppingcart {
  position: relative;
  margin-right: 8px;
  font-size: 24px;
  line-height: 24px;
  width: 45px;
  color: #fff;
  vertical-align: middle;
  margin-left: 20px;
}
.goods-detail-wrap .goods-comment-label {
  display: inline-block;
  padding: 4px 8px;
  background-color: #f5ece7;
  color: #7c7877;
  margin-right: 5px;
  border-radius: 2px;
  font-size: 12px;
}
.comment-item {
  padding: 15px 0 5px;
}
.comment-user-photo {
  width: 20px;
  height: 20px;
  border-radius: 50%;
  margin-right: 7px;
  vertical-align: middle;
}
.comment-content {
  margin: 10px 0 6px;
  font-size: 13px;
  line-height: 16px;
}
.comment-date, .comment-goods-model {
  color: #999;
  font-size: 12px;
}
.comment-date {
  margin-right: 8px;
}
.goods-app-name {
  display: inline-block;
  width: calc(100% - 80px);
  height: 16px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.goods-detail-wrap .cart-goods-num {
  position: absolute;
  top: 0;
  right: 0;
  width: 18px;
  height: 18px;
  line-height: 16px;
  font-size: 14px;
  text-align:center;
  background-color: #ff1616;
  border-radius: 50%;
  color: #fff;
}
.goods-detail-wrap .goods-price-discount {
  display: inline-block;
  font-size: 14px;
  vertical-align: bottom;
  color: #acacac;
}
#tostorePayDialog .goods-num {
  position: absolute;
  right: 20px;
  top: 15%;
}
#tostorePayDialog .goods-detail-section {
    width: 80%;
    margin: 0 auto;
}
#tostorePayDialog .shop-num {
    width: 16px;
    background: red;
    height: 16px;
    line-height: 16px;
    display: inline-block;
    position: absolute;
    top: -4px;
    right: 9px;
    border-radius: 50%;
    color: #fff;
    font-size: 12px;
    text-align: center;
}
#tostorePayDialog .btn {
  border-radius: 0;
}
#tostorePayDialog .dialog-wrap-businessString {
  font-size: 12px;
  color: #ffcc01;
  padding-left: 20px;
  padding-bottom: 10px;
}
#tostorePayDialog .noRouter {
  background: #ffcc01;
  color: #fff;
  border-radius: 0;
}
</style>
<div id="tostorePayDialog" class="page-dialog-wrap" style="display: none;">
  <div class="page-bottom-dialog">
    <div class="page-bottom-content">
      <div class="pay-close-dialog page-dialog-close">×</div>
      <div class="dialog-block-item">
        <div class="pay-goods-baseinfo">
          <p class="pay-goods-title ellipsis">MWH曼好家特斯林摇椅  FCA40105</p>
        </div>
      </div>
      <div class="dialog-block-item">
        <div class="pay-goods-models">
          <!-- <dl>
            <dt>颜色分类：</dt>
            <dd>
              <ul class="pills-list">
                <li class="subModel">红色</li>
                <li class="subModel">黄色</li>
                <li class="subModel">三彩</li>
                <li class="subModel">绿色</li>
              </ul>
            </dd>
          </dl>
          <dl>
            <dt>头枕：</dt>
            <dd><ul class="pills-list">
                <li class="subModel">大</li>
                <li class="subModel">中</li>
                <li class="subModel">小</li>
              </ul></dd>
          </dl> -->
        </div>
      </div>
      <div class="dialog-block-item" style="padding:10px 10px 0 10px;">
        <dl class="clearfix"><div class="pay-current-price pull-left">
              <span class="pull-left">￥</span><b class="js-goods-price"></b>
            </div><dd class="pull-right" style="width: auto;">
        <span class="pull-left tostoreHide" style="display: none;">库存 <span class="pay-goods-stock"></span></span>
        <div class="quantity pull-left">
          <span class="minus disabled" type="button" disabled="true"></span><input class="pay-buy-count" value="0" type="text"><span class="plus" type="button"></span>
          <div class="response-area response-area-minus"></div>
          <div class="response-area response-area-plus"></div>
        </div></dd></dl>
      </div>
      <div class="dialog-wrap-businessString"></div>
      <!-- <div class="dialog-block-item">
        <div class="btn btn-block btn-orange pay-buy-next">下一步</div>
        <div class="btn btn-block btn-orange pay-add-to-shoppingcart">加入购物车</div>
      </div> -->
      <div class="goods-bottom-opt">
        <div class="flex-box goods-bottom-bar">
          <div class="goods-opt-item flex-sub-box-2" style="width: 50%;text-align: left;">
            <div class="btn btn-orange buy-goods-directly router" data-router="shoppingCart">
              <span class="icon-shoppingcart">
                <span class="shop-num"></span>
              </span>
              ￥<span class="totalPrice">0.00</span>
            </div>
          </div>
          <div class="goods-opt-item flex-sub-box-2" style="width: 50%;">
            <div class="btn add-to-shoppingcart" data-router="tostorePayment">选好了</div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<script>
(function(){
var $tostorePayDialog = $('#tostorePayDialog'),
    appId = GetQueryString('_app_id');

$tostorePayDialog.on('click', '.response-area-plus', function(){
  var $input = $(this).siblings('input'),
      num = Number($input.val()),
      $minusBtn = $(this).siblings('.minus'),
      $plusBtn = $(this).siblings('.plus');
      stock = Number($('#tostorePayDialog .pay-goods-stock').text()) || 0;
  if(num+1 > stock){
    alertTip('库存不足');
    return;
  }
  APP.ToShoppingCartIcon('plus');
}).on('click', '.response-area-minus', function(){
  var $input = $(this).siblings('input'),
      num = Number($input.val()),
      $minusBtn = $(this).siblings('.minus'),
      $plusBtn = $(this).siblings('.plus');

  if(num - 1 < 0){
    return;
  }
  if(num-1 <= 0){
    $input.val(0);
    APP.DeleteShoppingCartIcon();
    return;
  }
  APP.ToShoppingCartIcon('mins');
}).on('click', '.subModel', function(){
  // 支付框里点击选择型号
  var models = $tostorePayDialog.data('goods-info').model_items,
      modelLength = $tostorePayDialog.find('.pay-goods-models dl').length,
      stock = 0,
      selectSub, subModelArr, length, price;

  $(this).addClass('select').siblings('.select').removeClass('select');
  selectSub = $tostorePayDialog.find('.subModel.select');
  models.length && $.each(models, function(index, item){
    subModelArr = item.model.split(',');
    length = 0;
    $.each(selectSub, function(i, m){
      if(subModelArr.indexOf($(m).attr('data-id')) >= 0){
        length++;
      }
    });
    if(length === selectSub.length){
      stock += Number(item.stock);
      if(length === modelLength){
        price = item.price;
        $tostorePayDialog.attr('model-items', item.id);
      }
    }
  });

  $tostorePayDialog.find('.pay-goods-stock').text(stock);
  $tostorePayDialog.find('.js-goods-price').text(price);
  $tostorePayDialog.find('.pay-buy-count').val(0);
  $tostorePayDialog.find('.minus, .plus').removeClass('disabled');

}).on('click','.add-to-shoppingcart',function(){
  if(!$(this).hasClass('noRouter')){
    return;
  }
  $.ajax({
    url: '/index.php?r=AppShop/precheckShoppingCart',
    type: 'POST',
    dataType: 'json',
    data: {
          app_id   : appId,
          sub_shop_app_id: GetQueryString('franchisee') || '',
          parent_shop_app_id: GetQueryString('franchisee') ? appId : ''
        },
    success:function(data){
      if(data.status != 0){
        confirmTip({content:data.data},function(){
          APP.turnToPage({
              router: 'shoppingCart'
            });
        });
      }
    }
  })
});


})();

</script>

<style rel="stylesheet">
  #groupPayDialog .pay-goods-models div {
    padding: 5px 0;
  }

  #groupPayDialog .pay-current-price {
    color: #d0011b;
  }

  #groupPayDialog .pay-current-price text {
    font-weight: bold;
    font-size: 25px;
    vertical-align: bottom;
  }

  #groupPayDialog .limit {
    color: #aaa;
    font-size: 11px;
  }

  #groupPayDialog .pic {
    width: 80px;
    height: 80px;
    margin: 2px 10px 0;
  }

  #groupPayDialog .pay-goods-baseinfo {
    display: inline-block;
    vertical-align: top;
  }

  #groupPayDialog .pay-goods-title, #groupPayDialog .pay-goods-price {
    padding-right: 50px;
    line-height: 22px;
    margin: 8px 0 5px 0;
  }
  #groupPayDialog .pills-list span {
    color:#aaa;
    margin-bottom:2px;
    margin-top:2px;
    position:relative;
    margin:10px 10px 10px 0;
    border:1px solid #dedede;
    border-radius:3px;
  }
  #groupPayDialog .pills-list span.select {
    position: relative;
    color: #f5ac45;
    border-color: #f5ac45;
  }
  #groupPayDialog .pills-list li.select {
    position: relative;
    color: #f5ac45;
    border-color: #f5ac45;
  }
  #groupPayDialog .pay-goods-models {
    font-size: 13px;
    padding: 5px 10px;
  }

  #groupPayDialog .pay-goods-models .group-info {
    padding-bottom: 0;
    color: #666;
  }

  #groupPayDialog .pay-buy-next {
    width: 70%;
    margin: 0 auto;
    background-image: -webkit-gradient(linear, 0 0, 0 bottom, from(#f6d55f), to(#f87022));
    border-color: #fff;
    color: #fff;
    border-radius: 10px;
  }

  #groupPayDialog .group-buy-num text {
    vertical-align: middle;
  }

  #groupPayDialog .group-buy-num .subModel {
    padding: 0 10px;
  }
  #groupPayDialog .minus, #groupPayDialog .plus {
    position: relative;
    display: inline-block;
    font-size: 16px;
    outline: 0!important;
    text-indent: -9999px;
    overflow: hidden;
    vertical-align: middle;
    width: 20px;
    height: 20px;
    line-height: 20px;
    font-weight: normal;
    background-color: #f1f1f1;
    color: #878787;
    border-radius: 2px;
  }
  #groupPayDialog .pay-buy-count {
    border: none;
    height: 20px;
    background-color: #f1f1f1;
    padding: 0;
    margin: 0 1px;
    border-radius: 0;
  }
</style>
<div id="groupPayDialog" class="page-dialog-wrap">
  <div class="page-bottom-dialog">
    <div class="page-bottom-content">
      <div class="pay-close-dialog page-dialog-close">×</div>
      <div class="dialog-block-item">
        <img class="pic" src="app_data/t_14966428515934f523ae28a.png">
        <div class="pay-goods-baseinfo">
          <div class="pay-goods-title ellipsis">adfsadf</div>
          <div class="pay-goods-price">
            <div class="pay-current-price">
              拼团价：¥<span>0</span>
            </div>
          </div>
          <div class="limit">提示：每人限参<span>1</span>团，每团限购<span>2</span>件</div>
        </div>
      </div>
      <div class="dialog-block-item">
        <div class="pay-goods-models">
          <div class="group-info group-buy-num">
            <text>拼团人数：</text>
            <span class="pills-list">
              <span class="subModel">2人</span>
            </span>
          </div>
          <div class="group-info group-buy-num">
            <text>拼团人数：</text>
            <span class="pills-list">
              <i></i>人团
            </span>
          </div>
          <div class="group-info">原价：￥<span id="origin-price"></span></div>
          <div class="group-info part">团长价：￥<span id="leader-price"></span></div>
          <div class="group-info part">拼团时限：<span></span>小时<span></span>分钟</div>
        </div>
      </div>
      <div class="dialog-block-item">
        <div class="pay-goods-models">
          <div>
            <text style="vertical-align:middle;"></text>
            <span class="pills-list">
              <span class="subModel"></span>
            </span>
          </div>
        </div>
      </div>
      <div class="dialog-block-item" style="padding-left:10px;padding-right:10px;">
        <div class="clearfix">
          <text style="vertical-align:middle;">数量：</text>
          <div class="pull-right">
            <span class="pull-left">库存
              <text class="pay-goods-stock">1000</text>
            </span>
            <div class="quantity pull-left">
              <span class="minus"></span>
              <input disabled="disabled" class="pay-buy-count" value="1" type="number">
              <span class="plus"></span>
              <div class="response-area response-area-minus"></div>
              <div class="response-area response-area-plus"></div>
            </div>
          </div>
        </div>
      </div>
      <div class="dialog-block-item">
        <div>
          <div class="btn btn-block pay-buy-next" id="openGroup">确认开团</div>
        </div>
        <div>
          <div class="btn btn-block pay-buy-next" id="joinGroup">确认参团</div>
        </div>
      </div>
    </div>
  </div>
</div>
<script>
  (function(){
    var $payDialog = $('#groupPayDialog');

    $payDialog.on('click', '.response-area-plus', function(){
      var $input = $(this).siblings('input'),
          num = Number($input.val()),
          $minusBtn = $(this).siblings('.minus'),
          $plusBtn = $(this).siblings('.plus'),
          stock = Number($('#groupPayDialog .pay-goods-stock').text()) || 0,
          limit = Number($('#groupPayDialog .limit span').last().text()),
          goodsInfo = $payDialog.data('goods-info');

      if($plusBtn.hasClass('disabled')){
        return;
      }
      $minusBtn.removeClass('disabled');
      if(num >= limit){
        $plusBtn.addClass('disabled');
        alertTip('商品数量超过限制');
        return ;
      }

      $input.val(num+1);

    }).on('click', '.response-area-minus', function(){
      var $input = $(this).siblings('input'),
          num = Number($input.val()) || 2,
          $minusBtn = $(this).siblings('.minus'),
          $plusBtn = $(this).siblings('.plus');

      if($minusBtn.hasClass('disabled')){
        return;
      }
      $plusBtn.removeClass('disabled');
      if(num <= 1){
        $minusBtn.addClass('disabled');
        return;
      }
      $input.val(num - 1);

    }).on('click', '.subModel', function(){
      // 支付框里点击选择型号
      var goodsInfo = $payDialog.data('goods-info'),
          models = goodsInfo.model_items,
          modelLength = $payDialog.find('.pay-goods-models dl').length,
          stock = 0,
          selectSub,selectNum, subModelArr, price, tempmodel = [],imgurl = '';

      $(this).addClass('select').siblings('.select').removeClass('select');
      selectSub = $payDialog.find('.pills-list li.select');
      selectNum = $payDialog.find('.pills-list span.select').data('num');
      $.each(selectSub, function(i, m){
        tempmodel.push($(m).data('id'));
      });
      models.length && $.each(models, function(index, item){
        if(tempmodel.join() == item.model && selectNum == item.num_of_people){
          stock = Number(item.stock);
          imgurl = item.img_url || goodsInfo.cover;
          price = item.price;
          $payDialog.attr('model-items', item.id);
          $payDialog.find('.pay-current-price span').text(item.group_buy_normal_price);
          $payDialog.find('#leader-price').text(item.group_buy_leader_price);
        }
      });

      $payDialog.find('.pay-goods-stock').text(stock);
      $payDialog.find('#origin-price').text(price);
      $payDialog.find('.pay-goods-cover').attr('src' , imgurl);
      $payDialog.find('.pay-buy-count').val(1);
      $payDialog.find('.minus, .plus').removeClass('disabled');

    });

  })();
</script>

<style>
.takeDelivery-address-wrap {
    background-color: #EEEEEE;
}

.newAddress-title {
    margin-bottom: 15px;
    background-color: #F8F8F8;
    font-size: 15px;
    padding: 12px 15px;
    text-align: center;
}

.newAddress-title span:first-child {
    color: #5C5C5C;
    position: absolute;
    left: 15px;
    top: 10px;
    cursor: pointer;
    padding: 5px;
}

.newAddress-title span:last-child {
    color: #3B3B3B;
    letter-spacing: 1px;
}

.newAddress-save {
    text-align: center;
    padding: 10px;
    margin: auto;
}

.newAddress-save button {
    width: 80%;
    margin: 0 auto;
    background-color: #C40B1D;
    font-size: 15px;
    letter-spacing: 2px;
    color: white;
    padding: 8px;
    border: none;
    border-radius: 4px;
}

.newAddress-content-wrap {
    background-color: white;
}

.newAddress-content-wrap .dialog-block-item {
    margin: 0 auto;
    width: 91%;
    padding: 10px;
    overflow: hidden;
    zoom: 1;
}

.newAddress-content-wrap .dialog-block-item span {
    float: left;
    height: 37px;
    line-height: 37px;
}

.newAddress-content-wrap .dialog-block-item input[type="text"] {
    float: right;
    height: 35px;
    border: none;
    text-indent: 10px;
    outline: none;
    width: 220px;
}

.provice-city {
    margin-right: 10px;
}

.provice-city span {
    margin-left: 5px;
}
</style>
<div class="takeDelivery-address-wrap page" id="choose-takeDelivery-address">
    <div class="newAddress-title">
        <span class="icon-leftarrow"></span>
        <span>新建收货地址</span>
    </div>
    <div class="newAddress-content-wrap">
        <div class="dialog-block-item" data-name="receiver">
            <span>收货人</span>
            <input name="name" type="text">
        </div>
        <div class="dialog-block-item" data-name="phone">
            <span>联系电话</span>
            <input name="contact" type="text">
        </div>
        <div class="dialog-block-item" data-name="region">
            <span>所在地区</span>
            <span class="choose-area"><span class="provice-city">请选择</span><span class="icon-rightarrow"></span></span>
        </div>
        <div class="dialog-block-item" data-name="detailAddress">
            <p>详细地址</p>
            <input name="detailAddress" style="width: 285px;" type="text">
        </div>
        <div class="dialog-block-item" data-name="defaultAddress">
            <span>设置为默认地址</span>
            <section class="model-2">
                <div class="checkbox">
                    <input type="checkbox">
                    <label></label>
                </div>
            </section>
        </div>
    </div>
    <div class="dialog-block-item self-bg">
        <div class="newAddress-save">
            <button type="button" class="save-newaddress-data">保存并使用</button>
        </div>
    </div>
</div>
<div id="provinceCityDialog" class="page-dialog-wrap">
    <div class="page-bottom-dialog">
        <div class="page-bottom-content">
            <div class="sure-local-area">
                <span>取消</span>
                <span>确定</span>
            </div>
            <div class="province-list">
                <ul>
                </ul>
            </div>
            <div class="city-list">
                <ul>
                </ul>
            </div>
            <div class="area-list">
                <ul>
                </ul>
            </div>
        </div>
    </div>
</div>
<script>
var area_province = "",
    area_city = "",
    area_area = "",
    obj_province = {},
    obj_city = {},
    obj_district = {};
//getAreaProvince();
$("#provinceCityDialog").on("click", ".sure-local-area span:first-child", function() {
    $("#provinceCityDialog .page-bottom-dialog").slideUp(400, function() {
        $(".province-list").show();
        $(".city-list").hide();
        $(".area-list").hide();
        $("#provinceCityDialog").hide();
        $(".clickliStyle").removeClass("clickliStyle");
    });
}).on("click", ".sure-local-area span:last-child", function() {
    var tempStr = "";
    if (area_province == area_city && area_city == area_area) {
        tempStr += "<span>" + area_province + "</span>";
    } else if (area_province == area_city) {
        tempStr += "<span>" + area_province + "</span><span>" + area_area + "</span>";
    } else {
        tempStr += "<span>" + area_province + "</span><span>" + area_city + "</span><span>" + area_area + "</span>";
    }
    $(".provice-city").html("").html(tempStr);
    $("#provinceCityDialog .page-bottom-dialog").slideUp(400, function() {
        $(".province-list").show();
        $(".city-list").hide();
        $(".area-list").hide();
        $("#provinceCityDialog").hide();
        $(".clickliStyle").removeClass("clickliStyle");
    });
});
$("#choose-takeDelivery-address").on("click", ".newAddress-title span:first-child", function() {
    $('#addressDialog').addClass("zShow");
    var $temp = $("#choose-takeDelivery-address")
    $temp.removeClass("zShow");
    $temp.find("input[type='text']").val("");
    $temp.find("input[type='checkbox']").prop("checked", false);
    $temp.find(".provice-city").text("请选择")
}).on("click", ".choose-area", function() {
    $("#provinceCityDialog").show();
    $("#provinceCityDialog .page-bottom-dialog").slideDown(400);
    obj_province = {};
    obj_city = {};
    obj_district = {};
    area_province = "";
    area_city = "";
    area_area = "";
}).on("click", ".save-newaddress-data", function() {
    var data = {},
        $temp = $("#choose-takeDelivery-address"),
        is_default;
    data.name = $temp.find('input[name="name"]').val();
    data.contact = $temp.find('input[name="contact"]').val();
    data.detailAddress = $temp.find('input[name="detailAddress"]').val();
    data.province = obj_province;
    data.city = obj_city;
    data.district = obj_district;
    is_default = $temp.find('.model-2 input[type="checkbox"]').is(":checked") ? 1 : 0;
    if (!data.name) {
        alertTip("请输入姓名!");
        return;
    } else if (!/^1[34578]\d{9}$/.test(data.contact)) {
        alertTip("电话号码格式有误!");
        return;
    } else if ($(".provice-city").text() == "请选择" || $(".provice-city").text() == "") {
        alertTip("请选择所在地区!");
        return;
    } else if(!data.district.id || !data.city.id || !data.province.id){
        console.log(data);
        alertTip("地址中省市以及所在地区都不能为空!");
        return;
    }else{
        console.log(data);
       addAddress(data, is_default);
    }
function addAddress(para, is_default) {
    $.ajax({
        url: '/index.php?r=AppShop/addAddress',
        type: 'get',
        data: {
            address_info: para,
            ck_id: GetCookiePara(),
            is_default: is_default
        },
        dataType: 'json',
        success: function(data) {
            if (data.status !== 0) {
                if (data.status === 2) {
                    alertTip('请先登录账号', function() {
                        APP.showLogin();
                    }, 700);
                } else {
                    alertTip(data.data);
                }
                return;
            }
            para.id = data.data;
            APP.getAddressList();
            var $temp = $("#choose-takeDelivery-address");
            $temp.removeClass("zShow");
            $("#addressDialog").addClass("zShow");
            $temp.find("input[type='text']").val("");
            $temp.find("input[type='checkbox']").prop("checked", false);
            $temp.find(".provice-city").text("请选择")
        }
    });
}
});
function getAreaProvince() {
    $.ajax({
        url: '/index.php?r=Region/getRegionList',
        type: 'get',
        data: {},
        dataType: 'json',
        success: function(data) {
            if (data.status !== 0) {
                alertTip(data.data);
                return;
            }
            var list = data.data,
                listStr = '';
            $(list).each(function(index, item) {
                listStr += '<li data-value="' + item.id + '">' + item.name + '</li>';
            });
            $(".province-list ul").html(listStr);
            $(".province-list li").click(function() {
                $(".province-list").hide();
                $(".city-list").show();
                area_province = $(this).text();
                obj_province.text = area_province;
                obj_province.id = $(this).attr("data-value");
                getAreaCity($(this).attr("data-value"));
            });
        },
        error: function(jqXHR, textStatus) {
            if (textStatus === 'timeout') {
                alertTip('请求超时 请检查网络状况');
            } else {
                alertTip('城市列表请求出错');
            }
        }
    });
}

function getAreaCity(pid) {
    $.ajax({
        url: '/index.php?r=Region/getRegionList',
        type: 'get',
        data: {
            pid: pid
        },
        dataType: 'json',
        success: function(data) {
            if (data.status !== 0) {
                alertTip(data.data);
                return;
            }
            var list = data.data,
                listStr = '';
            $(list).each(function(index, item) {
                listStr += '<li data-value="' + item.id + '">' + item.name + '</li>';
            });
            $(".city-list ul").html(listStr);
            $(".city-list li").click(function() {
                $(".city-list").hide();
                $(".area-list").show();
                area_city = $(this).text();
                obj_city.text = area_city;
                obj_city.id = $(this).attr("data-value");
                getAreaLocalArea($(this).attr("data-value"));
            });
        },
        error: function(jqXHR, textStatus) {
            if (textStatus === 'timeout') {
                alertTip('请求超时 请检查网络状况');
            } else {
                alertTip('城市列表请求出错');
            }
        }
    });
}

function getAreaLocalArea(pid) {
    $.ajax({
        url: '/index.php?r=Region/getRegionList',
        type: 'get',
        data: {
            pid: pid
        },
        dataType: 'json',
        success: function(data) {
            if (data.status !== 0) {
                alertTip(data.data);
                return;
            }
            var list = data.data,
                listStr = '';
            $(list).each(function(index, item) {
                listStr += '<li data-value="' + item.id + '">' + item.name + '</li>';
            });
            $(".area-list ul").html(listStr);
            $(".area-list li").click(function() {
                $(this).addClass("clickliStyle");
                $(".area-list li").not(this).removeClass("clickliStyle");
                area_area = $(this).text();
                obj_district.text = area_area;
                obj_district.id = $(this).attr("data-value");
            });
        },
        error: function(jqXHR, textStatus) {
            if (textStatus === 'timeout') {
                alertTip('请求超时 请检查网络状况');
            } else {
                alertTip('城市列表请求出错');
            }
        }
    });
}
</script>

<style>
.takeDelivery-address-wrap {
    background-color: #EEEEEE;
}

.newAddress-title {
    margin-bottom: 15px;
    background-color: #F8F8F8;
    font-size: 15px;
    padding: 12px 15px;
    text-align: center;
}

.newAddress-title span:first-child {
    color: #5C5C5C;
    position: absolute;
    left: 15px;
    top: 10px;
    cursor: pointer;
    padding: 5px;
}

.newAddress-title span:last-child {
    color: #3B3B3B;
    letter-spacing: 1px;
}

.newAddress-save {
    text-align: center;
    padding: 10px;
    margin: auto;
}

.newAddress-save button {
    width: 80%;
    margin: 0 auto;
    background-color: #C40B1D;
    font-size: 15px;
    letter-spacing: 2px;
    color: white;
    padding: 8px;
    border: none;
    border-radius: 4px;
}

.newAddress-content-wrap {
    background-color: white;
}

.newAddress-content-wrap .dialog-block-item {
    margin: 0 auto;
    width: 91%;
    padding: 10px;
    overflow: hidden;
    zoom: 1;
}

.newAddress-content-wrap .dialog-block-item span {
    float: left;
    height: 37px;
    line-height: 37px;
}

.newAddress-content-wrap .dialog-block-item input[type="text"] {
    float: right;
    height: 35px;
    border: none;
    text-indent: 10px;
    outline: none;
    width: 220px;
}

#del-address-inedit {
    position: relative;
    font-size: 15px;
    letter-spacing: 2px;
    padding: 5px 10px;
    height: 30px;
    line-height: 30px;
    text-align: center;
    background: #DDD;
    color: #f36161;
    cursor: pointer;
}
</style>
<div class="edit-address page" id="editAddresswrap">
    <div class="newAddress-title">
        <span class="icon-leftarrow"></span>
        <span>编辑收货地址</span>
    </div>
    <div class="newAddress-content-wrap">
        <div class="dialog-block-item" data-name="receiver">
            <span>收货人</span>
            <input name="name" data-name="receiver" type="text">
        </div>
        <div class="dialog-block-item" data-name="phone">
            <span>联系电话</span>
            <input name="contact" data-name="phone" type="text">
        </div>
        <div class="dialog-block-item" data-name="region">
            <span>所在地区</span>
            <span class="choose-area"><span class="editRegion"></span><span class="icon-rightarrow"></span></span>
        </div>
        <div class="dialog-block-item" data-name="detailAddress">
            <p>详细地址</p>
            <input name="detailAddress" style="width: 285px;" data-name="detailAddress" type="text">
        </div>
        <div class="dialog-block-item" data-name="defaultAddress">
            <span>设置为默认地址</span>
            <section class="model-2">
                <div class="checkbox">
                    <input type="checkbox">
                    <label></label>
                </div>
            </section>
        </div>
    </div>
    <div id="del-address-inedit">
        删除
    </div>
    <div class="dialog-block-item self-bg">
        <div class="newAddress-save">
            <button type="button" id="save-edit-addrData">保存并使用</button>
        </div>
    </div>
</div>
<div id="editprovinceCityDialog" class="page-dialog-wrap">
    <div class="page-bottom-dialog">
        <div class="page-bottom-content">
            <div class="sure-local-area">
                <span>取消</span>
                <span>确定</span>
            </div>
            <div class="edit-province-list">
                <ul>
                </ul>
            </div>
            <div class="edit-city-list">
                <ul>
                </ul>
            </div>
            <div class="edit-area-list">
                <ul>
                </ul>
            </div>
        </div>
    </div>
</div>
<script>
var edit_area_province = "",
    edit_area_city = "",
    edit_area_area = "",
    edit_obj_province = {},
    edit_obj_city = {},
    edit_obj_district = {};
//getAreaeditProvince();
$("#editAddresswrap").on("click", ".newAddress-title span:first-child", function() {
    $('#addressDialog').addClass("zShow");
    $("#editAddresswrap").removeClass("zShow");
}).on("click", "#del-address-inedit", function() {
    // 删除地址
    var id = $(this).attr('address-id');
    confirmTip({
        content: '确认删除该地址？'
    }, function() {
        deleteAddress(id);
    });

    function deleteAddress(id) {
        if (!id) {
            alertTip('地址id为空');
            return;
        }
        $.ajax({
            url: '/index.php?r=AppShop/delAddress',
            type: 'get',
            data: {
                address_id: id
                    // ck_id: GetCookiePara()
            },
            dataType: 'json',
            success: function(data) {
                if (data.status !== 0) {
                    if (data.status === 2) {
                        alertTip('请先登录账号', function() {
                            APP.showLogin();
                        }, 700);
                    } else {
                        alertTip(data.data);
                    }
                    return;
                }
                $('.addressDialog-address').filter('[data-id=' + id + ']').remove();
                $('#addressDialog').addClass("zShow");
                $("#editAddresswrap").removeClass("zShow");
            }
        });
    }
}).on("click", ".choose-area", function() {
    $("#editprovinceCityDialog").show();
    $("#editprovinceCityDialog .page-bottom-dialog").slideDown(400);
}).on("click", "#save-edit-addrData", function() {
    var data = {},
        is_default, $temp = $("#editAddresswrap");
    data.name = $temp.find('input[name="name"]').val();
    data.contact = $temp.find('input[name="contact"]').val();
    data.detailAddress = $temp.find('input[name="detailAddress"]').val();
    if (edit_obj_province.text) {
        data.province = edit_obj_province;
    } else {
        data.province = EditaddressData.address_info.province;
    }
    if (edit_obj_city.text) {
        data.city = edit_obj_city;
    } else {
        data.city = EditaddressData.address_info.city;
    }
    if (edit_obj_district.text) {
        data.district = edit_obj_district;
    } else {
        data.district = EditaddressData.address_info.district;
    }
    is_default = $temp.find('.model-2 input[type="checkbox"]').is(":checked") ? 1 : 0;
    if (!data.name) {
        alertTip("请输入姓名!");
        return;
    } else if (!/^1[34578]\d{9}$/.test(data.contact)) {
        alertTip("电话号码格式有误!");
        return;
    } else if ($(".editRegion").text() == "请选择") {
        alertTip("请选择所在地区!");
        return;
    } else {
        addAddress(data, is_default);
    }

    function addAddress(para, is_default) {
        $.ajax({
            url: '/index.php?r=AppShop/addAddress',
            type: 'get',
            data: {
                address_info: para,
                address_id: $("#del-address-inedit").attr('address-id'),
                is_default: is_default
            },
            dataType: 'json',
            success: function(data) {
                if (data.status !== 0) {
                    if (data.status === 2) {
                        alertTip('请先登录账号', function() {
                            APP.showLogin();
                        }, 700);
                    } else {
                        alertTip(data.data);
                    }
                    return;
                }
                para.id = $("#del-address-inedit").attr('address-id');
                // $("#addressDialog").find("div[data-id='"+$("#del-address-inedit").attr('address-id')+"']").remove();
                //APP.modifyAddressList(para);
                APP.getAddressList();
                var $temp = $("#editAddresswrap");
                $temp.removeClass("zShow");
                $("#addressDialog").addClass("zShow");
                $temp.find("input[type='text']").val("");
                $temp.find("input[type='checkbox']").prop("checked", false);
                $temp.find(".provice-city").text("请选择")
            }
        });
    }
});
$("#editprovinceCityDialog").on("click", ".sure-local-area span:first-child", function() {
    $("#editprovinceCityDialog .page-bottom-dialog").slideUp(400, function() {
        $(".edit-province-list").show();
        $(".edit-city-list").hide();
        $(".edit-area-list").hide();
        $("#editprovinceCityDialog").hide();
        $(".clickliStyle").removeClass("clickliStyle");
    });
}).on("click", ".sure-local-area span:last-child", function() {
    var tempStr = "";
    if (edit_area_province == edit_area_city && area_city == edit_area_area) {
        tempStr += "<span>" + edit_area_province + "</span>";
    } else if (edit_area_province == edit_area_city) {
        tempStr += "<span>" + edit_area_province + "</span><span>" + edit_area_area + "</span>";
    } else {
        tempStr += "<span>" + edit_area_province + "</span><span>" + edit_area_city + "</span><span>" + edit_area_area + "</span>";
    }
    $(".editRegion").html("").html(tempStr);
    $("#editprovinceCityDialog .page-bottom-dialog").slideUp(400, function() {
        $(".edit-province-list").show();
        $(".edit-city-list").hide();
        $(".edit-area-list").hide();
        $("#editprovinceCityDialog").hide();
        $(".clickliStyle").removeClass("clickliStyle");
    });
})

function getAreaeditProvince() {
    $.ajax({
        url: '/index.php?r=Region/getRegionList',
        type: 'get',
        data: {},
        dataType: 'json',
        success: function(data) {
            if (data.status !== 0) {
                alertTip(data.data);
                return;
            }
            var list = data.data,
                listStr = '';
            $(list).each(function(index, item) {
                listStr += '<li data-value="' + item.id + '">' + item.name + '</li>';
            });
            $(".edit-province-list ul").html(listStr);
            $(".edit-province-list li").click(function() {
                $(".edit-province-list").hide();
                $(".edit-city-list").show();
                edit_area_province = $(this).text();
                edit_obj_province.text = edit_area_province;
                edit_area_province.id = $(this).attr("data-value");
                getAreaeditCity($(this).attr("data-value"));
            });
        },
        error: function(jqXHR, textStatus) {
            if (textStatus === 'timeout') {
                alertTip('请求超时 请检查网络状况');
            } else {
                alertTip('城市列表请求出错');
            }
        }
    });
}

function getAreaeditCity(pid) {
    $.ajax({
        url: '/index.php?r=Region/getRegionList',
        type: 'get',
        data: {
            pid: pid
        },
        dataType: 'json',
        success: function(data) {
            if (data.status !== 0) {
                alertTip(data.data);
                return;
            }
            var list = data.data,
                listStr = '';
            $(list).each(function(index, item) {
                listStr += '<li data-value="' + item.id + '">' + item.name + '</li>';
            });
            $(".edit-city-list ul").html(listStr);
            $(".edit-city-list li").click(function() {
                $(".edit-city-list").hide();
                $(".edit-area-list").show();
                edit_area_city = $(this).text();
                edit_obj_city.text = edit_area_city;
                edit_obj_city.id = $(this).attr("data-value");
                getAreaEditLocalArea($(this).attr("data-value"));
            })
        },
        error: function(jqXHR, textStatus) {
            if (textStatus === 'timeout') {
                alertTip('请求超时 请检查网络状况');
            } else {
                alertTip('城市列表请求出错');
            }
        }
    });
}

function getAreaEditLocalArea(pid) {
    $.ajax({
        url: '/index.php?r=Region/getRegionList',
        type: 'get',
        data: {
            pid: pid
        },
        dataType: 'json',
        success: function(data) {
            if (data.status !== 0) {
                alertTip(data.data);
                return;
            }
            var list = data.data,
                listStr = '';
            $(list).each(function(index, item) {
                listStr += '<li data-value="' + item.id + '">' + item.name + '</li>';
            });
            $(".edit-area-list ul").html(listStr);
            $(".edit-area-list li").click(function() {
                $(this).addClass("clickliStyle");
                $(".edit-area-list li").not(this).removeClass("clickliStyle");
                edit_area_area = $(this).text();
                edit_obj_district.text = edit_area_area;
                edit_obj_district.id = $(this).attr("data-value");
            })
        },
        error: function(jqXHR, textStatus) {
            if (textStatus === 'timeout') {
                alertTip('请求超时 请检查网络状况');
            } else {
                alertTip('城市列表请求出错');
            }
        }
    });
}
</script>

<script src="app_data/laydate.js"></script>
<script src="app_data/exif.js"></script>
<script src="app_data/imgUpload.js"></script>
<script src="app_data/photoswipe.js"></script>
<script src="app_data/photoswipe-ui-default.js"></script>

</body></html>